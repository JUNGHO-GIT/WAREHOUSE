!function(t){var e=t.ui.autocomplete.prototype,i=e._renderMenu,r=e._renderItem;e._renderMenu=function(e,r){i.call(this,e,r);var o=this.options.selectItem;if(o&&o.on){var o=o.cls,o=void 0===o?"ui-state-highlight":o,n=this.element.val();n&&o&&t("a",e).filter(function(){return t(this).text()===n}).addClass(o)}},e._renderItem=function(t,e){var i=r.call(this,t,e),o=this.options.highlightText;if(o&&o.on){var n=this.element.val();if(n){var n=RegExp("("+n+")","i"),l=e.label;if(n.test(l)){var a=o.style,o=o.cls,l=l.replace(n,"<span style='"+(void 0===a?"font-weight:bold;":a)+"' class='"+(void 0===o?"":o)+"'>$1</span>");i.find("a").html(l)}}}return i};var e=t.paramquery=t.paramquery||{},o=function(t,e,i,r){e=e.slice();for(var o=[],n=0,l=e.length;n<l;n++){var a=e[n],s=a.cb,d=a.one;if(d){if(a._oncerun)continue;a._oncerun=!0}if(!1===s.call(t,i,r)&&(i.preventDefault(),i.stopPropagation()),d&&o.push(n),i.isImmediatePropagationStopped())break}if(o.length)for(n=o.length-1;0<=n;n--)e.splice(o[n],1)};e._trigger=function(e,i,r){var n,l,a=this.listeners,s=a[e],d=this.options,h=d.allEvents,c=d.bubble,u=this.element,p=d[e];if(r=r||{},(i=t.Event(i)).type=this.widgetName+":"+e,i.target=u[0],l=i.originalEvent)for(n in l)n in i||(i[n]=l[n]);return h&&"function"==typeof h&&h.call(this,i,r),s&&s.length&&(o(this,s,i,r),i.isImmediatePropagationStopped())||d.trigger&&(u[c?"trigger":"triggerHandler"](i,r),i.isImmediatePropagationStopped())||(p&&!1===p.call(this,i,r)&&(i.preventDefault(),i.stopPropagation()),(s=a[e+"Done"])&&s.length&&o(this,s,i,r)),!i.isDefaultPrevented()},e.on=function(){var t=arguments;if("boolean"==typeof t[0])var e=t[0],i=t[1],r=t[2],t=t[3];else i=t[0],r=t[1],t=t[2];for(var i=i.split(" "),o=0;o<i.length;o++){var n=i[o];if(n){var l=r,a=t,s=e,d=this.listeners[n];d||(d=this.listeners[n]=[]),d[s?"unshift":"push"]({cb:l,one:a})}}return this},e.one=function(){for(var t=arguments.length,e=[],i=0;i<t;i++)e[i]=arguments[i];return e[t]=!0,this.on.apply(this,e)},e.off=function(t,e){for(var i=t.split(" "),r=0;r<i.length;r++){var o=i[r];if(o){var n=o;if(o=e){if(n=this.listeners[n]){for(var l=[],a=0,s=n.length;a<s;a++)o==n[a].cb&&l.push(a);if(l.length)for(a=l.length-1;0<=a;a--)n.splice(l[a],1)}}else delete this.listeners[n]}}return this},t.widget("paramquery.pqTooltip",t.ui.tooltip,{options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var e=t(this),i=e.closest(".pq-grid").pqGrid("getInstance").grid,r=i.getCellIndices({$td:e});return(i=i.data({rowIndx:r.rowIndx,dataIndx:r.dataIndx,data:"pq_valid"}).data)?(""==(e=i.icon)?"":"<span class='ui-icon "+e+" pq-tooltip-icon'></span>")+(null!=(i=i.msg)?i:""):e.attr("title")}},_create:function(){this._super();var e=this.element,i=this.eventNamespace;e.on("pqtooltipopen"+i,function(e,i){var r=t(e.target),o=t(e.originalEvent.target);if(o.on("remove",function(t){r.pqTooltip("close",t,!0)}),i.tooltip.css("zIndex",o.zIndex()+5),r.is(".pq-grid")){var n,l=r.pqGrid("getCellIndices",{$td:o}),a=l.dataIndx;(n=r.pqGrid("getRowData",{rowIndx:l.rowIndx}))&&(n=n.pq_celldata)&&(n=n[a])&&(n=n.pq_valid)&&(l=(a=n).style,i.tooltip.addClass(a.cls),a=i.tooltip.attr("style"),i.tooltip.attr("style",a+";"+l)),r.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(t,e){t.currentTarget=o[0],r.pqTooltip("close",t,!0)})}}),e.on("pqtooltipclose"+i,function(e,i){var r=t(e.target);t(e.originalEvent.target).off("remove"),r.is(".pq-grid")&&r.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})}})}(jQuery),function(t){var e=window.pq=e||{},i=t.paramquery;e.arrayUnique=function(t,e){var i,r,o,n=[],l=t.length,a={};for(i=0;i<l;i++)r=t[i],o=e?r[e]:r,a.hasOwnProperty(o)||(a[o]=1,n.push(r));return n},i.select=function(t){var e,i,r,o=t.options,n=t.groupIndx,l=t.labelIndx,a=t.valueIndx,s=null!=l&&null!=a,d=null!=n,h=t.prepend,c=t.dataMap;if(t=["<select ",t.attr," >"],h)for(var u in h)t.push('<option value="',u,'">',h[u],"</option>");if(o&&o.length){for(var h=0,p=o.length;h<p;h++){var f=o[h];if(s){var g=f[a],v=f.pq_disabled?'disabled="disabled" ':"",w=f.pq_selected?'selected="selected" ':"";if(null!=g){if(c){for(r=0,e={};r<c.length;r++){var m=c[r];e[m]=f[m]}e="data-map='"+JSON.stringify(e)+"'"}else e="";r=e,d&&(m=f.pq_disabled_group?'disabled="disabled" ':"",i!=(e=f[n])&&(null!=i&&t.push("</optgroup>"),t.push('<optgroup label="',e,'" ',m," >"),i=e)),l==a?t.push("<option ",w,v,r,">",g,"</option>"):t.push("<option ",w,v,r,' value="',g,'">',f[l],"</option>")}}else if("object"==typeof f)for(u in f)t.push('<option value="',u,'">',f[u],"</option>");else t.push("<option>",f,"</option>")}d&&t.push("</optgroup>")}return t.push("</select>"),t.join("")},t.fn.pqval=function(t){return t?t.incr?(t=this.data("pq_value"),this.prop("indeterminate",!1),t?(t=!1,this.prop("checked",!1)):!1===t?(t=null,this.prop("indeterminate",!0),this.prop("checked",!1)):(t=!0,this.prop("checked",!0)),this.data("pq_value",t),t):(t=t.val,this.data("pq_value",t),this.prop("indeterminate",!1),null==t?(this.prop("indeterminate",!0),this.prop("checked",!1)):t?this.prop("checked",!0):this.prop("checked",!1),this):this.data("pq_value")},i.xmlToArray=function(e,i){var r=i.itemParent,o=i.itemNames,n=[];return t(e).find(r).each(function(e,i){var r=t(i),l=[];t(o).each(function(t,e){l.push(r.find(e).text().replace(/\r|\n|\t/g,""))}),n.push(l)}),n},i.xmlToJson=function(e,i){var r=i.itemParent,o=i.itemNames,n=[];return t(e).find(r).each(function(e,i){for(var r=t(i),l={},a=0,s=o.length;a<s;a++){var d=o[a];l[d]=r.find(d).text().replace(/\r|\n|\t/g,"")}n.push(l)}),n},i.tableToArray=function(e){var i=[],r=[],o=(e=t(e).children("tbody").children("tr")).length?t(e[0]):t(),n=1<e.length?t(e[1]):t();return o.children("th,td").each(function(e,r){var o=t(r),l=o.html(),o=o.width(),a="left";if(n.length)var s=n.find("td:eq("+e+")").attr("align"),a=s||a;i.push({title:l,width:o,dataType:"string",align:a,dataIndx:e})}),e.each(function(e,i){if(0!=e){var o=[];t(i).children("td").each(function(e,i){o.push(t.trim(t(i).html()))}),r.push(o)}}),{data:r,colModel:i}};var r={};i.formatCurrency=function(t,e){var i=parseFloat(t);if(!isNaN(i)){var o,n=0>i;a:{var l,a,s=e;if(s){if(s=s.split(":"),l=r[s=n&&1<s.length?s[1]:s[0]]){o=l;break a}a=/^([^#]*|&#[^#]*)?[\,\.#0]*?([\,\s\.]?)([#0]*)([\,\s\.]?)([0]*?)(\s*[^#^0]*|&#[^#]*)?$/,(a=s.match(a))&&a.length&&(l={symbol:a[1]||"",thouSep:a[2],thousand:a[3].length,decSep:a[4],decimal:a[5].length,symbolEnd:a[6]||""},r[s]=l)}o=l=l||{symbol:"",symbolEnd:"",thouSep:",",thousand:3,decSep:".",decimal:2}}s=o.symbol,l=o.symbolEnd,a=o.thousand;var d=o.thouSep,h=o.decSep,c=o.decimal,i=i.toFixed(c);o=i.length;var u=c+h.length,c=i.substring(0,o-u),i=i.substring(o-u+h.length,o);for(u=0,o=c.match(/\d/g).reverse(),c=[];u<o.length;u++)0<u&&0==u%a&&c.push(d),c.push(o[u]);return(n?"-":"")+s+(c=(c=c.reverse()).join(""))+h+i+l}},e.formatNumber=i.formatCurrency,e.validation={is:function(t,e){return"string"==t||!t||this["is"+(t=t.substring(0,1).toUpperCase()+t.substring(1,t.length))](e)},isFloat:function(t){var e=parseFloat(t);return!isNaN(e)&&e==t},isInteger:function(t){var e=parseInt(t);return!isNaN(e)&&e==t},isDate:function(t){return!isNaN(t=Date.parse(t))}};var o=[],n=i.toLetter=function(t){var e=o[t];if(!e){var i=++t%26,e=t/26|0,i=i?String.fromCharCode(64+i):(--e,"Z"),e=e?n(e-1)+i:i;o[--t]=e}return e};i.generateData=function(t,e){for(var i=[],r=0;r<e;r++)i[r]=n(r);for(var o=[],r=0;r<t;r++)for(var l=o[r]=[],a=0;a<e;a++)l[a]=i[a]+(r+1);return o}}(jQuery),function(t){function e(e,i,r){return e?t("<span tabindex='0' rel='tooltip' data-placement='top' title='"+i+"' class='btn btn-sm "+r+"'></span>"):t("<span class='pq-ui-button ui-widget-header' tabindex='0' rel='tooltip' title='"+i+"'><span class='ui-icon ui-icon-"+r+"'></span></span>")}function i(e,i){e.bind("click keydown",function(e){if("keydown"!=e.type||e.keyCode==t.ui.keyCode.ENTER)return i.call(this,e)})}function r(t,e,i){e[i?"addClass":"removeClass"]("disabled").css("pointer-events",i?"none":"").attr("tabindex",i?"":"0")}var o={options:{bootstrap:{on:!1,pager:"",nextIcon:"glyphicon glyphicon-forward",prevIcon:"glyphicon glyphicon-backward",firstIcon:"glyphicon glyphicon-step-backward",lastIcon:"glyphicon glyphicon-step-forward",refreshIcon:"glyphicon glyphicon-refresh"},curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},_regional:{strDisplay:"전체페이지 {0} to {1} / {2} 리스트.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"{0}"}};t.extend(o.options,o._regional),o._create=function(){var r=this,o=this.options,n=this.element,l=o.bootstrap,a=l.on;this.listeners={},n.addClass("pq-pager "+(a?l.pager:"")),this.first=e(a,o.strFirstPage,a?l.firstIcon:"seek-first").appendTo(n),i(this.first,function(t){1<o.curPage&&r._onChange(t,1)}),this.prev=e(a,o.strPrevPage,a?l.prevIcon:"seek-prev").appendTo(n),i(this.prev,function(t){1<o.curPage&&r._onChange(t,o.curPage-1)}),t("<span class='pq-separator'></span>").appendTo(n),this.pageHolder=t("<span class='pq-page-placeholder'></span>").appendTo(n),t("<span class='pq-separator'></span>").appendTo(n),this.next=e(a,o.strNextPage,a?l.nextIcon:"seek-next").appendTo(n),i(this.next,function(t){o.curPage<o.totalPages&&r._onChange(t,o.curPage+1)}),this.last=e(a,o.strLastPage,a?l.lastIcon:"seek-end").appendTo(n),i(this.last,function(t){o.curPage!==o.totalPages&&r._onChange(t,o.totalPages)}),t("<span class='pq-separator'></span>").appendTo(n),this.rPPHolder=t("<span class='pq-page-placeholder'></span>").appendTo(n),this.$refresh=e(a,o.strRefresh,a?l.refreshIcon:"refresh").appendTo(n),i(this.$refresh,function(t){if(!1===r._trigger("beforeRefresh",t))return!1;r._trigger("refresh",t)}),t("<span class='pq-separator'></span>").appendTo(n),t("<span class='jade-export' onclick=\"fnExport($(this).closest('.pq-grid').prop('id'),$('#'+$(this).closest('.pq-grid').prop('id')).pqGrid('option','xlsNm'));\">[toExcel]</span>").appendTo(n),t("<span class='pq-separator'></span>").appendTo(n),this.$msg=t("<span class='pq-pager-msg'></span>").appendTo(n),this._refresh()},o._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()},o._setOption=function(t,e){("curPage"==t||"totalPages"==t)&&(e*=1),this._super(t,e)},o._setOptions=function(e){var i,r=!1,o=this.options;for(i in e){var n=e[i],l=typeof n;"string"==l||"number"==l?n!=o[i]&&(this._setOption(i,n),r=!0):"function"==typeof n.splice||t.isPlainObject(n)?JSON.stringify(n)!=JSON.stringify(o[i])&&(this._setOption(i,n),r=!0):n!=o[i]&&(this._setOption(i,n),r=!0)}return r&&this._refresh(),this},t.widget("paramquery.pqPager",o),pq.pager=function(e,i){var r=t(e).pqPager(i);return r.data("paramqueryPqPager")||r.data("paramquery-pqPager")};var n=t.paramquery;n.pqPager.regional={},n.pqPager.regional.en=o._regional,o=n.pqPager.prototype,n.pqPager.defaults=o.options,o._refreshPage=function(){var e=this;this.pageHolder.empty();for(var i=this.options,r=i.bootstrap,o=i.strPage.split(" "),n=[],l=0,a=o.length;l<a;l++){var s=o[l];"{0}"==s?n.push("<input type='text' tabindex='0' class='pq-pager-input ",r.on?"":"ui-corner-all","' />"):"{1}"==s?n.push("<span class='total'></span>"):n.push("<span>",s,"</span>")}r=t(r=n.join("")).appendTo(this.pageHolder),this.page=r.filter("input").bind("change",function(r){var o=t(this),n=o.val();if(isNaN(n)||1>n||(n=parseInt(n))>i.totalPages||!1===e._onChange(r,n))return o.val(i.curPage),!1}),this.$total=r.filter("span.total")},o._onChange=function(t,e){if(!1===this._trigger("beforeChange",t,{curPage:e})||!1===this._trigger("change",t,{curPage:e}))return!1;this.option({curPage:e})},o._refresh=function(){this._refreshPage();var e=this,i=this.options,o=i.bootstrap;if(this.rPPHolder.empty(),i.strRpp){var n=i.rPPOptions,l=i.strRpp;if(-1!=l.indexOf("{0}")){for(var o=["<select class='",o.on?"":"ui-corner-all","'>"],a=0,s=n.length;a<s;a++){var d=n[a];o.push('<option value="',d,'">',d,"</option>")}o.push("</select>"),n=o.join(""),l="<span>"+(l=l.replace("{0}","</span>"+n))+"<span class='pq-separator'></span>"}else l="<span>"+l+"</span><span class='pq-separator'></span>";this.$rPP=t(l).appendTo(this.rPPHolder).filter("select").val(i.rPP).change(function(i){var r=t(this),o=r.val();if(!1===e._trigger("beforeChange",i,{rPP:o}))return r.val(e.options.rPP),!1;!1!==e._trigger("change",i,{rPP:o})&&(e.options.rPP=o)})}l=i.bootstrap.on,n=i.curPage>=i.totalPages,r(l,this.next,n),r(l,this.last,n),n=1>=i.curPage,r(l,this.first,n),r(l,this.prev,n),this.page.val(i.curPage),this.$total.text(i.totalPages),0<this.options.totalRecords?(l=i.rPP,n=i.curPage,o=i.totalRecords,(a=n*l)>o&&(a=o),i=(i=(i=(i=i.strDisplay).replace("{0}",(n-1)*l+1)).replace("{1}",a)).replace("{2}",o),this.$msg.html(i)):this.$msg.html("")},o.getInstance=function(){return{pager:this}},o._trigger=n._trigger,o.on=n.on,o.one=n.one,o.off=n.off}(jQuery),function(t){function e(t,e){return t?"<div class='"+e+"'></div>":"<div class='ui-icon ui-icon-"+e+"'></div>"}var i=t.paramquery,r={options:{length:200,num_eles:3,trigger:!1,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",bootstrap:{on:!1,slider:"btn btn-default",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down",left:"glyphicon glyphicon-chevron-left",right:"glyphicon glyphicon-chevron-right"},theme:!1},_destroy:function(){t(document).off("."+this.eventNamespace),this.element.removeClass("pq-sb pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty(),this.element.removeData()},_create:function(){this.listeners={},this._createLayout()},_setOption:function(t,e){var i=this.options;"disabled"==t?(this._super(t,e),!0==e?this.$slider.draggable("disable"):this.$slider.draggable("enable")):"theme"==t?(i[t]=e,this._createLayout()):"ratio"==t?0<=e&&1>=e&&(i[t]=e):i[t]=e},_setOptions:function(){this._super.apply(this,arguments),this.refresh()}};t.widget("paramquery.pqScrollBar",r),pq.scrollbar=function(e,i){var r=t(e).pqScrollBar(i);return r.data("paramqueryPqScrollBar")||r.data("paramquery-pqScrollBar")},r=i.pqScrollBar.prototype,i.pqScrollBar.defaults=r.options,r._createLayout=function(){var i=this,r=this.options,o=r.bootstrap,n=o.on,l=r.direction,a=this.eventNamespace,s=r.theme,d=this.element.empty();"vertical"==l?(d.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb pq-sb-vert"),s?(d.addClass("pq-sb-vert-t"),d[0].innerHTML=["<div class='top-btn pq-sb-btn ",n?"":"ui-state-default ui-corner-top","'>",e(n,n?o.up:"triangle-1-n"),"</div><div class='pq-sb-slider ",n?o.slider:"ui-corner-all ui-state-default","'></div><div class='bottom-btn pq-sb-btn ",n?"":"ui-state-default ui-corner-bottom","'>",e(n,n?o.down:"triangle-1-s"),"</div>"].join("")):(d.addClass("pq-sb-vert-wt"),d[0].innerHTML="<div class='top-btn pq-sb-btn'></div><div class='pq-sb-slider'><div class='vert-slider-top'></div><div class='vert-slider-bg'></div><div class='vert-slider-center'></div><div class='vert-slider-bg'></div><div class='vert-slider-bottom'></div></div><div class='bottom-btn pq-sb-btn'></div>")):(d.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb pq-sb-horiz"),s?(d.addClass("pq-sb-horiz-t"),d[0].innerHTML=["<div class='left-btn pq-sb-btn ",n?"":"ui-state-default ui-corner-left","'>",e(n,n?o.left:"triangle-1-w"),"</div><div class='pq-sb-slider pq-sb-slider-h ",n?o.slider:"ui-state-default ui-corner-all","'></div><div class='right-btn pq-sb-btn ",n?"":"ui-state-default ui-corner-right","'>",e(n,n?o.right:"triangle-1-e"),"</div>"].join("")):(d.addClass("pq-sb-horiz-wt"),d.width(this.width),d[0].innerHTML="<div class='left-btn pq-sb-btn'></div><div class='pq-sb-slider pq-sb-slider-h'><span class='horiz-slider-left'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-center'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-right'></span></div><div class='right-btn pq-sb-btn'></div>")),d.disableSelection().unbind(".pq-scrollbar").on("mousedown.pq-scrollbar",function(e){if(!r.disabled&&!i.$slider.is(":hidden")){if(t(document).off("."+a).on("mouseup."+a,function(t){i._mouseup(t)}),"vertical"==l){var o=e.pageY,n=i.element.offset().top,s=n+r.length,d=i.$slider,h=d.offset().top,c=d.height(),d=h+c;o<h&&o>n+17?i._setTimerPageLeft(o,c,e,0):o>d&&o<s-17&&i._setTimerPageRight(o,c,e,0)}else o=e.pageX,s=(n=i.element.offset().left)+r.length,d=(h=i.$slider.offset().left)+i.$slider.width(),o<h&&o>n+17?(i.$slider.css("left",o-i.element.offset().left),i._updateCurPosAndTrigger(e)):o>d&&o<s-17&&(i.$slider.css("left",o-i.element.offset().left-i.$slider.width()),i._updateCurPosAndTrigger(e))}}),(o=this.$slider=t("div.pq-sb-slider",this.element)).attr("tabindex","0"),this._bindSliderEvents(o),this.$top_btn=t("div.top-btn,div.left-btn",this.element).click(function(t){if(!i.options.disabled)return i.decr_cur_pos(t),!1}).mousedown(function(t){if(!i.options.disabled)return i.mousedownTimeout=setTimeout(function(){i.mousedownInterval=setInterval(function(){i.decr_cur_pos(t)},0)},i.options.timeout),!1}).bind("mouseup mouseout",function(t){i._mouseup(t)}),this.$bottom_btn=t("div.bottom-btn,div.right-btn",this.element).click(function(t){if(!i.options.disabled)return i.incr_cur_pos(t),!1}).mousedown(function(t){if(!i.options.disabled)return i.mousedownTimeout=setTimeout(function(){i.mousedownInterval=setInterval(function(){i.incr_cur_pos(t)},0)},i.options.timeout),!1}).bind("mouseup mouseout",function(t){i._mouseup(t)}),this.refresh()};var o=0;r._setTimerPageLeft=function(t,e,i,r){var n=this,l=n.options;this.mousedownTimeout=window.setTimeout(function(){if(t>=n.$slider.offset().top)n._mouseup();else{n._pageLeft(i);var r=o?0:l.timeout;o++,n._setTimerPageLeft(t,e,i,r)}},r)},r._setTimerPageRight=function(t,e,i,r){var n=this;this.mousedownTimeout=window.setTimeout(function(){if(t<=n.$slider.offset().top+e)n._mouseup();else{n._pageRight(i);var r=o?0:n.options.timeout;o++,n._setTimerPageRight(t,e,i,r)}},r)},r._bindSliderEvents=function(e){var i=this,r="x";"vertical"==this.options.direction&&(r="y"),e.draggable({axis:r,helper:function(t,e){return i._setDragLimits(),this},start:function(t){i.topWhileDrag=null,i.dragging=!0},drag:function(t){i.dragging=!0;var e=i.options.pace;"optimum"==e?i._setNormalPace(t):"fast"==e&&i._updateCurPosAndTrigger(t)},stop:function(t){"fast"!=i.options.pace&&i._updateCurPosAndTrigger(t),i.dragging=!1,i.refresh()}}).on("keydown.pq-scrollbar",function(e){var r=e.keyCode,o=i.options,n=o.cur_pos,l=o.ratio,a=o.num_eles,s=t.ui.keyCode;if(null==i.keydownTimeout&&(i.keydownTimeout=window.setTimeout(function(){r==s.DOWN||r==s.RIGHT?i.incr_cur_pos(e):r==s.UP||r==s.LEFT?i.decr_cur_pos(e):r==s.HOME?o.steps?0<n&&(o.cur_pos=0,i.updateSliderPos(),i.scroll(e)):0<l&&(o.ratio=0,i.updateSliderPos(),i.drag(e)):r==s.END?o.steps?n<a&&(o.cur_pos=a,i.updateSliderPos(),i.scroll(e)):1>l&&(o.ratio=1,i.updateSliderPos(),i.drag(e)):"vertical"==o.direction&&(r==s.PAGE_DOWN?i._pageRight(e):r==s.PAGE_UP&&i._pageLeft(e)),i.keydownTimeout=null},0)),r==s.DOWN||r==s.RIGHT||r==s.UP||r==s.LEFT||r==s.PAGE_DOWN||r==s.PAGE_UP||r==s.HOME||r==s.END)return e.preventDefault(),!1})},r.decr_cur_pos=function(t){var e=this.options;if(e.steps)0<e.cur_pos&&(e.cur_pos--,this.updateSliderPos(),this.scroll(t));else if(0<e.ratio){var i=e.ratio-1/(e.num_eles-1);0>i&&(i=0),e.ratio=i,this.updateSliderPos(),this.drag(t)}},r.incr_cur_pos=function(t){var e=this.options;if(e.steps)e.cur_pos<e.num_eles-1&&e.cur_pos++,this.updateSliderPos(),this.scroll(t);else{if(1>e.ratio){var i=e.ratio+1/(e.num_eles-1);1<i&&(i=1),e.ratio=i}this.updateSliderPos(),this.drag(t)}},r._mouseup=function(t){this.options.disabled||(o=0,window.clearTimeout(this.mousedownTimeout),this.mousedownTimeout=null,window.clearInterval(this.mousedownInterval),this.mousedownInterval=null)},r._setDragLimits=function(){var t=this.options;if("vertical"==t.direction){var e=this.element.offset().top+17,t=e+t.length-34-this.slider_length;this.$slider.draggable("option","containment",[0,e,0,t])}else t=(e=this.element.offset().left+17)+t.length-34-this.slider_length,this.$slider.draggable("option","containment",[e,0,t,0])},r._validateCurPos=function(){var t=this.options;t.cur_pos>=t.num_eles&&(t.cur_pos=t.num_eles-1),0>t.cur_pos&&(t.cur_pos=0)},r._updateSliderPosRatio=function(){var t=this.options,e=t.direction,i=t.ratio,r=this.$slider[0],t=t.length-34-this.slider_length;if(null==i)throw"updateSliderPosRatio ratio N/A";i=i*t+17,"vertical"==e?r.style.top=i+"px":r.style.left=i+"px"},r._updateSliderPosCurPos=function(){var t=this.options,e=this.$slider[0],i=this.scroll_space*t.cur_pos/(t.num_eles-1);"vertical"==t.direction?e.style.top=17+i+"px":e.style.left=17+i+"px"},r.updateSliderPos=function(){var t=this.options;if(void 0===t.steps)throw"updateSliderPos. steps N/A";t.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()},r.scroll=function(t){var e=this.options;this._trigger("scroll",t,{cur_pos:e.cur_pos,num_eles:e.num_eles})},r.drag=function(t){this._trigger("drag",t,{ratio:this.options.ratio})},r._pageRight=function(t){this._trigger("pageRight",t,null)},r._pageLeft=function(t){this._trigger("pageLeft",t,null)},r._setSliderBgLength=function(){var e=this.options,i=e.theme,r=this.$slider,o=e.length,o=Math.round(((o-34)*o/(40*e.num_eles+o)-14)/2);1>o&&(o=1);var n=14+2*o;this.scroll_space=e.length-34-n,n!==this.slider_length&&((this.slider_length=n,e="vertical"===e.direction?{dim:"height",cls:".vert-slider-bg"}:{dim:"width",cls:".horiz-slider-bg"},i)?r[e.dim](n-2):(t(e.cls,this.element)[e.dim](o),r[e.dim](n)))},r._updateCurPosAndTrigger=function(t,e){var i=this.options,r=i.direction,o=this.$slider;if(null==e&&(e=parseInt(o[0].style["vertical"===r?"top":"left"])),r=(e-17)/(i.length-34-this.slider_length),i.steps){if(r*=i.num_eles-1,r=Math.round(r),i.cur_pos!=r){if(this.dragging){if(null!=this.topWhileDrag&&(this.topWhileDrag<e&&i.cur_pos>r||this.topWhileDrag>e&&i.cur_pos<r))return;this.topWhileDrag=e}this.options.cur_pos=r,this.scroll(t)}}else i.ratio=r,this.drag(t)},r._setNormalPace=function(t){this.timer&&(window.clearInterval(this.timer),this.timer=null);var e=this,i=this.options.direction;e.timer=window.setInterval(function(){var r=parseInt(e.$slider[0].style["vertical"===i?"top":"left"]);e.prev_top===r&&(e._updateCurPosAndTrigger(t,r),window.clearInterval(e.timer),e.timer=null),e.prev_top=r},20)},r.refresh=function(){var t=this.options,e=this.$slider[0],i=this.element;1>=t.num_eles?i[0].style.display="none":(i[0].style.display="",this._validateCurPos(),this.dragging||(i["vertical"===t.direction?"height":"width"](t.length),this._setSliderBgLength(),e.style.display=4>this.scroll_space||1>=t.num_eles?"none":""),this.updateSliderPos())},r._trigger=i._trigger,r.on=i.on,r.one=i.one,r.off=i.off}(jQuery),function(t){t.paramquery=t.paramquery||{},t.paramquery.onResize=function(e,i){var r=t(e);"static"===r.css("position")&&r.css("position","relative");var o=t('<iframe type="text/html" src="about:blank" class="pq-resize-iframe" style="display:block;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;overflow: hidden; pointer-events: none;" />').appendTo(r);o[0].data="about:blank",o.css("opacity","0");for(var n=0;n<r.length;n++)t(o[n].contentWindow).on("resize",function(t){i()})}}(jQuery),function(t){function e(t){return"<span class='btn btn-sm glyphicon glyphicon-"+t+"' ></span>"}function i(t){return"<span class='ui-widget-header pq-ui-button'><span class='ui-icon ui-icon-"+t+"'></span></span>"}var r=function(){};r.prototype.belongs=function(t){if(t.target==this.that.element[0])return!0};var o=t.paramquery;o.cClass=r;var n,l,a=function(t){this.that=t;var e=this.options=t.options,i=this;i.odd=[],null!=e.postRenderInterval&&t.on("refresh",function(){i.prColDef.length&&i.postRenderAll()}).on("refreshRow",function(t,e){i.prColDef.length&&i.postRenderRow(e)}).on("refreshCell",function(t,e){e.column.postRender&&i.postRenderRow(e)}).on("refreshColumn",function(t,e){e.column.postRender&&i.setTimerPostRender(0,e.colIndx,e.column)}),e.mergeModel.flex||t.on("refresh refreshCell refreshRow refreshColumn",i.onRefreshMerge(t))};o.cGenerateView=a,(r=a.prototype=new r).onRefreshMerge=function(e){return function(){for(var i,r,o,n,l=e.$cont.find(".pq-merge-cell-div"),a=l.length,s=[],d=[];a--;)i=(i=l[a]).parentNode,r||(r=2*parseInt(t(i).css("paddingTop")),o=2*parseInt(t(i).css("paddingLeft"))),n=Math.max(i.offsetHeight,28),n-=r,i=i.offsetWidth-o,s[a]=n-1+"px",d[a]=i+"px";for(a=l.length;a--;)(i=l[a]).style.height=s[a],i.style.width=d[a]}},r.generateView=function(t){t=t||{};var e,i,r=this.that,n=r.options,l="flex"===n.width,a="flex"===n.height,s=n.cls,d=s.cont_inner,h=s.cont_inner_b,c=r.initH,u=r.finalH,p=r.pqpanes;if(t.$cont)e=this._generateTables(null,null,t),(s=t.$cont).empty(),s[0].innerHTML=p.v?["<div class='",d,"'>",e,"</div><div class='",d,"'>",e,"</div>"].join(""):["<div class='",d,"'>",e,"</div>"].join(""),n=s.children("div").children("table"),r.tables[0]={$tbl:n,$cont:s};else{e=r.initV,i=r.finalV;var f=r.pdata,s=r.$cont;null!=n.editModel.indices&&r.blurEditor({force:!0}),c={pageData:f,initV:e,finalV:i,initH:c,finalH:u,source:t.source},r._trigger("beforeTableView",null,c),e=this._generateTables(e,i,t),s.empty(),0===r.totalVisibleRows?s.append("<div class='"+d+" pq-grid-norows' >"+n.strNoRows+"</div>"):(t=a||l?"style='position:relative;'":"",s[0].innerHTML=p.h&&p.v?["<div class='",d,"'>",e,"</div><div class='",d,"'>",e,"</div><div class='",d," ",h,"'>",e,"</div><div class='",d," ",h,"'>",e,"</div>"].join(""):p.v?["<div class='",d,"' ",t," >",e,"</div><div class='",d,"' >",e,"</div>"].join(""):p.h?["<div class='",d,"' style='position:static;' >",e,"</div><div class='",d," ",h,"' style='position:static;' >",e,"</div>"].join(""):["<div class='",d,"' ",t," >",e,"</div>"].join("")),r.$tbl=s.children("div").children("table"),n.scrollModel.flexContent&&r.$tbl[0]&&o.onResize(r.$tbl[0],function(){var t=r.iRefresh;t.ignoreTResize||t.softRefresh()}),this.setPaneEvents(),r._trigger("refresh",null,c)}this.setPanes()},r.postRenderRow=function(t){var e,i=this.that,r=this.prColDef,o=i.iMerge,n=t.rowIndx;null!=t.colIndx&&(r=[{colIndx:t.colIndx,column:t.column}]);for(var l=0,a=r.length;l<a;l++)e=(t=r[l]).column.postRender,t=t.colIndx,o.ismergedCell(n,t)?o.isRootCell(n,t,"a")&&(t=o.getRootCell(n,t),e.call(i,t)):(t=i.normalize({rowIndx:n,colIndx:t}),e.call(i,t))},r.setTimerPostRender=function(t,e,i){var r,o=this.that,n=this,l=o.pdata;l&&l.length&&(n.postRenderTimeoutID=(r=function(){var r=o.initV,a=o.options.freezeRows;t<r&&t>=a&&(t=r),l[t].pq_hidden||n.postRenderRow({column:i,colIndx:e,rowIndx:t+o.rowIndxOffset}),++t<=o.finalV&&n.setTimerPostRender(t)},-1==o.options.postRenderInterval?r():setTimeout(r,0)))},r.postRenderAll=function(){var t=this.that,e=this,i=t.pdata,r=t.options.postRenderInterval,t=function(t){return -1==r?t():setTimeout(t,r)};i&&i.length&&(clearTimeout(e.postRenderTimeoutID),e.postRenderTimeoutID=t(function(){e.setTimerPostRender(0)}))},r.scrollView=function(){var t=this.that,e=this.options,i=e.virtualY;e.virtualX||t.hscroll.drag(),i||t.vscroll.drag()},r.setPaneEvents=function(){var e=this.that,i=e.pqpanes,r=e.$cont.children("div"),o=e.iMouseSelection;if((e=e.$tbl)&&e.length){if(i.h&&i.v){var i=t(r[0]),e=t(r[1]),n=t(r[2]),r=t(r[3]);i.on("scroll",function(t){this.scrollLeft=this.scrollTop=0}),e.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=o.getScrollLeft(!0)}),n.on("scroll",function(t){this.scrollTop=o.getScrollTop(!0),this.scrollLeft=0}),r.on("scroll",function(t){this.scrollTop=o.getScrollTop(!0),this.scrollLeft=o.getScrollLeft(!0)})}else i.v?(i=t(r[0]),r=t(r[1]),i.on("scroll",function(t){this.scrollTop=o.getScrollTop(!0),this.scrollLeft=0}),r.on("scroll",function(t){this.scrollTop=o.getScrollTop(!0),this.scrollLeft=o.getScrollLeft(!0)})):i.h?(i=t(r[0]),r=t(r[1]),i.on("scroll",function(t){this.scrollTop=0,this.scrollLeft=o.getScrollLeft(!0)}),r.on("scroll",function(t){this.scrollTop=o.getScrollTop(!0),this.scrollLeft=o.getScrollLeft(!0)})):r.on("scroll",function(t){this.scrollTop=o.getScrollTop(!0),this.scrollLeft=o.getScrollLeft(!0)})}},r.setPanes=function(){var e=this.that,i=e.pqpanes,r=e.$cont.children("div"),o=e.iRefresh,n=e.$tbl,l=e.options,a=e.calcWidthCols(-1,1*l.freezeCols)+1,s="flex"!==l.width||l.maxWidth?o.getEContWd():"";if(e.tables.length){var d=e.tables[0].$tbl,h=e.tables[0].$cont,c=d.parent("div");i.v?(t(c[0]).css({width:a}),t(c[1]).css({left:a,width:s-a}),t(d[1]).css({left:-1*a})):t(c[0]).css({width:s}),h.height(d[0].scrollHeight-1),o.setContHeight()}if(n&&n.length){if(o="flex"!==l.height||l.maxHeight?o.getEContHt():"",i.h&&i.v){var d=t(r[0]),h=t(r[1]),c=t(n[1]),u=t(r[2]),p=t(n[2]),r=t(r[3]),f=t(n[3]),n=e.calcHeightFrozenRows();d.css({width:a,height:n}),h.css({left:a,width:s-a,height:n}),c.css({left:-1*a}),u.css({width:a,top:n,height:o-n}),p.css({marginTop:-(n+1)}),r.css({left:a,width:s-a,top:n,height:o-n}),f.css({marginTop:-(n+1),left:-1*a})}else i.v?(d=t(r[0]),r=t(r[1]),n=t(n[1]),d.css({width:a,height:o}),r.css({left:a,width:s-a,height:o}),n.css({left:-1*a})):i.h?(d=t(r[0]),r=t(r[1]),h=t(n[1]),n=e.calcHeightFrozenRows(),d.css({height:n,width:s}),r.css({width:s,top:n,height:o-n}),h.css({marginTop:-(n+1)})):r.css({width:s,height:o})}l.showHeader&&(i.vH?(e.$header_left.css({width:a}),e.$header_right.css({left:a,width:s-a}),e.$header_right_inner.css({left:-a})):e.$header_left.css({width:s}))},r.createColDefs=function(){for(var t=this.that,e=t.colModel,i=t.initH,r=t.finalH,t=t.options.freezeCols,o=[],n=[],l=0;l<=r;l++){if(l<i&&l>=t&&(l=i)>r)throw"initH>finalH";var a=e[l];a.hidden||(o.push({column:a,colIndx:l}),a.postRender&&"function"==typeof a.postRender&&n.push({column:a,colIndx:l}))}this.colDef=o,this.prColDef=n},r._generateTables=function(t,e,i){i=i||{};var r=this.that,o=r.options,n=o.bootstrap,l=o.numberCell,a=!0,s=1*o.freezeRows,d=0,h=i.other,c=this.odd;if(e=h?i.data.length-1:e,h?i=i.data:(i=r.pdata,this.setFrozenRip(i,s)),h||null!=t&&null!=e){if(d=["pq-grid-table"],n.on&&d.push(n.tbody),o.columnBorders&&d.push("pq-td-border-right"),o.rowBorders&&d.push("pq-td-border-top"),d.push(o.wrap?"pq-wrap":"pq-no-wrap"),(o=["<table class='"+d.join(" ")+"' >"]).push("<tr class='pq-row-hidden'>"),l.show){var u=l.width;o.push("<td style='width:"+u+"px;' ></td>")}for(d=this.colDef,l=0,n=d.length;l<n;l++)r=(u=d[l]).colIndx,u=u.column.outerWidth,o.push("<td style='width:",u,"px;' pq-col-indx='",r,"'></td>");for(o.push("</tr>"),d=0;d<=e;d++)d<t&&d>=s&&(d=t),l=i[d],n=d,l&&l.pq_hidden||(c[n]=a=!a,r=l.pq_detail&&l.pq_detail.show,this._generateRow(l,n,o,h,r),r&&this._generateDetailRow(l,n,o));return o.push("</table>"),o.join("")}},r.appendRow=function(t){var e=this.that,i=e.pdata,r=e.colModel,o=e.finalV;if(o+t>i.length&&(t=i.length-o),t){if(1<t)throw"noRows > 1";e._trigger("beforeTableView",null,{pageData:i,initV:o,finalV:o,initH:e.initH,finalH:e.finalH,colModel:r}),e.refreshRow({rowIndxPage:o,refresh:!1})}return t},r.prependRow=function(t){var e=this.that,i=e.options.freezeRows,r=e.calcVisibleRows(e.pdata,0,i),o=e.pdata,n=e.initV,l=e.colModel;if(e._mergeCells){if(r)for(r=0;r<i;r++)e.refreshRow({rowIndxPage:r,refresh:!1});e.refreshRow({rowIndxPage:n+1,refresh:!1})}return e._trigger("beforeTableView",null,{pageData:o,initV:n,finalV:n,initH:e.initH,finalH:e.finalH,colModel:l}),e.refreshRow({rowIndxPage:n,refresh:!1}),t},r.removeTopRow=function(e){for(var i=this.that,r=i.options.freezeRows,o=i.calcVisibleRows(i.pdata,0,r),n=i.$tbl,l=t([]),a=0;a<n.length;a++)var s=t(n[a]).children("tbody").children("tr:gt(0)").slice(o,e+o),l=l.add(s);if(l.remove(),i._mergeCells){if(o)for(a=0;a<r;a++)i.refreshRow({rowIndxPage:a,refresh:!1});i.refreshRow({rowIndxPage:i.initV,refresh:!1})}},r.removeBottomRow=function(e){var i=this.that.$tbl;if(e)for(var r=0;r<i.length;r++)t(i[r]).children("tbody").children("tr:gt(0)").slice(-e).remove()},r.format=(n=t.datepicker,l=pq.formatNumber,function(t,e,i){return"date"!=i?l(t,e):isNaN(Date.parse(t))?void 0:n.formatDate(e,new Date(t))}),r.renderCell=function(t){var e=this.that,i=[],r=[],o=t.Export,n=!1,l=this.options,a=["pq-grid-cell"];if(!t.other&&!o&&e._mergeCells){if(null==(t=e.iMerge.renderCell(t)))return"";t.rowspan&&(i.push("rowspan='"+t.rowspan+"'","colspan='"+t.colspan+"'"),l.mergeModel.flex||(n=!0,a.push("pq-merge-cell"))),t.style&&r.push(t.style),t.cls&&a.push(t.cls)}var s=t.rowData,d=t.column,c=t.colIndx,u=d.dataIndx,p=l.freezeCols,l=l.columnBorders;if(s){o||(i.push("pq-col-indx='"+c+"'"),"right"==d.align?a.push("pq-align-right"):"center"==d.align&&a.push("pq-align-center"),c==p-1&&l&&a.push("pq-last-frozen-col"),(c=d.cls)&&a.push(c),(c=e.iSelection.dirty?null:s.pq_cellselect)&&c[u]&&a.push(e.iCells.hclass));var f,p=s[u],c=(c=d.format)?this.format(p,c,d.dataType):p;if(t.dataIndx=u,t.cellData=p,t.formatVal=c,d.render&&(f=d.render.call(e,t))&&"string"!=typeof f){var p=f.attr,l=f.cls,g=f.style;p&&i.push(p),l&&a.push(l),g&&r.push(g),f=f.text}if(null==f&&d._render&&(f=d._render.call(e,t)),f&&"string"!=typeof f&&(p=f.attr,l=f.cls,g=f.style,p&&i.push(p),l&&a.push(l),g&&r.push(g),f=f.text),null==f&&(f=c),o)return f;if((""===f||void 0==f)&&(f="&nbsp;"),(t=s.pq_cellcls)&&(t=t[u])&&a.push(t),(s=s.pq_cellattr)&&(u=s[u])){var v,u=h(u);for(v in u)s=u[v],"style"==v?r.push(s):i.push(v+'="'+s+'"')}return r=r.length?" style='"+r.join("")+"' ":"",["<td class='",a.join(" "),"' ",i.join(" "),r," >",n?"<div class='pq-merge-cell-div'><div><div class='pq-merge-inner'>":"",f,n?"</div></div></div>":"","</td>"].join("")}},r.setFrozenRip=function(t,e){if(t){for(var i;e--&&(i=t[e])&&i.pq_hidden;);this.frozenRip=e}},r.refreshRow=function(t,e){var i=this.that.pdata[t];this._generateRow(i,t,e,null,i.pq_detail&&i.pq_detail.show)},r._generateRow=function(t,e,i,r,o){var n=["pq-grid-row"];this.frozenRip===e&&n.push("pq-last-frozen-row"),o&&n.push("pq-detail-master");var l=this.that,a=this.options,s=a.rowInit;o=a.numberCell;var d="",c="",u=l.rowIndxOffset,p=e+u;if(s&&(s=s.call(l,{rowData:t,rowIndxPage:e,rowIndx:p}))&&(s.cls&&n.push(s.cls),d+=s.attr?" "+s.attr:"",c+=s.style?s.style:""),a.stripeRows&&this.odd[e]&&n.push("pq-grid-oddRow"),t.pq_rowselect&&n.push(l.iRows.hclass),null!=(l=t.pq_rowcls)&&n.push(l),l=t.pq_rowattr){var f,l=h(l);for(f in l)d+=" "+f+'="'+l[f]+'"'}for(c=c?"style='"+c+"'":"",i.push("<tr pq-row-indx='",e,"' class='",n.join(" "),"' ",d," ",c," >"),o.show&&i.push(["<td pq-col-indx='-1' class='pq-grid-number-cell'>",r?"&nbsp;":p+1,"</td>"].join("")),t={rowIndx:e+u,rowIndxPage:e,other:r,rowData:t},e=this.colDef,r=0,n=e.length;r<n;r++)o=(f=e[r]).colIndx,t.column=f.column,t.colIndx=o,i.push(this.renderCell(t));return i.push("</tr>"),i},r._generateDetailRow=function(t,e,i){var r=["pq-grid-row pq-detail-child"],o=this.that,n=o.options,l=n.numberCell;return n.stripeRows&&this.odd[e]&&r.push("pq-grid-oddRow"),t.pq_rowselect&&r.push(o.iRows.hclass),null!=(t=t.pq_rowcls)&&r.push(t),i.push("<tr pq-row-indx='"+e+"' class='"+r.join(" ")+"' >"),l.show&&i.push("<td class='pq-grid-number-cell'>&nbsp;</td>"),i.push("<td class='pq-grid-cell pq-detail-child' colSpan='20'></td>"),i.push("</tr>"),i},(r={widgetEventPrefix:"pqgrid",_create:function(){var e=this,i=this.options,r=i.dataModel,n=i.bootstrap,l=n.on,d=i.roundCorners&&!l,h=i.ui,u=i.sortModel;if(this.BS_on=l,i.collapsible||(i.collapsible={on:!1,collapsed:!1}),i.flexHeight&&(i.height="flex"),i.flexWidth&&(i.width="flex"),r.sortIndx){u.on=i.sortable,u.type=r.sorting;var p=[],f=r.sortIndx,r=r.sortDir;if(t.isArray(f)){for(var g=0;g<f.length;g++){var v=r&&r[g]?r[g]:"up";p.push({dataIndx:f[g],dir:v})}u.single=!1}else p.push({dataIndx:f,dir:r||"up"}),u.single=!0;u.sorter=p}!1===i.virtualXHeader&&(i.virtualXHeader=null),this.setEditorPosTimer(),this.iGenerateView=new a(this),this.iRefresh=new o.cRefresh(this),this.iKeyNav=new c(this),this.iIsValid=new s(this),this.tables=[],this.$tbl=null,this.iColModel=new o.cColModel(this),this.iSort=new o.cSort(this),this.iHeader=new o.cHeader(this),this._initTypeColumns(),(u=this.element).on("scroll"+this.eventNamespace,function(){this.scrollTop=this.scrollLeft=0}),p=l?n.grid:h.grid,f=l?"":h.header_o,r=l?"":h.bottom,n=l?n.top:h.top,u.empty().addClass("pq-grid "+p+" "+(d?" ui-corner-all":"")).html(["<div class='pq-grid-top ",n," ",d?" ui-corner-top":"","'><div class='pq-grid-title",d?" ui-corner-top":"","'>&nbsp;</div></div><div class='pq-grid-center' ><div class='pq-header-outer ",f,"'></div><div class='pq-grid-cont-outer' ><div class='pq-grid-cont' tabindex='0'></div></div></div><div class='pq-grid-bottom ",r," ",d?" ui-corner-bottom":"","'><div class='pq-grid-footer'></div></div>"].join("")),this.$bottom=t("div.pq-grid-bottom",u),this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel}),this.$top=t("div.pq-grid-top",u),i.showTop||this.$top.css("display","none"),this.$title=t("div.pq-grid-title",u),i.showTitle||this.$title.css("display","none"),d=this.$grid_center=t("div.pq-grid-center",u).on("scroll",function(){this.scrollTop=0}),this.$header_o=t("div.pq-header-outer",this.$grid_center).on("scroll",function(){this.scrollLeft=this.scrollTop=0}),this.$footer=t("div.pq-grid-footer",u),this.$cont_o=t(".pq-grid-cont-outer",d),n=this.$cont=t("div.pq-grid-cont",d),t(window).bind("resize"+e.eventNamespace+" orientationchange"+e.eventNamespace,function(t,i){e.onWindowResize(t,i)}),n.on("click",".pq-grid-cell,.pq-grid-number-cell",function(i){if(!0!==t.data(i.target,e.widgetName+".preventClickEvent")&&t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onClickCell(i)}),n.on("click","tr.pq-grid-row",function(i){if(!0!==t.data(i.target,e.widgetName+".preventClickEvent")&&t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onClickRow(i)}),n.on("contextmenu","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRightClickCell(i)}),n.on("contextmenu","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRightClickRow(i)}),n.on("dblclick","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onDblClickCell(i)}),n.on("dblclick","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onDblClickRow(i)}),n.on("blur",function(){e.onblur()}),n.on("focus",function(){e.onfocus()}),n.on("mousedown",function(i){if(1===i.which){var r,o=t(i.target);if(o.closest(".pq-grid")[0]==e.element[0]){if((r=o.closest(".pq-grid-cell:not(.pq-detail-child)")).length&&(i.currentTarget=r[0],!1===(r=e._onCellMouseDown(i))))return!1;if(!i.isPropagationStopped()){if((o=o.closest(".pq-grid-row")).length&&(i.currentTarget=o[0],!1===(r=e._onRowMouseDown(i))))return!1;if(!i.isPropagationStopped())return e._onContMouseDown(i)}}}}),n.on("mouseenter","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseEnter(i,t(this))}),n.on("mouseenter","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseEnter(i,t(this))}),n.on("mouseleave","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseLeave(i,t(this))}),n.on("mouseleave","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseLeave(i,t(this))}),n.on("keyup",function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._trigger("keyUp",i,null)}),d.bind("mousewheel DOMMouseScroll",function(t){return e._onMouseWheel(t)}),this.$hvscroll=t("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(d),l=t("<div class='pq-vscroll'></div>").appendTo(d),this.prevVScroll=0,void 0===(n=i.scrollModel).lastColumn&&i.virtualX&&(n.lastColumn="auto"),this.vscroll=pq.scrollbar(l,{pace:n.pace,theme:n.theme,bootstrap:i.bootstrap,steps:i.virtualY&&!n.smooth,direction:"vertical",cur_pos:0,pageRight:function(){e.iKeyNav.pageDown()},pageLeft:function(){e.iKeyNav.pageUp()},drag:function(t,i){e.iMouseSelection.syncViewWithScrollBarVert(i.ratio)},scroll:function(t,i){e.iRefresh.refreshVscroll(i)}}),l=t("<div class='pq-hscroll'></div>").appendTo(d),"flex"===i.height&&l.css("position","relative"),this.hscroll=pq.scrollbar(l,{direction:"horizontal",pace:n.pace,bootstrap:i.bootstrap,theme:n.theme,steps:i.virtualX&&!n.smooth,cur_pos:0,drag:function(t,i){e.iMouseSelection.syncViewWithScrollBarHor(i.ratio)},scroll:function(){i.virtualX&&!i.scrollModel.smooth&&e.refresh()}}),i.selectionModel.native||this.disableSelection(),d.bind("keydown.pq-grid",function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._onKeyPressDown(i)}),this._refreshTitle(),this.iRows=new o.cRows(this),this.iCells=new o.cCells(this),this.generateLoading(),this._initPager(),this._refreshResizable(),this._refreshDraggable(),this.iResizeColumns=new o.cResizeColumns(this),this._mouseInit()},_mouseDown:function(e){var i=this;if(!t(e.target).closest(".pq-editor-focus").length)return this._saveDims(),this._mousePQUpDelegate=function(t){return i._mousePQUp(t)},t(document).bind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._super(e);this._blurEditMode=!0,window.setTimeout(function(){i._blurEditMode=!1},0)},destroy:function(){for(var e in this._trigger("destroy"),this._super(),window.clearInterval(this._refreshEditorPosTimer),this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout),this)delete this[e];this.options=void 0,t.fragments={}},_setOption:function(t,e){var i=this.options,r=i.dataModel;if("height"===t)"flex"===e?(r=this.vscroll,e&&r&&r.widget().hasClass("pq-sb-vert")&&(i.virtualY?r.option("cur_pos",0):r.option("ratio",0)),this.hscroll.widget().css("position","relative")):"flex"===i.height&&this.hscroll.widget().css("position",""),i[t]=e;else if("width"===t&&"flex"==e)i[t]=e,r=this.hscroll,e&&r&&r.widget().hasClass("pq-sb-horiz")&&(i.virtualX?r.option("cur_pos",0):r.option("ratio",0));else if("title"==t)i[t]=e,this._refreshTitle();else if("roundCorners"==t)(i[t]=e)?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"));else if("virtualX"==t)i[t]=e,this.hscroll.option("steps",e);else if("virtualY"==t)i[t]=e,this.vscroll.option("steps",e);else if("freezeCols"==t)!isNaN(e=parseInt(e))&&0<=e&&e<=this.colModel.length-2&&(i[t]=e);else if("freezeRows"==t)!isNaN(e=parseInt(e))&&0<=e&&(i[t]=e);else if("resizable"==t)i[t]=e,this._refreshResizable();else if("draggable"==t)i[t]=e,this._refreshDraggable();else if("scrollModel"==t)i[t]=e;else if("dataModel"==t)e.data!==r.data&&r.dataUF&&(r.dataUF.length=0),i[t]=e;else{if("groupModel"==t)throw"use groupOption() to set groupModel options.";"pageModel"==t?i[t]=e:"selectionModel"===t?i[t]=e:"colModel"===t||"columnTemplate"==t?(i[t]=e,this.iColModel.init()):"disabled"===t?(this._super(t,e),!0===e?this._disable():this._enable()):"numberCell"===t?(i[t]=e,this.iRefresh.decidePanes()):"strLoading"===t?(i[t]=e,this._refreshLoadingString()):"showTop"===t?(i[t]=e,this.$top.css("display",e?"":"none")):"showTitle"===t?(i[t]=e,this.$title.css("display",e?"":"none")):"showToolbar"===t?(i[t]=e,this._toolbar.widget().css("display",e?"":"none")):"toolbar"==t?i[t]=e:"collapsible"===t?(i[t]=e,this._createCollapse()):"showBottom"===t?(i[t]=e,this.$bottom.css("display",e?"":"none")):i[t]=e}return this}}).options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",trigger:!1,bootstrap:{on:!1,thead:"table table-striped table-condensed table-bordered",tbody:"table table-condensed",grid:"panel panel-default",top:"",btn:"btn btn-default",groupModel:{icon:["glyphicon-triangle-bottom","glyphicon-triangle-right"]},header_active:"active"},ui:{on:!0,grid:"ui-widget ui-widget-content",top:"ui-widget-header",bottom:"ui-widget-header",header_o:"ui-widget-header",header:"ui-state-default",header_active:"ui-state-active"},cls:{cont_inner:"pq-grid-cont-inner",cont_inner_b:"pq-grid-cont-inner-b"},distance:3,collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1e3}},colModel:null,columnBorders:!0,dataModel:{data:[],dataUF:[],cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:2,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:t.ui.keyCode.ENTER,onSave:"nextFocus",onTab:"nextFocus",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"textbox"},groupModel:{on:!1,title:[],titleDefault:"{0} ({1})",header:!0,headerMenu:!0,menuItems:["merge","fixCols","grandSummary"],fixCols:!0,icon:["ui-icon-triangle-1-se","ui-icon-triangle-1-e"],dataIndx:[],collapsed:[],dir:[],showSummary:[],summaryEdit:!0,refreshOnChange:!0},summaryOptions:{number:"avg,sum,max,min",date:"count,max,min",string:"count"},summaryTitle:{avg:"Avg: {0}",count:"Count: {0}",max:"Max: {0}",min:"Min: {0}",sum:"Sum: {0}"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,freezeBorders:!0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"99%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,rowHeight:25,scrollModel:{pace:"fast",smooth:!1,horizontal:!0,lastColumn:"auto",autoFit:!1,theme:!0},selectionModel:{type:"cell",onTab:"nextFocus",row:!0,mode:"block"},swipeModel:{on:!0,speed:20,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0},t.extend(!0,r.options,{strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strGroup_header:"Drag a column here to group by that column",strGroup_merge:"Merge cells",strGroup_fixCols:"Fix columns",strGroup_grandSummary:"Grand summary",strLoading:"Loading",strNoRows:"No rows to display."}),t.widget("paramquery._pqGrid",t.ui.mouse,r),(r=o._pqGrid.prototype).readCell=function(t,e,i,r,o){return e=e.dataIndx,i&&!1===i.isRootCell(r,o,"o")?void 0:t[e]},r.saveCell=function(t,e,i){t[e.dataIndx]=i},r._destroyResizable=function(){var t=this.element,e=t.data();(e.resizable||e.uiResizable||e["ui-resizable"])&&t.resizable("destroy")},r._disable=function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},r._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},r._destroy=function(){this.loading&&this.xhr.abort(),this._destroyResizable(),this._destroyDraggable(),this._mouseDestroy(),this.element.off(this.eventNamespace),t(window).unbind(this.eventNamespace),t(document).unbind(this.eventNamespace),this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},r.collapse=function(t){var e=this,i=this.element,r=this.options.collapsible,o=r.$collapse.children("span"),n=function(){i.css("overflow","hidden"),o.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n"),i.hasClass("ui-resizable")&&i.resizable("destroy"),e._toolbar&&e._toolbar.disable(),r.collapsed=!0,r._collapsed=!0,r.animating=!1,e._trigger("collapse")};if(t=t||{},r._collapsed)return!1;r.htCapture=i.height(),!1===t.animate?(i.height(23),n()):(r.animating=!0,i.animate({height:"23px"},function(){n()}))},r.expand=function(t){var e=this,i=this.element,r=this.options.collapsible,o=r.htCapture,n=r.$collapse.children("span"),l=function(){i.css("overflow",""),r._collapsed=!1,r.collapsed=!1,e._refreshResizable(),r.refreshAfterExpand&&e.refresh(),n.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s"),e._toolbar&&e._toolbar.enable(),r.animating=!1,e._trigger("expand")};if(t=t||{},!1===r._collapsed)return!1;!1===t.animate?(i.height(o),l()):(r.animating=!0,i.animate({height:o},function(){l()}))},r._createCollapse=function(){var r=this,o=this.$top,n=this.BS_on,l=this.options.collapsible;l.$stripe||(o=t("<div class='pq-slider-icon pq-no-capture'  ></div>").appendTo(o),l.$stripe=o),l.on?l.$collapse||(l.$collapse=t(n?e("collapse-down"):i("circle-triangle-n")).appendTo(l.$stripe).click(function(t){l.collapsed?r.expand():r.collapse()})):l.$collapse&&(l.$collapse.remove(),delete l.$collapse),l.collapsed&&!l._collapsed?r.collapse({animate:!1}):!l.collapsed&&l._collapsed&&r.expand({animate:!1}),l.toggle?l.$toggle||(l.$toggle=t(n?e("fullscreen"):i("arrow-4-diag")).prependTo(l.$stripe).click(function(t){r.toggle()})):l.$toggle&&(l.$toggle.remove(),delete l.$toggle)},r.toggle=function(){var e,i=this.options,r=i.collapsible,o=this.element,n=this._maxim;e=n?"min":"max";var l=t(document.body);if(!1===this._trigger("beforeToggle",null,{state:e}))return!1;"min"==e?(i=n.eleObj,r=n.docObj,this.option({height:i.height,width:i.width,maxHeight:i.maxHeight,maxWidth:i.maxWidth}),o[0].style.cssText=i.cssText,l[0].style.cssText=r.cssText,t("html").css({overflow:"visible"}),window.scrollTo(r.scrollLeft,r.scrollTop),this._maxim=null):(i={height:i.height,width:i.width,cssText:o[0].style.cssText,maxHeight:i.maxHeight,maxWidth:i.maxWidth},this.option({height:"100%",width:"100%",maxHeight:null,maxWidth:null}),o.css(t.extend({position:"fixed",left:0,top:0,margin:0},r.css)),r={scrollLeft:t(window).scrollLeft(),scrollTop:t(window).scrollTop(),cssText:l[0].style.cssText},l.css({height:0,width:0,overflow:"hidden",position:"static"}),t("html").css({overflow:"hidden"}),window.scrollTo(0,0),this._maxim={eleObj:i,docObj:r}),this._trigger("toggle",null,{state:e}),this._refreshResizable(),this.refresh(),t(window).trigger("resize",{$grid:o,state:e})},r._mouseCapture=function(e){var i=this.options;return(!i.virtualX||!i.virtualY||!!i.scrollModel.smooth)&&!!e.target&&t(e.target).closest(".pq-grid")[0]==this.element[0]&&!1!=(e=i.swipeModel).on&&("touch"!=e.on||!!t.support.touch)},r._saveDims=function(){var e=this.$tbl,i=this.$tbl_header;if(e)for(var r=0;r<e.length;r++){var o=e[r],n=t(o);n.data("offsetHeight",Math.round(o.offsetHeight)-1),n.data("scrollWidth",Math.round(o.scrollWidth))}if(i)for(r=0;r<i.length;r++)(e=t(o=i[r]).parent()).data("offsetHeight",Math.round(o.offsetHeight)),e.data("scrollWidth",Math.round(o.scrollWidth))},r._mousePQUp=function(e){t(document).unbind("mouseup"+this.eventNamespace,this._mousePQUpDelegate),this._trigger("mousePQUp",e,null)},r._mouseStart=function(t){return this.blurEditor({force:!0}),!0},r._mouseDrag=function(t){return!1!=this._trigger("mouseDrag",t,null)},r._mouseStop=function(t){return!1!=this._trigger("mouseStop",t,null)},r.onWindowResize=function(e,i){var r=this,o=r.options,n=r.element,l=n.parent();if(i){var a=i.$grid;if(a&&(a==n||0==n.closest(a).length))return}l.length&&(l[0]==document.body||"fixed"==n.css("position")?(n=window.innerHeight?window.innerHeight:t(window).height(),l=t(window).width()):(n=l.height(),l=l.width()),null==r._lastParentHt||n!=r._lastParentHt||l!=r._lastParentWd)&&(r._lastParentHt=n,r._lastParentWd=l,t.support.touch&&o.editModel.indices&&t(document.activeElement).is(".pq-editor-focus")||(r.autoResizeTimeout&&clearTimeout(r.autoResizeTimeout),r.autoResizeTimeout=window.setTimeout(function(){r._refreshAfterResize(),delete r.autoResizeTimeout},o.autoSizeInterval||0)))},r._onMouseWheel=function(t){this._saveDims();var e=this.options,i=0,r=!1,o=(t=t.originalEvent).wheelDeltaX,n=t.wheelDeltaY,l=t.wheelDelta;if(o&&Math.abs(o)>Math.abs(n)){if("flex"==e.width)return!0;r=!0,i=o/120}else if(l){if(!this.iRefresh.vscroll)return!0;i=l/120}else if(t.detail){if(!this.iRefresh.vscroll)return!0;i=-1*t.detail/3}if(i*=3,n=parseInt((t=r?this.hscroll:this.vscroll).option("cur_pos")),o=parseInt(t.option("num_eles")),!e.scrollModel.smooth&&(r&&e.virtualX||!r&&e.virtualY)){if(0>(e=n-(i=0<i?Math[1>i?"ceil":"floor"](i):Math[-1>i?"ceil":"floor"](i)))?e=0:e>o-1&&(e=o-1),e==n)return!0;t.option("cur_pos",n-i),t.scroll()}else{if(1<(i=(e=t.option("ratio"))-i/(o-1))?i=1:0>i&&(i=0),e==i)return!0;t.option("ratio",i),t.drag()}return!1},r._onDblClickCell=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i}),o=r.rowIndxPage,n=o+this.rowIndxOffset,r=r.colIndx;if(null!=r){if(!1==this._trigger("cellDblClick",e,{$td:i,rowIndxPage:o,rowIndx:n,colIndx:r,column:this.colModel[r],rowData:this.pdata[o]}))return!1;1<this.options.editModel.clicksToEdit&&this.isEditableRow({rowIndx:n})&&this.isEditableCell({colIndx:r,rowIndx:n})&&this.editCell({rowIndxPage:o,colIndx:r})}},r._onClickCont=function(t){},r._onClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)&&!1==this._trigger("rowClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]}))return!1},r._onRightClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)&&!1==this._trigger("rowRightClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]}))return!1},r._onDblClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=this.getRowIndxOffset();if(!1==this._trigger("rowDblClick",e,{$tr:i,rowIndxPage:r,rowIndx:r+o,rowData:this.pdata[r]}))return!1},r.getValueFromDataType=function(e,i,r){if("date"==i)return isNaN(i=Date.parse(e))?"":r?i:e;if("object"==i)return e;if("integer"==i)i=parseInt(e);else{if("float"!=i)return"bool"==i?0==(i=t.trim(e).toLowerCase()).length?null:"true"==i||"yes"==i||"1"==i||"false"!=i&&"no"!=i&&"0"!=i&&Boolean(i):t.trim(e);i=parseFloat(e)}return isNaN(i)||null==i?null==e?e:null:i};var s=function(t){this.that=t},d=s.prototype;d._isValidCell=function(t){var e=this.that,i=t.column,r=i.validations;if(!r||!r.length)return{valid:!0};var o=t.value,n=i.dataType,l=function(t){return e.getValueFromDataType(t,n,!0)};if(!(t=t.rowData))throw"rowData required.";for(var a=0;a<r.length;a++){var s=r[a],d=s.type,h=!1,c=s.msg,u=s.value;if(!1!==s.on&&(null==o&&"function"!=typeof d?h=!1:"minLen"==d?(o=l(o),u=l(u),o.length>=u&&(h=!0)):"nonEmpty"==d?null!=o&&""!==o&&(h=!0):"maxLen"==d?(o=l(o),u=l(u),o.length<=u&&(h=!0)):"gt"==d?(o=l(o))>(u=l(u))&&(h=!0):"gte"==d?(o=l(o))>=(u=l(u))&&(h=!0):"lt"==d?(o=l(o))<(u=l(u))&&(h=!0):"lte"==d?(o=l(o))<=(u=l(u))&&(h=!0):"neq"==d?(o=l(o))!==(u=l(u))&&(h=!0):"regexp"==d?RegExp(u).test(o)&&(h=!0):"function"==typeof d?(u={column:i,value:o,rowData:t,msg:c},!1==d.call(e,u)?(h=!1,u.msg!=c&&(c=u.msg)):h=!0):h=!0,!h))return{valid:!1,msg:c,column:i,warn:s.warn,dataIndx:i.dataIndx,validation:s}}return{valid:!0}},d.isValidCell=function(e){var i,r,o=this.that,n=e.rowData,l=e.rowIndx,a=e.value,s=e.valueDef,d=e.column,h=e.focusInvalid,c=o.options,u=c.bootstrap,p=e.allowInvalid,f=d.dataIndx,g=c.validation,v=c.warning,w=c.editModel,m=w.invalidClass,x=w.warnClass,w=document.activeElement;if(e.checkEditable&&!1==o.isEditableCell({rowIndx:l,dataIndx:f}))return{valid:!0};var a=(e=this._isValidCell({column:d,value:a,rowData:n})).valid,d=e.warn,$=e.msg;if(a)o.data({rowData:n,dataIndx:f,data:"pq_valid"})&&(o.removeClass({rowData:n,rowIndx:l,dataIndx:f,cls:x+" "+m}),o.removeData({rowData:n,dataIndx:f,data:"pq_valid"}));else var g=t.extend({},d?v:g,e.validation),_=g.css,I=g.cls,y=g.icon,b=g.style;if(p||d)return a?{valid:!0}:(o.addClass({rowData:n,rowIndx:l,dataIndx:f,cls:d?x:m}),o.data({rowData:n,dataIndx:f,data:{pq_valid:{css:_,icon:y,style:b,msg:$,cls:I}}}),e);if(!a){if(null==l&&(null==(l=(n=o.getRowIndx({rowData:n,dataUF:!0})).rowIndx)||n.uf))return e.uf=n.uf,e;if(h){if(s){if(t(w).hasClass("pq-editor-focus")&&(s=c.editModel.indices)){if(c=s.rowIndx,s=s.dataIndx,null!=l&&l!=c)throw"incorrect usage of isValid rowIndx: "+l;if(f!=s)throw"incorrect usage of isValid dataIndx:"+f;o.editCell({rowIndx:c,dataIndx:f})}}else o.goToPage({rowIndx:l}),l={rowIndx:l,dataIndx:f},l=o.normalize(l),i=o.getCell(l),o["cell"==c.selectionModel.type?"setSelection":"scrollCell"](l),o.focus(l);if(i||(r=o.getEditCell())&&r.$cell){(o=i||r.$cell).attr("title",$),i="tooltip",r="show",u.on&&u.tooltip&&(i=u.tooltip,r="show");try{o[i]("destroy")}catch(C){}o[i]({trigger:"manual",position:{my:"left center+5",at:"right center"},content:function(){return(""==y?"":"<span class='ui-icon "+y+" pq-tooltip-icon'></span>")+$},open:function(t,e){var i=e.tooltip;if(I&&i.addClass(I),b){var r=i.attr("style");i.attr("style",r+";"+b)}_&&i.tooltip.css(_)}})[i](r)}}return e}if(s&&(r=o.getEditCell())&&r.$cell){(o=r.$cell).removeAttr("title");try{o.tooltip("destroy")}catch(q){}}return{valid:!0}},r.isValid=function(t){return this.iIsValid.isValid(t)},d.isValid=function(t){t=t||{};var e=this.that,i=t.allowInvalid,r=t.focusInvalid,o=t.checkEditable,i=null!=i&&i,n=t.dataIndx;if(null!=n){var l=e.columns[n],a=t.rowData||e.getRowData(t),s=t.hasOwnProperty("value"),e=s?t.value:a[n],e=this.isValidCell({rowData:a,checkEditable:o,rowIndx:t.rowIndx,value:e,valueDef:s,column:l,allowInvalid:i,focusInvalid:r});return e.valid||e.warn?{valid:!0}:e}if(null!=t.rowIndx||null!=t.rowIndxPage||null!=t.rowData){for(var a=t.rowData||e.getRowData(t),d=e.colModel,s=[],h=0,c=d.length;h<c;h++)if(!(l=d[h]).hidden&&(e=a[n=l.dataIndx],!(e=this.isValidCell({rowData:a,value:e,column:l,rowIndx:t.rowIndx,checkEditable:o,allowInvalid:i,focusInvalid:r})).valid&&!e.warn)){if(!i)return e;s.push({rowData:a,dataIndx:n,column:l})}}else{if(t=t.data?t.data:e.options.dataModel.data,s=[],!t)return null;for(h=0,c=t.length;h<c;h++)if(a=t[h],!o||null!=(l=this.getRowIndx({rowData:a}).rowIndx)&&!1!=e.isEditableRow({rowData:a,rowIndx:l})){if(n=(a=this.isValid({rowData:a,rowIndx:l,checkEditable:o,allowInvalid:i,focusInvalid:r})).cells,!1===i){if(!a.valid)return a}else n&&n.length&&(s=s.concat(n))}}return i&&s.length?{cells:s,valid:!1}:{valid:!0}},r.isValidChange=function(t){t=t||{};var e=this.getChanges(),e=e.updateList.concat(e.addList);return t.data=e,this.isValid(t)},r.isEditableRow=function(t){var e=this.options.editable;return null==e||("function"==typeof e?e.call(this,this.normalize(t)):e)},r.isEditableCell=function(t){var e=(t=this.normalize(t)).column,i=e.editable;return(!t.checkVisible||!e.hidden)&&(null==i||("function"==typeof i?i.call(this,t):i))},r._onContMouseDown=function(e){if(this.blurEditor({blurIfFocus:!0}),!1===this._trigger("contMouseDown",e,null))return!1;var i=t(e.target);return e=i.closest(".pq-grid-cell,.pq-grid-number-cell"),i=i.closest(".pq-grid-row"),e.length||i.length||((e=this.$cont[0]).setAttribute("tabindex",0),e.focus()),!0},r._onCellMouseDown=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i});if(null!=r.rowIndx)return r=this.iMerge.getRootCell(r.rowIndx,r.colIndx,"o"),(r=this.normalize(r)).$td=i,!1!=this._trigger("cellMouseDown",e,r)},r._onRowMouseDown=function(e){var i=t(e.currentTarget),r=this.getRowIndx({$tr:i});return r.$tr=i,!1!=this._trigger("rowMouseDown",e,r)},r._onCellMouseEnter=function(t,e){var i=this.options,r=this.getCellIndices({$td:e});if(null!=r.rowIndx&&null!=r.colIndx)return!1!==this._trigger("cellMouseEnter",t,r)&&("cell"==i.hoverMode&&this.highlightCell(e),!0)},r._onRowMouseEnter=function(t,e){var i=this.options,r=this.getRowIndx({$tr:e}),o=r.rowIndxPage;return!1!==this._trigger("rowMouseEnter",t,r)&&("row"==i.hoverMode&&this.highlightRow(o),!0)},r._onCellMouseLeave=function(t,e){return"cell"==this.options.hoverMode&&this.unHighlightCell(e),!0},r._onRowMouseLeave=function(t,e){var i=this.getRowIndx({$tr:e}).rowIndxPage;return"row"==this.options.hoverMode&&this.unHighlightRow(i),!0},r.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)},r.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(e){if(e.target){var i=t(e.target);if(i.is("input,textarea,select")||i.closest(".pq-native-select").length)return!0;e.preventDefault()}})},r._onClickCell=function(e){var i=this.options.editModel,r=t(e.currentTarget),o=this.getCellIndices({$td:r}),o=this.iMerge.getRootCell(o.rowIndx,o.colIndx,"o"),o=this.normalize(o),n=o.rowIndx,l=o.colIndx;if(o.$td=r,o.evt=e,!1==this._trigger("cellClick",e,o))return!1;null==l||0>l||1==i.clicksToEdit&&this.isEditableRow({rowIndx:n})&&this.isEditableCell({colIndx:l,rowIndx:n})&&this.editCell(o)},r._onRightClickCell=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i}),o=r.rowIndxPage,n=o+this.rowIndxOffset,r=r.colIndx,l=this.colModel;if(null!=r&&(l=l[r],!1==this._trigger("cellRightClick",e,{$td:i,rowIndxPage:o,rowIndx:n,colIndx:r,dataIndx:l.dataIndx,column:l,rowData:this.pdata[o]})))return!1},r.highlightCell=function(t){t.addClass("pq-grid-cell-hover ui-state-hover")},r.unHighlightCell=function(t){t.removeClass("pq-grid-cell-hover ui-state-hover")},r.highlightRow=function(t){isNaN(t)||(t=this.getRow({rowIndxPage:t}))&&t.addClass("pq-grid-row-hover ui-state-hover")},r.unHighlightRow=function(t){isNaN(t)||(t=this.getRow({rowIndxPage:t}))&&t.removeClass("pq-grid-row-hover ui-state-hover")},r._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}},r._findCellFromEvt=function(e){if(null==(e=t(e.target).closest(".pq-grid-cell"))||0==e.length)return{rowIndxPage:null,colIndx:null,$td:null};var i=this.getCellIndices({$td:e});return i.$td=e,i},r._initPager=function(){var e=this,i=e.options,r=i.pageModel;r.type&&(i={bootstrap:i.bootstrap,change:function(t,i){e.blurEditor({force:!0});var r=e.options.pageModel;void 0!=i.curPage&&(r.prevPage=r.curPage,r.curPage=i.curPage),void 0!=i.rPP&&(r.rPP=i.rPP),"remote"==r.type?e.remoteRequest({callback:function(){e._onDataAvailable({apply:!0,header:!1})}}):e.refreshView({header:!1,source:"pager"})},refresh:function(t){e.refreshDataAndView()}},i=t.extend(i,r),this.pagerW=pq.pager(r.appendTo?r.appendTo:this.$footer,i))},r.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=t("<div class='pq-loading'></div>").appendTo(this.element),t(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},r._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)},r.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0),this.showLoadingCounter++,this.$loading.show()},r.hideLoading=function(){0<this.showLoadingCounter&&this.showLoadingCounter--,this.showLoadingCounter||this.$loading.hide()},r.refreshDataFromDataModel=function(t){t=t||{};var e,i=this.options,r=i.pageModel,o=i.dataModel.data,n=r.type;for(var l in e=this._queueATriggers){var a=e[l];delete e[l],this._trigger(l,a.evt,a.ui)}this._trigger("beforeRefreshData",null,{}),this.rowIndxOffset=0,"local"==n?(r.totalRecords=o.length,r.totalPages=i=Math.ceil(o.length/r.rPP),r.curPage>i&&(r.curPage=i),i&&!r.curPage&&(r.curPage=1),i=(r.curPage-1)*r.rPP,(e=r.curPage*r.rPP)>o.length&&(e=o.length),this.pdata=o.slice(i,e)):"remote"==n?(r.totalPages=i=Math.ceil(r.totalRecords/r.rPP),r.curPage>i&&(r.curPage=i),i&&!r.curPage&&(r.curPage=1),(e=r.rPP)>o.length&&(e=o.length),this.pdata=o.slice(0,e)):this.pdata=i.backwardCompat?o.slice(0):o,("local"==n||"remote"==n)&&(this.rowIndxOffset=r.rPP*(r.curPage-1)),this._trigger("dataReady",null,{source:t.source})},r.getQueryStringCRUD=function(){return""},r.remoteRequest=function(e){this.loading&&this.xhr.abort(),e=e||{};var i=this,r="",o="",n=this.options,l=!1,a=this.colModel,s=n.dataModel,d=n.sortModel,h=n.filterModel,c=n.pageModel;if("function"==typeof s.getUrl)(n=s.getUrl.call(this,{colModel:a,dataModel:s,sortModel:d,groupModel:n.groupModel,pageModel:c,filterModel:h}))&&n.url&&(r=n.url),n&&n.data&&(o=n.data);else if("string"==typeof s.url){var r=s.url,o={},n={},u={},p={valParam1:s.varParam1,valParam2:s.varParam2,valParam3:s.varParam3,valParam4:s.varParam4,valParam5:s.varParam5,valParam6:s.varParam6,valParam7:s.varParam7};"remote"==d.type&&(e.initBySort||this.sort({initByRemote:!0}),(d=this.iSort.getQueryStringSort())&&(o={pq_sort:d})),"remote"==c.type&&(u={pq_curpage:c.curPage,pq_rpp:c.rPP}),"local"!=h.type&&(d=this.iFilterData.getQueryStringFilter())&&(l=!0,n={pq_filter:d});var d=s.postData,f=s.postDataOnce;d&&"function"==typeof d&&(d=d.call(this,{colModel:a,dataModel:s})),o=t.extend({pq_datatype:s.dataType},n,u,o,d,f,p)}r&&(this.loading=!0,this.showLoading(),this.xhr=t.ajax({url:r,dataType:s.dataType,async:null==s.async||s.async,cache:s.cache,contentType:s.contentType,type:s.method,data:o,beforeSend:function(t,e){if("function"==typeof s.beforeSend)return s.beforeSend.call(i,t,e)},success:function(t,r,o){"function"==typeof s.getData&&(t=s.getData.call(i,t,r,o)),s.data=t.data,"remote"==c.type&&(t.curPage&&(c.curPage=t.curPage),t.totalRecords&&(c.totalRecords=t.totalRecords)),i.hideLoading(),i.loading=!1,i._trigger("load",null,{dataModel:s,colModel:a}),e.callback&&e.callback(),l&&(i._queueATriggers.filter={ui:{type:"remote",filterModel:h}})},error:function(t,e,r){if(i.hideLoading(),i.loading=!1,"function"==typeof s.error)s.error.call(i,t,e,r);else if("abort"!=r)throw"Error : "+r}}))},r._refreshTitle=function(){this.$title.html(this.options.title)},r._destroyDraggable=function(){var t=this.element,e=t.parent(".pq-wrapper");e.length&&e.data("draggable")&&(e.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),t.unwrap(".pq-wrapper"))},r._refreshDraggable=function(){var t=this.element,e=this.$title;this.options.draggable?(e.addClass("pq-draggable pq-no-capture"),t.parent(".pq-wrapper").length||t.wrap("<div class='pq-wrapper' />"),t.parent(".pq-wrapper").draggable({handle:e})):this._destroyDraggable()},r._refreshResizable=function(){var e=this,i=this.element,r=this.options,o=-1<(r.width+"").indexOf("%"),n=-1<(r.height+"").indexOf("%"),l="auto"==r.width,a="flex"==r.width,s="flex"==r.height;if(!r.resizable||(s||n)&&(a||o||l))this._destroyResizable();else{var d="e,s,se";s||n?d="e":(a||o||l)&&(d="s"),o=!0,i.hasClass("ui-resizable")&&(d==(n=i.resizable("option","handles"))?o=!1:this._destroyResizable()),o&&i.resizable({helper:"ui-state-default",handles:d,minWidth:r.minWidth,minHeight:r.minHeight?r.minHeight:100,delay:0,start:function(e,i){t(i.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(t,e){},stop:function(i,o){var n=e.element,l=n[0],a=r.width,s=r.height,d=-1<(a+"").indexOf("%"),h=-1<(s+"").indexOf("%"),c=!1;l.style.width=l.offsetWidth+3+"px",l.style.height=l.offsetHeight+3+"px",h||"flex"==s||(c=!0,r.height=l.offsetHeight),d||"auto"==a||"flex"==a||(c=!0,r.width=l.offsetWidth),e.refresh(),n.css("position","relative"),c&&t(window).trigger("resize")}})}},r._refreshAfterResize=function(){var t=this.options,e=t.width,i=t.height,t=-1!=(e+"").indexOf("%"),e="auto"===e,i=-1!=(i+"").indexOf("%");(t||e||i)&&this.refresh()},r.refresh=function(t){this.iRefresh.refresh(t)},r.refreshView=function(t){null!=this.options.editModel.indices&&this.blurEditor({force:!0}),this.refreshDataFromDataModel(t),this.refresh(t)},r._refreshPager=function(){var t=this.options,e=t.pageModel,i=e.rPP,r=e.totalRecords;e.type?(e=t.pageModel,this.pagerW||this._initPager(),this.pagerW.option(e),r>i?this.$bottom.css("display",""):t.showBottom||this.$bottom.css("display","none")):(this.pagerW&&(this.pagerW.destroy(),this.pagerW=null),t.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none"))},r.getInstance=function(){return{grid:this}},r.refreshDataAndView=function(t){if("remote"==this.options.dataModel.location){var e=this;this.remoteRequest({callback:function(){e._onDataAvailable(t)}})}else this._onDataAvailable(t)},r.getColIndx=function(t){var e,i=t.dataIndx;if(t=t.column)e=!0;else if(void 0===i)throw"dataIndx / column NA";var r=this.colModel,o=r.length;if(e){for(i=0;i<o;i++)if(r[i]==t)return i}else if(null!=(i=this.colIndxs[i]))return i;return -1},r.getColumn=function(t){if(null==t.dataIndx)throw"dataIndx N/A";return this.columns[t.dataIndx]},r._generateCellRowOutline=function(){var e=this.options,i=e.editModel;if(this.$div_focus){if(e.debug)throw"this.$div_focus already present assert failed"}else e=this.element,i.inline&&(e=this.getCell(i.indices)).css("padding",0).empty(),this.$div_focus=t("<div class='pq-editor-outer'><div class='pq-editor-inner'></div></div>").appendTo(e),this.$div_focus.css("zIndex",parseInt(e.css("zIndex"))+5||5),i=t.extend({all:!0},i.indices),(i=this.getCell(i)).css("height",i[0].offsetHeight),i.empty(),this.refreshEditorPos()},r._removeEditOutline=function(e){if(this.$div_focus){if((e=this.$div_focus.find(".pq-editor-focus")).hasClass("hasDatepicker")&&e.datepicker("hide").datepicker("destroy"),e[0]==document.activeElement){var i=this._blurEditMode;this._blurEditMode=!0,e.blur(),this._blurEditMode=i}this.$div_focus.remove(),delete this.$div_focus,e=this.options.editModel,i=t.extend({},e.indices),e.indices=null,i.rowData=void 0,this.refreshCell(i)}},r.refreshEditorPos=function(){var t=this.options.editModel,e=t.cellBorderWidth,i=this.$div_focus,r=this.getCell(t.indices);if(!r||!r.length)return!1;var t=r[0].offsetWidth,o=r[0].offsetHeight,n=this.element.offset(),r=r.offset();i.css({height:o,width:t-1,borderWidth:e,left:r.left-n.left-1,top:r.top-n.top-1})},r.setEditorPosTimer=function(){var t=this,e=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null),this._refreshEditorPosTimer=window.setInterval(function(){e.editModel.indices&&t.refreshEditorPos()},200)},r.get$Tbl=function(e,i){var r=this.$tbl,o=[];if(r&&r.length){var n=this.pqpanes,l=this.options,a=l.freezeRows,l=l.freezeCols;if(n.h&&n.v?null==i?e>=a?o.push(r[2],r[3]):o.push(r[0],r[1]):o=i>=l&&e>=a?r[3]:i<l&&e>=a?r[2]:i>=l&&e<a?r[1]:r[0]:o=n.v?null==i?r:i>=l?r[1]:r[0]:n.h&&e>=a?r[1]:r[0],o)return t(o)}},r.scrollCell=function(t){this.scrollRow(t),this.scrollColumn(t)},r.scrollY=function(t){this.vscroll.option("cur_pos",t),this.vscroll.scroll()},r.scrollRow=function(t){var e=this.options,i=(t=this.normalize(t)).rowIndxPage,r=t.rowData;if(!this.pdata||i>=this.pdata.length||!r||r.pq_hidden)return!1;e.virtualY?this._scrollRowVirtual(t):this.iMouseSelection.scrollRowNonVirtual(t)},r._scrollRowVirtual=function(t){var e=this.options,i=t.rowIndxPage,r=!!this.iHierarchy,o=t.rowIndx;t=this.vscroll;var n=this.scrollCurPos,i=null==i?o-this.rowIndxOffset:i,o=parseInt(e.freezeRows);if(!(i<o)&&null!=(e=this._calcCurPosFromRowIndxPage(i))){e<n&&(t.option("cur_pos",e),t.scroll());var l=this.get$Tbl(i);if(!l||!l.length)return null;var a=l.children("tbody").children("tr[pq-row-indx="+i+"]"),s=i=a.last();1<a.length&&(s=a.first());var d=i[0],a=parseInt(l.css("marginTop"));if(void 0==d)t.option("cur_pos",e),t.scroll();else{var d=d.offsetTop+d.offsetHeight,h=this.$cont[0].offsetHeight,c=this._getSBHeight(),s=s.prev("tr");if(!s.hasClass("pq-row-hidden")&&!s.hasClass("pq-last-frozen-row")&&d>h-c-a){for(s=d-(h-c-a),a=l.children().children("tr"),d=l=0,o?0==(o=a.filter("tr.pq-last-frozen-row").last().next()).length&&(o=a.filter("tr.pq-row-hidden").next()):o=a.filter("tr.pq-row-hidden").next();o.length&&(l+=o[0].offsetHeight,o[0]!=i[0]&&(r&&!1!=o.hasClass("pq-detail-child")||d++,!(l>=s)));){o=o.next()}(r=n+d)>e&&(r=e),(n=t.option("num_eles"))<r+1&&(n=r+1),t.option({num_eles:n,cur_pos:r}),t.scroll()}}}},r.blurEditor=function(t){if(this.$div_focus){var e=this.$div_focus.find(".pq-editor-focus");if(!t||!t.blurIfFocus)return e.triggerHandler("blur",t);document.activeElement==e[0]&&e.blur()}},r._scrollColumnVirtual=function(t){var e=t.colIndx,i=this.hscroll,e=null==e?this.colIndxs[t.dataIndx]:e;t=this.options.freezeCols;var r=this._calcRightEdgeCol(e).width,o=this.iRefresh.getEContWd();if(r>o){for(var r=this.calcWidthCols(-1,e+1)-o,o=this.colModel,n=o.length,l=0,a=0,s=t;s<n;s++){var d=o[s];if(d.hidden||(l+=d.outerWidth),s==e){a=s-t-this._calcNumHiddenUnFrozens(s);break}if(l>=r){a=s-t-this._calcNumHiddenUnFrozens(s)+1;break}}return i.option("cur_pos",a),i.scroll(),!0}return e>=t&&e<this.initH&&(e=e-t-this._calcNumHiddenUnFrozens(e),i.option("cur_pos",e),i.scroll(),!0)},r.scrollColumn=function(t){var e=this.options;return("flex"!==e.width||!!e.maxWidth)&&(e.virtualX?this._scrollColumnVirtual(t):this.iMouseSelection.scrollColumnNonVirtual(t))},r.selection=function(t){if(t){var e,i=t.method,r=t.type;return"row"==r?e=this.iRows[i](t):"cell"==r&&(e=this.iCells[i](t)),("add"==i||"remove"==i||"removeAll"==i)&&(this.iSelection.dirty=!0,this.iSelection._trigger()),e}return(t=this.iSelection).isDirty()&&t.refresh(),t},r.goToPage=function(t){var e=this.options.pageModel;if("local"==e.type||"remote"==e.type){var i=t.rowIndx,r=e.rPP;(t=null==t.page?Math.ceil((i+1)/r):t.page)!=e.curPage&&(e.curPage=t,"local"==e.type?this.refreshView():this.refreshDataAndView())}},r.setSelection=function(t){if(null==t)return this.iSelection.removeAll(),!0;var e=this.pdata;if(!e||!e.length)return!1;var e=(t=this.normalize(t)).rowIndx,i=t.rowIndxPage,r=t.colIndx;if(t.rowData&&null==e&&(i=this.getRowIndx(t),t.rowIndx=e=i.rowIndx,t.rowIndxPage=i.rowIndxPage),null==e||0>e||0>r||r>=this.colModel.length)return!1;this.goToPage(t),i=e-this.rowIndxOffset,this.scrollRow({rowIndxPage:i}),null==r?this.range({r1:e}).select():(this.scrollColumn({colIndx:r}),this.range({r1:e,c1:r}).select()),!1!==t.focus&&this.focus({rowIndxPage:i,colIndx:null==r?this.getFirstVisibleCI():r})},r.getColModel=function(){return this.colModel},r.saveEditCell=function(e){var i=this.options,r=i.editModel;if(!r.indices)return null;var o=t.extend({},r.indices);e=e?e.evt:null;var n,l=o.rowIndxPage,r=l+this.rowIndxOffset,a=this.colModel[o.colIndx],o=a.dataIndx,s=this.pdata[l],d=i.dataModel;if(null==s)return null;if(null!=l){if(i=this.getEditCellData(),t.isPlainObject(i))for(var h in n={},i)n[h]=s[h];else n=this.readCell(s,a);return"<br>"==i&&(i=""),null==n&&""===i&&(i=null),h={rowIndx:r,rowIndxPage:l,dataIndx:o,column:a,newVal:i,value:i,oldVal:n,rowData:s,dataModel:d},!1!==this._trigger("cellBeforeSave",e,h)&&(l={},a=!1,t.isPlainObject(i)?(l=i,a=!0):l[o]=i,!1!==this.updateRow({row:l,rowIndx:r,refresh:a,silent:!0,source:"edit",checkEditable:!1})&&(this._trigger("cellSave",e,h),!0))}},r._addInvalid=function(t){},r._digestData=function(t){if(!1===this._trigger("beforeValidate",null,t))return!1;var e=this.options,i=e.editModel,r=e.dataModel,o=r.data,n=e.colModel,l=e.pageModel,a=e.historyModel,s=t.validate,s=null==s?i.validate:s,d="remote"==l.type,h=t.allowInvalid,h=null==h?i.allowInvalid:h,c=e.trackModel,i=t.track,i=null==i?null==e.track?c.on:e.track:i,u=t.history,u=null==u?a.on:u,p=this.iHistory,a=this.iUCData,f=t.checkEditable,f=null==f||f,g=t.checkEditableAdd,g=null==g?f:g,c=this.saveCell,v=this.columns,w=this.colIndxs,m=t.source,x=this.rowIndxOffset,$=this.getValueFromDataType,_=t.rowList,I=_.length;o||(o=e.dataModel.data=[]);for(var y=[],b=0;b<I;b++){var C=_[b],q=C.newRow,R=C.rowData,D=C.type,M=C.checkEditable,P=C.rowIndx,T=C.oldRow;if(null==M&&("update"==D?M=f:"add"==D&&(M=g)),"update"==D){if(!T)throw"oldRow required while update";if(M&&!0!==e.editable&&!1===this.isEditableRow({rowIndx:P,rowData:R}))continue}else if("delete"==D){y.push(C);continue}if("add"==D)for(var k=0,H=n.length;k<H;k++){var S=n[k],E=S.dataIndx;q[E]=q[E]}for(E in q)if(S=v[E],k=w[E],S){if(M&&null!=S.editable&&!1===this.isEditableCell({rowIndx:P,colIndx:k,dataIndx:E}))delete q[E];else{var V=S.dataType,k=$(q[E],V),H=T?T[E]:void 0,H=void 0!==H?$(H,V):void 0;if(q[E]=k,s&&S.validations){if("edit"==m&&!1===h){if(!1==(S=this.isValid({focusInvalid:!0,dataIndx:E,rowIndx:P,value:k})).valid&&!S.warn)return!1}else!1===(S=this.iIsValid.isValidCell({column:S,rowData:"add"==D?q:R,allowInvalid:h,value:k})).valid&&(!1!==h||S.warn||delete q[E])}"update"==D&&k===H&&(delete q[E],T&&delete T[E])}}if(q){if("update"==D)for(E in q){y.push(C);break}else y.push(C)}}if(!(I=(_=t.rowList=y).length))return"edit"==m&&null;for(u&&(p.increment(),p.push({rowList:_})),b=0;b<I;b++)if(D=(C=_[b]).type,q=C.newRow,P=C.rowIndx,e=C.rowIndxPage,R=C.rowData,"update"==D)for(E in i&&a.update({rowData:R,row:q,refresh:!1}),q)c(R,S=v[E],k=q[E]);else"add"==D?(i&&a.add({rowData:q}),null==P&&null==e?o.push(q):(e=P-x,e=d?e:P,o.splice(e,0,q)),d&&l.totalRecords++):"delete"==D&&(n=(e=this.getRowIndx({rowData:R,dataUF:!0})).uf,P=e.rowIndx,i&&a.delete({rowIndx:P,rowData:R}),e=P-x,e=d?e:P,n?r.dataUF.splice(P,1):(e=o.splice(e,1))&&e.length&&d&&l.totalRecords--);return this._trigger("change",null,t),!0},r.refreshColumn=function(t){t=this.normalize(t);var e=this.initV,i=this.finalV,r=this.options.freezeRows,o=t.colIndx,n=t.dataIndx,l=t.column;t.skip=!0;for(var a=0;a<=i;a++)a<e&&a>=r&&(a=e),t.rowIndxPage=a,this.refreshCell(t);this._trigger("refreshColumn",null,{column:l,colIndx:o,dataIndx:n}),this.iRefresh.softRefresh()},r.refreshCell=function(t){if(t=this.normalize(t),this.pdata){var e=t.skip,i=t.rowIndx,r=t.rowIndxPage,o=t.colIndx,n=this.iMerge;if(t.rowData){var l=this.getCell({all:!0,rowIndxPage:r,colIndx:o});if(l&&0<l.length){var a=t;n.ismergedCell(i,o)&&(a=n.getRootCell(i,o,"a"));var s,i=this.iGenerateView.renderCell(a);i&&(l.replaceWith(i),(s=this._focusElement)&&s.rowIndxPage==r&&this.focus(),e||(this._trigger("refreshCell",null,t),this.iRefresh.softRefresh()))}}}},r.refreshRow=function(e){if(e=this.normalize(e),this.pdata){var i=e.rowIndx,r=e.rowIndxPage,o=this.options,n=o.freezeRows,l=e.rowData;if(!l||l.pq_hidden||r>this.finalV||r<this.initV&&r>=n)return null;var a,s=this.getRow({all:!0,rowIndxPage:r}),d=[];if(this.iGenerateView.refreshRow(r,d),d=d.join(""),s&&s.length)s.replaceWith(d);else if(!o.virtualY)return!1;else if(r==this.finalV)this.$tbl.append(d);else if(r==this.initV)for(o=this.$tbl,s=0;s<o.length;s++)t(o[s]).children("tbody").children(n?".pq-last-frozen-row":"tr:first").after(d);else throw"refreshRow > rip not found";return(a=this._focusElement)&&a.rowIndxPage==r&&this.focus(),this._trigger("refreshRow",null,{rowData:l,rowIndx:i,rowIndxPage:r}),!1!==e.refresh&&this.iRefresh.softRefresh(),!0}},r.quitEditMode=function(t){if(!this._quitEditMode){var e=!1,i=!1,r=!1,o=this.options.editModel,n=o.indices,l=void 0;this._quitEditMode=!0,t&&(e=t.old,i=t.silent,r=t.fireOnly,l=t.evt),n&&(i||e||this._trigger("editorEnd",l,n),r||(this._removeEditOutline(t),o.indices=null)),this._quitEditMode=null}},r.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}},r.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}},r.getRowIndxOffset=function(){return this.rowIndxOffset},r.getEditCell=function(){var t=this.options.editModel;if(t.indices){var t=this.getCell(t.indices),e=this.$div_focus.children(".pq-editor-inner"),i=e.find(".pq-editor-focus");return{$td:t,$cell:e,$editor:i}}return{}},r.editCell=function(t){t=this.normalize(t);var e=this.iMerge,i=t.rowIndx,r=t.colIndx;return(!e.ismergedCell(i,r)||(e=e.getRootCell(i,r,"o")).rowIndx==t.rowIndx&&e.colIndx==t.colIndx)&&((this.scrollRow(t),this.scrollColumn(t),(e=this.getCell(t))&&e.length)?this._editCell(t):void 0)},r.getFirstEditableColIndx=function(t){if(null==t.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(t))return -1;for(var e=this.colModel,i=0;i<e.length;i++)if(t.colIndx=i,this.isEditableCell(t)&&!e[i].hidden)return i;return -1},r.editFirstCellInRow=function(t){var e=this.rowIndxOffset,i=t.rowIndx;t=t.rowIndxPage,i=null==i?t+e:i,t=null==t?i-e:t,-1!=(e=this.getFirstEditableColIndx({rowIndx:i}))&&this.editCell({rowIndxPage:t,colIndx:e})},r._editCell=function(e){var i=this.normalize(e),r=this;e=i.evt;var n=i.rowIndxPage,l=i.colIndx,a=r.pdata;if(!a||n>=a.length)return!1;var s=this.options,d=s.editModel,a=a[n],h=i.rowIndx,c=this.colModel[l],u=c.dataIndx,p=r.readCell(a,c),f={rowIndx:h,rowIndxPage:n,cellData:p,rowData:a,dataIndx:u,colIndx:l,column:c},g=c.editor,g="function"==typeof g?g.call(this,f):g;if(void 0===g&&"function"==typeof s.geditor&&(g=s.geditor.call(this,f)),!1!==g){g&&g.getData&&(d._getData=g.getData);var v=s.editor,w=g?t.extend({},v,g):v,s=!1;if(d.indices){if((g=d.indices).rowIndxPage==n&&g.colIndx==l){this.refreshEditorPos();var m=this.$div_focus.find(".pq-editor-focus");return window.setTimeout(function(){m.focus()},0),!1}if(!1===this.blurEditor({evt:e}))return!1;this.quitEditMode({evt:e})}d.indices={rowIndxPage:n,rowIndx:h,colIndx:l,column:c,dataIndx:u},this._generateCellRowOutline(),g=this.$div_focus.children(".pq-editor-inner"),"right"==c.align?g.addClass("pq-align-right"):"center"==c.align?g.addClass("pq-align-center"):g.addClass("pq-align-left"),f.$cell=g;var x,$=w.type,i=null==i.select?w.select:i.select,_=w.init,I=w.valueIndx,y=w.dataMap,b=w.mapIndices,b=b||{},C=w.cls||"",C="function"==typeof C?C.call(this,f):C,C=(x="pq-editor-focus "+C)+" pq-cell-editor ",q=w.attr||"",q="function"==typeof q?q.call(this,f):q,R=w.style||"",R=(R="function"==typeof R?R.call(this,f):R)?"style='"+R+"'":"";f.cls=x,f.attr=q,"function"==typeof $&&(x=$.call(this,f))&&($=x),v._type=$,"checkbox"==$?(w=w.subtype,g.html("<input "+(p?"checked='checked'":"")+" class='"+C+"' "+q+" "+R+" type=checkbox name='"+u+"' />"),v=g.children("input"),"triple"==w&&(v.pqval({val:p}),g.click(function(e){t(this).children("input").pqval({incr:!0})}))):"textarea"==$||"select"==$||"textbox"==$?("textarea"==$?x="<textarea class='"+C+"' "+q+" "+R+" name='"+u+"' ></textarea>":"select"==$?("function"==typeof(v=w.options||[])&&(v=v.call(this,f)),C=[q," class='",C,"' ",R," name='",u,"'"].join(""),x=o.select({options:v,attr:C,prepend:w.prepend,labelIndx:w.labelIndx,valueIndx:I,groupIndx:w.groupIndx,dataMap:y})):x="<input class='"+C+"' "+q+" "+R+" type=text name='"+u+"' />",t(x).appendTo(g).val("select"==$&&null!=I&&(b[I]||this.columns[I])?b[I]?a[b[I]]:a[I]:p)):$&&"contenteditable"!=$||(g.html("<div contenteditable='true' tabindx='0' "+R+" "+q+" class='"+C+"'></div>"),g.children().html(p),s=!0),"function"==typeof _&&_.call(this,f);var r=this,m=g.children(".pq-editor-focus"),D=d.filterKeys;(p=c.editModel)&&void 0!==p.filterKeys&&(D=p.filterKeys);var M={$cell:g,$editor:m,dataIndx:u,column:c,colIndx:l,rowIndx:h,rowIndxPage:n,rowData:a};if(d.indices=M,m.data({FK:D}).on("click",function(e){t(this).focus()}).on("keydown",function(t){r.iKeyNav._keyDownInEdit(t)}).on("keypress",function(t){return r.iKeyNav._keyPressInEdit(t,{FK:D})}).on("keyup",function(t){return r.iKeyNav._keyUpInEdit(t,{FK:D})}).on("blur",function(e,i){var o=r.options.editModel,n=o.onBlur,l="validate"==n,a=o.cancelBlurCls,s=!!i&&i.force;if(!r._quitEditMode&&!r._blurEditMode&&o.indices){if(o=t(e.target),!s){if(!1===r._trigger("editorBlur",e,M)||!n||a&&o.hasClass(a))return;if(o.hasClass("hasDatepicker")){if(o.datepicker("widget").is(":visible"))return!1}else if(o.hasClass("ui-autocomplete-input")){if(o.autocomplete("widget").is(":visible"))return}else if(o.hasClass("ui-multiselect")){if(t(".ui-multiselect-menu").is(":visible")||t(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(o.hasClass("pq-select-button")&&(t(".pq-select-menu").is(":visible")||t(document.activeElement).closest(".pq-select-menu").length))return}if(r._blurEditMode=!0,!r.saveEditCell({evt:e,silent:s||"save"==n||!l})&&!s&&l)return r._deleteBlurEditMode(),!1;r.quitEditMode({evt:e}),r._deleteBlurEditMode()}}).on("focus",function(t){r._trigger("editorFocus",t,M)}),r._trigger("editorBegin",e,M),m.focus(),window.setTimeout(function(){!1===t(document.activeElement).hasClass("pq-editor-focus")&&(r.element?r.element.find(".pq-editor-focus"):t()).focus()},0),i){if(s)try{var P=m[0],T=document.createRange();T.selectNodeContents(P);var k=window.getSelection();k.removeAllRanges(),k.addRange(T)}catch(H){}else m.select()}}},r._deleteBlurEditMode=function(t){var e=this;t=t||{},e._blurEditMode&&(t.timer?window.setTimeout(function(){delete e._blurEditMode},0):delete e._blurEditMode)},r.getRow=function(e){var i=this.normalize(e);e=i.rowIndxPage;var i=i.all?this.$tbl:this.get$Tbl(e),r=t();if(i&&i.length){var o=i.children("tbody");null!=e&&(r=o.children("tr[pq-row-indx="+e+"]")).length>i.length&&(r=r.filter(".pq-detail-master"))}return r},r.getCell=function(e){var i=e.all,r=this.options,o=this.normalize(e);e=o.rowIndxPage;var n=o.rowIndx,l=o.colIndx,a=this.iMerge;if(a.ismergedCell(n,l)){if(r=a.getRootCell(n,l,"a"),!(e===(n=a.getRootCell(n,l,"o")).rowIndxPage&&l===n.colIndx||e===r.rowIndxPage&&l===r.colIndx))return t();e=r.rowIndxPage,l=n.colIndx}else if(e>=r.freezeRows&&(e<this.initV||e>this.finalV)||l>=r.freezeCols&&(l<this.initH||l>this.finalH)||!o.rowData||!o.column||o.rowData.pq_hidden||o.column.hidden)return t();return(i=i?this.$tbl:this.get$Tbl(e,l))&&i.length?i.children().children("tr[pq-row-indx="+e+"]").children("[pq-col-indx="+l+"]"):t()},r.getCellHeader=function(e){var i=e.colIndx;e=e.dataIndx,i=null==i?this.colIndxs[e]:i,e=this.$tbl_header;var r=this.options.freezeCols;return e?(1<e.length&&(e=i>=r?t(e[1]):t(e[0])),i=e.find("[pq-col-indx="+i+"].pq-grid-col-leaf")):t()},r.getEditorIndices=function(){var e=this.options.editModel.indices;return e?t.extend({},e):null},r.getEditCellData=function(){var e=this.options,i=e.editModel,r=i.indices;if(!r)return null;var o,n=r.colIndx,l=r.rowIndxPage,a=r.rowIndx,s=this.colModel[n],d=s.editor,h=e.editor,e=d?t.extend({},h,d):h,c=e.valueIndx,u=e.labelIndx,d=(d=e.mapIndices)?d:{},p=s.dataIndx,f=this.$div_focus.children(".pq-editor-inner"),g=i._getData||e.getData;if(i._getData=void 0,"function"==typeof g)o=g.call(this,{$cell:f,rowData:r.rowData,dataIndx:p,rowIndx:a,rowIndxPage:l,column:s,colIndx:n});else if("checkbox"==(i=h._type))o=f.children(),o="triple"==e.subtype?o.pqval():!!o.is(":checked");else if("contenteditable"==i)o=f.children().html();else if((r=f.find('*[name="'+p+'"]'))&&r.length){if("select"==i&&null!=c){if(d[c]||this.columns[c]){if((o={})[d[c]?d[c]:c]=r.val(),o[d[u]?d[u]:u]=r.find("option:selected").text(),(e=e.dataMap)&&(i=r.find("option:selected").data("map")))for(r=0;r<e.length;r++)o[d[n=e[r]]?d[n]:n]=i[n]}else o=r.val()}else o=r.val()}else(r=f.find(".pq-editor-focus"))&&r.length&&(o=r.val());return o},r.getCellIndices=function(t){if(null==(t=t.$td)||0==t.length||t.closest(".pq-grid")[0]!=this.element[0])return{};var e,i=t.parent("tr").attr("pq-row-indx");return null!=i&&(e=(i=parseInt(i))+this.rowIndxOffset),null!=(t=t.attr("pq-col-indx"))&&(t=parseInt(t)),this.iMerge.getRootCell(e,t,"o")},r.getRowsByClass=function(t){var e=this.options,i="remote"==e.pageModel.type,r=this.rowIndxOffset,e=e.dataModel.data,o=[];if(null==e)return o;for(var n=0,l=e.length;n<l;n++){var a=e[n];if(a.pq_rowcls&&(t.rowData=a,this.hasClass(t))){var a={rowData:a},s=i?n+r:n,d=s-r;a.rowIndx=s,a.rowIndxPage=d,o.push(a)}}return o},r.getCellsByClass=function(t){var e=this.options,i="remote"==e.pageModel.type,r=this.rowIndxOffset,e=e.dataModel.data,o=[];if(null==e)return o;for(var n=0,l=e.length;n<l;n++){var a=e[n],s=i?n+r:n,d=a.pq_cellcls;if(d)for(var h in d)d={rowData:a,rowIndx:s,dataIndx:h,cls:t.cls},this.hasClass(d)&&(d=this.normalize(d),o.push(d))}return o},r.data=function(e){var i,r=e.dataIndx,o=e.colIndx,r=null!=o?this.colModel[o].dataIndx:r,o=e.data,n=null==o||"string"==typeof o;if(!(e=e.rowData||this.getRowData(e)))return{data:null};if(null==r){if(r=e.pq_rowdata,n)return null!=r&&(i=null==o?r:r[o]),{data:i};o=t.extend(!0,e.pq_rowdata,o),e.pq_rowdata=o}else{var l=e.pq_celldata;if(n)return null!=l&&(r=l[r],i=null==o||null==r?r:r[o]),{data:i};l||(e.pq_celldata={}),o=t.extend(!0,e.pq_celldata[r],o),e.pq_celldata[r]=o}},r.attr=function(e){var i,r=e.rowIndx,o=e.dataIndx,n=e.colIndx,o=null!=n?this.colModel[n].dataIndx:o,n=e.attr,l=null==n||"string"==typeof n,a=this.rowIndxOffset,s=e.refresh;if(!(e=e.rowData||this.getRowData(e)))return{attr:null};if(l||!1===s||null!=r||(r=this.getRowIndx({rowData:e}).rowIndx),null==o){if(o=e.pq_rowattr,l)return null!=o&&(i=null==n?o:o[n]),{attr:i};n=t.extend(!0,e.pq_rowattr,n),e.pq_rowattr=n,!1!==s&&null!=r&&(r=this.getRow({rowIndxPage:r-a}))&&(o=h(n),r.attr(o))}else{var d=e.pq_cellattr;if(l)return null!=d&&(r=d[o],i=null==n||null==r?r:r[n]),{attr:i};d||(e.pq_cellattr={}),n=t.extend(!0,e.pq_cellattr[o],n),e.pq_cellattr[o]=n,!1!==s&&null!=r&&(r=this.getCell({rowIndxPage:r-a,dataIndx:o}))&&(o=h(n),r.attr(o))}};var h=function(t){var e,i={};for(e in t){var r=t[e];if(r){if("title"==e)r=r.replace(/\"/g,"&quot;"),i[e]=r;else if("style"==e&&"object"==typeof r){var o,n,l=[];for(n in r)(o=r[n])&&l.push(n+":"+o);(r=l.join(";")+(l.length?";":""))&&(i[e]=r)}else"object"==typeof r&&(r=JSON.stringify(r)),i[e]=r}}return i};r.removeData=function(e){var i=e.dataIndx,r=e.colIndx,i=null!=r?this.colModel[r].dataIndx:i,r=e.data,r=null==r?[]:r,r="string"==typeof r?r.split(" "):r,o=r.length,n=e.rowData||this.getRowData(e);if(n){if(null==i){if(i=n.pq_rowdata){if(o)for(e=0;e<o;e++){var l=r[e];delete i[l]}o&&!t.isEmptyObject(i)||delete n.pq_rowdata}}else if((n=n.pq_celldata)&&n[i]){var a=n[i];if(o)for(e=0;e<o;e++)delete a[l=r[e]];o&&!t.isEmptyObject(a)||delete n[i]}}},r.removeAttr=function(e){var i=e.rowIndx,r=e.dataIndx,o=e.colIndx,r=null!=o?this.colModel[o].dataIndx:r,n=e.attr,n=null==n?[]:n,n="string"==typeof n?n.split(" "):n,l=n.length,o=i-this.rowIndxOffset,a=e.refresh,s=e.rowData||this.getRowData(e);if(s){if(!1!==a&&null==i&&(i=this.getRowIndx({rowData:s}).rowIndx),null==r){if(r=s.pq_rowattr){if(l)for(e=0;e<l;e++){var d=n[e];delete r[d]}else for(d in r)n.push(d);l&&!t.isEmptyObject(r)||delete s.pq_rowattr}!1!==a&&null!=i&&n.length&&(n=n.join(" "),(i=this.getRow({rowIndxPage:o}))&&i.removeAttr(n))}else{if((s=s.pq_cellattr)&&s[r]){var h=s[r];if(l)for(e=0;e<l;e++)delete h[d=n[e]];else for(d in h)n.push(d);l&&!t.isEmptyObject(h)||delete s[r]}!1!==a&&null!=i&&n.length&&(n=n.join(" "),(i=this.getCell({rowIndxPage:o,dataIndx:r}))&&i.removeAttr(n))}}},r.normalize=function(t){var e,i={};for(e in t)i[e]=t[e];var r=i.rowIndx,o=i.rowIndxPage;if(t=i.dataIndx,e=i.colIndx,null!=o||null!=r){var n=this.rowIndxOffset,r=null==r?parseInt(o,10)+n:r,o=null==o?parseInt(r,10)-n:o;i.rowIndx=r,i.rowIndxPage=o,i.rowData=i.rowData||this.getRowData(i)}return(null!=e||null!=t)&&(r=this.colModel,t=null==t?r[e]?r[e].dataIndx:void 0:t,e=null==e?this.colIndxs[t]:e,i.column=r[e],i.colIndx=e,i.dataIndx=t),i},r.addClass=function(t){var e=this.normalize(t),i=e.rowIndxPage,r=e.dataIndx,o=pq.arrayUnique;t=e.cls;var n=e.refresh,l=e.rowData;if(l){if(!1!==n&&null==i&&(i=this.getRowIndx({rowData:l}).rowIndxPage),null==r){var a,r=l.pq_rowcls;a=o((r?r+" "+t:t).split(/\s+/)).join(" "),l.pq_rowcls=a,!1!==n&&null!=i&&(i=this.getRow({rowIndxPage:i}))&&i.addClass(t)}else{e=[],"function"!=typeof r.push?e.push(r):e=r;var s=l.pq_cellcls;s||(s=l.pq_cellcls={});for(var l=0,d=e.length;l<d;l++)a=o((a=(a=s[r=e[l]])?a+" "+t:t).split(/\s+/)).join(" "),s[r]=a,!1!==n&&null!=i&&(r=this.getCell({rowIndxPage:i,dataIndx:r}))&&r.addClass(t)}}},r.removeClass=function(t){var e=this.normalize(t),i=e.rowIndx,r=e.rowData,o=e.dataIndx;if(t=e.cls,e=e.refresh,r){var n=r.pq_cellcls,l=r.pq_rowcls;if(!1!==e&&null==i&&(i=this.getRowIndx({rowData:r}).rowIndx),null==o)l&&(r.pq_rowcls=this._removeClass(l,t),null!=i&&!1!==e&&(i=this.getRow({rowIndx:i}))&&i.removeClass(t));else if(n){l=[],"function"!=typeof o.push?l.push(o):l=o;for(var a=0,s=l.length;a<s;a++){var o=l[a],d=n[o];d&&(r.pq_cellcls[o]=this._removeClass(d,t),null!=i&&!1!==e&&(o=this.getCell({rowIndx:i,dataIndx:o}))&&o.removeClass(t))}}}},r.hasClass=function(t){var e=t.dataIndx,i=t.cls;return t=this.getRowData(t),i=RegExp("\\b"+i+"\\b"),t?null==e?!!((e=t.pq_rowcls)&&i.test(e)):!!((t=t.pq_cellcls)&&t[e]&&i.test(t[e])):null},r._removeClass=function(t,e){if(t&&e){for(var i=t.split(/\s+/),r=e.split(/\s+/),o=[],n=0,l=i.length;n<l;n++){for(var a=i[n],s=!1,d=0,h=r.length;d<h;d++)if(a===r[d]){s=!0;break}s||o.push(a)}return 1<o.length?o.join(" "):1===o.length?o[0]:null}},r.getRowIndx=function(t){var e=t.$tr,i=t.rowData,r=this.rowIndxOffset;if(i){var o=this.options.dataModel,e=this.get_p_data(),n=!1;if(t=t.dataUF?o.dataUF:null,o=!1,e){for(var l=0,a=e.length;l<a;l++)if(e[l]==i){o=!0;break}}if(!o&&t){for(n=!0,l=0,a=t.length;l<a;l++)if(t[l]==i){o=!0;break}}return o?{rowIndxPage:n?void 0:l-r,uf:n,rowIndx:l,rowData:i}:{}}return null==e||0==e.length||null==(i=e.attr("pq-row-indx"))?{}:{rowIndxPage:i=parseInt(i),rowIndx:i+r}},r.search=function(t){var e=this.options,i=t.row;t=t.first;for(var r=[],o=this.rowIndxOffset,n="remote"==e.pageModel.type,e=e.dataModel.data,l=0,a=e.length;l<a;l++){var s,d=e[l],h=!0;for(s in i)i[s]!==d[s]&&(h=!1);if(h&&(d=this.normalize({rowIndx:n?l+o:l}),r.push(d),t))break}return r};var c=function(t){this.options=t.options,this.that=t},d=c.prototype;d._incrRowIndx=function(t,e){var i=this.that,r=t;e=1;for(var i=i.pdata,o=0,n=t+1,l=i.length;n<l&&(i[n].pq_hidden||(o++,r=n,o!=e));n++);return r},d._decrRowIndx=function(t,e){var i=t,r=this.that.pdata;e=1;for(var o=0,n=t-1;0<=n&&(r[n].pq_hidden||(o++,i=n,o!=e));n--);return i},d._decrRowIndx2=function(t,e){var i=this.that,r=t+i.rowIndxOffset,o=i.iMerge,i=i.pdata;if(o.ismergedCell(r,e)){var n=o.getRootCell(r,e,"a"),r=o.getData(r,e,"proxy_cell");e=n.colIndx,e=r?r.colIndx:e}for(r=t-1;0<=r;r--)if(!i[r].pq_hidden){t=r;break}return{rowIndxPage:t,colIndx:e}},d._incrRowIndx2=function(t,e){var i,r=this.that,o=t+r.rowIndxOffset,n=r.iMerge,r=r.pdata;if(i=n.ismergedCell(o,e)){var l=n.getRootCell(o,e,"a"),o=n.getData(o,e,"proxy_cell");e=l.colIndx,t=i.rowspan?t+i.rowspan-1:0,e=o?o.colIndx:e}for(o=t+1,n=r.length;o<n;o++)if(!r[o].pq_hidden){t=o;break}return{rowIndxPage:t,colIndx:e}},r.addColumn=function(t){for(var e=t.colList||[{colIndx:t.colIndx,column:t.column}],i=!1!==t.history,r=this.options.colModel,o=0;o<e.length;o++){var n=e[o].colIndx,l=e[o].column;void 0==l.dataIndx&&(l.dataIndx=Math.random()),null==n&&(n=e.colIndx=r.length),r.splice(n,0,l)}this.iColModel.init(),i&&(this.iHistory.increment(),e.type="add",this.iHistory.push({colList:e})),this._trigger("addColumn",null,{colList:e}),!1!==t.refresh&&this.refreshView()},r.deleteColumn=function(t){for(var e=t.colList||[{colIndx:t.colIndx}],i=!1!==t.history,r=this.options.colModel,o=e.length-1;0<=o;o--){var n=e[o],l=r.splice(n.colIndx,1)[0];n.column=l}this.iColModel.init(),i&&(this.iHistory.increment(),e.type="delete",this.iHistory.push({colList:e})),this._trigger("deleteColumn",null,{colList:e}),!1!==t.refresh&&this.refreshView()},d._incrIndx=function(t,e,i){var r,o,n,l,a=this.that,s=a.iMerge,d=a.pdata,h=a.rowIndxOffset,c=a[i?"getLastVisibleRIP":"getFirstVisibleRIP"](),u=a.colModel,p=u.length;if(null==e)return t==c?null:{rowIndxPage:t=this[i?"_incrRowIndx":"_decrRowIndx"](t)};do{if(o=t+h,(a=s.ismergedCell(o,e))&&(!l&&(r=s.getData(o,e,"proxy_cell"))&&(d[n=r.rowIndx-h].pq_hidden||(t=n)),d[t].pq_hidden&&(t=s.getRootCell(o,e).rowIndxPage),!l&&i&&(e+=a&&a.colspan?a.colspan-1:0)),e=i?e+1:e-1,i&&e>=p||!i&&0>e){if(t==c)return null;t=this[i?"_incrRowIndx":"_decrRowIndx"](t),e=i?0:p-1}l=u[e]}while(l&&l.hidden);return{rowIndxPage:t,colIndx:e}},d._incrEditIndx=function(t,e,i){var r,o=this.that,n=o.colModel,l=n.length,a=o.iMerge,s=o.rowIndxOffset,d=o[i?"getLastVisibleRIP":"getFirstVisibleRIP"]();do{var h=t+s;if((r=a.ismergedCell(h,e))?((h=a.getData(h,e,"proxy_edit_cell"))&&(t=(h=h.rowIndx)-s),e=i?e+r.colspan:e-1):e=i?e+1:e-1,i&&e>=l||!i&&0>e){if(t==d)return null;do if(t=this[i?"_incrRowIndx":"_decrRowIndx"](t),e=o.isEditableRow({rowIndxPage:t}),t==d&&!1==e)return null;while(!1==e);e=i?0:l-1}h=t+s,(r=a.ismergedCell(h,e))&&(t=a.getRootCell(h,e,"o"),a.setData(t.rowIndx,t.colIndx,{proxy_edit_cell:{rowIndx:h,colIndx:e}}),h=t.rowIndx,e=t.colIndx),r=n[e];var c=o.isEditableCell({rowIndx:h,colIndx:e,checkVisible:!0}),u=r.editor,u="function"==typeof u?u.call(o,o.normalize({rowIndx:h,colIndx:e})):u;t=h-s}while(r&&(r.hidden||!1==c||!1===u));return{rowIndxPage:t,colIndx:e}},d.getMergeCell=function(t,e){var i,r,o=this.that,n=o.options,l=o.iMerge;return l.ismergedCell(t,e)&&(r=l.getRootCell(t,e,"o"),l.setData(r.rowIndx,r.colIndx,{proxy_cell:{rowIndx:t,colIndx:e}}),n.virtualY&&(i=l.getRootCell(t,e,"a"))),i||(t=this.getVisibleRowIndx(t),e=this.getVisibleColIndx(e),i=o.normalize({rowIndx:t,colIndx:e})),i},d.getVisibleRowIndx=function(t){for(var e=this.that,i=e.pdata.length,r=t-e.rowIndxOffset,o=e.getRowData({rowIndx:t});o.pq_hidden&&r<i-1;)r++,t++,o=e.getRowData({rowIndx:t});return t},d.getVisibleColIndx=function(t){for(var e=this.that.colModel,i=e.length,r=e[t];r.hidden&&t<i-1;)r=e[++t];return t},r._onKeyPressDown=function(e){return 0<t(e.target).closest(".pq-grid-header").length?!1!=this._trigger("headerKeyDown",e,null):!1!==this.iKeyNav._bodyKeyPressDown(e)&&!1!=this._trigger("keyDown",e,null)&&void 0},d._saveAndMove=function(t,e){if(null==t)return e.preventDefault(),!1;var i=this.that,r=t.rowIndxPage,o=t.colIndx;if(i._blurEditMode=!0,!1===i.saveEditCell({evt:e})||!i.pdata)return i.pdata||i.quitEditMode(e),i._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),e.preventDefault(),!1;if(i.quitEditMode(e),t.incr)var n=this[t.edit?"_incrEditIndx":"_incrIndx"](r,o,!e.shiftKey),r=n?n.rowIndxPage:r,o=n?n.colIndx:o;return i.scrollRow({rowIndxPage:r}),i.scrollColumn({colIndx:o}),this.select({rowIndx:r+i.rowIndxOffset,colIndx:o,evt:e}),t.edit&&i._editCell({rowIndxPage:r,colIndx:o}),i._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"}),e.preventDefault(),!1},d._keyPressInEdit=function(e,i){var r=this.that,o=r.options.editModel.indices,n=(i=i||{}).FK,l="Backspace Left Right Up Down Del Home End".split(" "),a=o.column.dataType;return!!e.key&&-1!==t.inArray(e.key,l)||!(!1===r._trigger("editorKeyPress",e,t.extend({},o))||n&&("float"==a||"integer"==a)&&(r="float"==a?"0123456789.-":"0123456789-",(o=String.fromCharCode(o=(o=e.charCode)?o:e.keyCode))&&-1==r.indexOf(o)))},d.getValText=function(e){e=e[0].nodeName.toLowerCase();var i="text";return -1!=t.inArray(e,["input","textarea","select"])&&(i="val"),i},d._keyUpInEdit=function(e,i){var r=this.that,o=r.options,n=(i=i||{}).FK,o=o.editModel,l=o.indices;if(r._trigger("editorKeyUp",e,t.extend({},l)),r=l.column.dataType,n&&("float"==r||"integer"==r)){var n=t(e.target),l="integer"==r?o.reInt:o.reFloat,o=this.getValText(n),a=n.data("oldVal"),s=n[o]();!1==l.test(s)&&(l.test(a)?n[o](a):isNaN(r="float"==r?parseFloat(a):parseInt(a))?n[o](0):n[o](r))}},d._keyDownInEdit=function(e){var i=this.that,r=i.options,o=r.editModel.indices;if(o){var n=t(e.target),l=t.ui.keyCode,a=r.editModel,s=t.extend({},o),o=s.rowIndxPage,r=s.colIndx,d=s.column.editModel,a=d?t.extend({},a,d):a,d=this.getValText(n);if(n.data("oldVal",n[d]()),!1==i._trigger("editorKeyDown",e,s))return!1;if(e.keyCode==l.TAB||e.keyCode==a.saveKey)return s={rowIndxPage:o,colIndx:r,incr:!!(i=e.keyCode==l.TAB?a.onTab:a.onSave),edit:"nextEdit"==i},this._saveAndMove(s,e);if(e.keyCode==l.ESCAPE)return i.quitEditMode({evt:e}),i.focus({rowIndxPage:o,colIndx:r}),e.preventDefault(),!1;if(e.keyCode==l.PAGE_UP||e.keyCode==l.PAGE_DOWN)return e.preventDefault(),!1;if(a.keyUpDown&&!e.altKey){if(e.keyCode==l.DOWN)return s=this._incrRowIndx2(o,r),this._saveAndMove(s,e);if(e.keyCode==l.UP)return s=this._decrRowIndx2(o,r),this._saveAndMove(s,e)}}},d.select=function(e){var i=this.that,r=this,o=e.rowIndx,n=e.colIndx,l=e.evt,o=(e=this.getMergeCell(o,n)).rowIndx,n=e.colIndx,a=e.rowIndxPage;e=i.options;var s=i.iSelection,d=e.selectionModel,h=d.type,c="row"==h,u="cell"==h;(e.realFocus?function(t){clearTimeout(r.timeoutID),r.timeoutID=setTimeout(function(){t()},0)}:function(t){t()})(function(){i.scrollCell({rowIndx:o,colIndx:n});var e=s.address();if(l.shiftKey&&l.keyCode!==t.ui.keyCode.TAB&&d.type&&"single"!=d.mode&&e.length){var r=e[e.length-1],h=r.firstR,p=r.firstC,f=r.type,g=!1;"column"==f?(r.c1=p,r.c2=n,r.r1=r.r2=r.type=void 0):"row"==f?(r.r1=h,r.r2=o,r.c1=r.c2=r.type=void 0):(e={r1:h,r2:o,c1:p,c2:n,firstR:h,firstC:p},g=!0),i.range(e,g).select()}else c?i.range({r1:o,firstR:o},!1).select():u&&i.range({r1:o,c1:n,firstR:o,firstC:n}).select();i.focus({rowIndxPage:a,colIndx:n})})},d._bodyKeyPressDown=function(e){var i,r,o,n=this.that,l=n.rowIndxOffset;o=this.options;var a=n.iMerge,s=n._focusElement,d=o.selectionModel,h=o.editModel,c=e.ctrlKey||e.metaKey,u=t.ui.keyCode,p=e.keyCode;if(h.indices)n.$div_focus.find(".pq-cell-focus").focus();else{if(s){if("pq-grid-cont"!=(o=document.activeElement).className&&"TD"!=o.nodeName.toUpperCase()&&"pq-grid-excel"!=o.id)return}else{if(!(s=t(e.target)).hasClass("pq-grid-cell"))return;s=n.getCellIndices({$td:s})}var f=n.normalize(s);r=f.rowIndxPage,i=f.rowIndx,o=f.colIndx;var g=n.pdata,v=f,s=!0;if(null!=i&&null!=o&&null!=f.rowData){if(a.ismergedCell(i,o)&&(r=(f=v=a.getRootCell(i,o,"o")).rowIndxPage,i=f.rowIndx,o=f.colIndx,p==u.PAGE_UP||p==u.PAGE_DOWN||p==u.SPACE||p==u.HOME||p==u.END)&&(a=a.getData(i,o,"proxy_cell"))&&(g[a=a.rowIndx-l].pq_hidden||(i=(r=a)+l)),!1==n._trigger("cellKeyDown",e,v))return!1;p==u.LEFT||p==u.RIGHT||p==u.UP||p==u.DOWN||d.onTab&&p==u.TAB?(n=null,p==u.LEFT||p==u.TAB&&e.shiftKey?n=this._incrIndx(r,o,!1):p!=u.RIGHT&&(p!=u.TAB||e.shiftKey)?p==u.UP?n=this._decrRowIndx2(r,o):p==u.DOWN&&(n=this._incrRowIndx2(r,o)):n=this._incrIndx(r,o,!0),n&&(i=n.rowIndxPage+l,this.select({rowIndx:i,colIndx:n.colIndx,evt:e}))):p==u.PAGE_DOWN||p==u.SPACE||p==u.PAGE_UP?(n=this[p==u.PAGE_UP?"pageUp":"pageDown"](r))&&null!=(r=n.rowIndxPage)&&this.select({rowIndx:r+l,colIndx:o,evt:e}):p==u.HOME?(c?i=n.getFirstVisibleRIP()+l:o=n.getFirstVisibleCI(),this.select({rowIndx:i,colIndx:o,evt:e})):p==u.END?(c?i=n.getLastVisibleRIP()+l:o=n.getLastVisibleCI(),this.select({rowIndx:i,colIndx:o,evt:e})):p==u.ENTER?(r=v.rowIndxPage,o=v.colIndx,(d=n.getCell({rowIndxPage:r,colIndx:o}))&&0<d.length&&(i=r+l,l=n.isEditableRow({rowIndx:i}),u=n.isEditableCell({rowIndx:i,colIndx:o}),l&&u?n.editCell({rowIndxPage:r,colIndx:o}):(n=d.find("button")).length&&t(n[0]).click())):c&&"65"==p?(n=n.iSelection,"row"==d.type&&"single"!=d.mode?n.selectAll({type:"row",all:d.all}):"cell"==d.type&&"single"!=d.mode&&n.selectAll({type:"cell",all:d.all})):h.pressToEdit&&(32<=p&&127>=p||189==p)&&!c?46==p?n.clear():(r=v.rowIndxPage,o=v.colIndx,(d=n.getCell({rowIndxPage:r,colIndx:o}))&&0<d.length&&(i=r+l,l=n.isEditableRow({rowIndx:i}),u=n.isEditableCell({rowIndx:i,colIndx:o}),l&&u&&n.editCell({rowIndxPage:r,colIndx:o,select:!0})),s=!1):s=!1,s&&e.preventDefault()}}},d.incrPageSize=function(){for(var e=this.that,i=e.$tbl,r=i.children("tbody").children(".pq-grid-row"),i=parseInt(i.css("marginTop")),i=e.iRefresh.getEContHt()-i,o=r.length-1;0<=o;o--){var n=r[o];if(n.offsetTop<i)break}return{rowIndxPage:e.getRowIndx({$tr:t(n)}).rowIndxPage}},d.pageNonVirtual=function(e,i){var r=this.that,o=r.$cont[0].offsetHeight-r._getSBHeight(),n=r.getRow({rowIndxPage:e}),l=0,a=0,s=t(n[0])[i]("tr.pq-grid-row"),d=s.length;if(0<d){do{if((l+=(n=s[a]).offsetHeight)>=o)break;a++}while(a<d);a=0<a?a-1:a;do if(n=t(s[a]),null!=(e=r.getRowIndx({$tr:n}).rowIndxPage))break;else a--;while(0<=a)}return e},d.pageDown=function(t){var e=this.that,i=e.options,r=e.vscroll,o=r.option("cur_pos"),n=r.option("num_eles"),l=r.option("ratio");if(i.virtualY){if(o<n-1){t=this.incrPageSize().rowIndxPage;var a=e._calcCurPosFromRowIndxPage(t);if(null==a)return;r.option("cur_pos",a),r.scroll()}}else null!=t?t=this.pageNonVirtual(t,"nextAll"):1>l&&(i=e.iRefresh.getEContHt(),(e=e.iMouseSelection).updateTableY(-1*i),e.syncScrollBarVert());return{rowIndxPage:t,curPos:a}},d.pageUp=function(t){var e=this.that,i=e.vscroll;if(e.options.virtualY){if(0<i.option("cur_pos")){t=this.decrPageSize().rowIndxPage;var r=e._calcCurPosFromRowIndxPage(t);if(null==r)return;i.option("cur_pos",r),i.scroll()}}else i=i.option("ratio"),null!=t?t=this.pageNonVirtual(t,"prevAll"):0<i&&(i=e.iRefresh.getEContHt(),(e=e.iMouseSelection).updateTableY(i),e.syncScrollBarVert());return{rowIndxPage:t,curPos:r}},d.decrPageSize=function(){var e,i,r=this.that,o=r.$tbl.children("tbody").children(".pq-grid-row"),n=r.options.freezeRows,l=r.pdata,a=0;if(o.length&&(n?(e=o.filter("tr.pq-last-frozen-row")).length&&(e=e.next()):2<=o.length&&(e=t(o[1])),e&&e.length))for(i=a=r.getRowIndx({$tr:e}).rowIndxPage,o=0,r=r.pageSize-3;0<=a&&(l[a].pq_hidden||(o++,i=a,!(o>=r)));a--);return{rowIndxPage:i}},r._calcNumHiddenFrozens=function(){for(var t=0,e=this.options.freezeCols,i=0;i<e;i++)this.colModel[i].hidden&&t++;return t},r._calcNumHiddenUnFrozens=function(t){var e=0;t=null!=t?t:this.colModel.length;for(var i=this.options.freezeCols;i<t;i++)this.colModel[i].hidden&&e++;return e},r._getSBHeight=function(){return this.iRefresh.getSBHeight()},r._getSBWidth=function(){return this.iRefresh.getSBWidth()},r.getFirstVisibleRIP=function(t){var e=this.pdata;t=t?this.initV:0;for(var i=e.length;t<i;t++)if(!e[t].pq_hidden)return t},r.getLastVisibleRIP=function(){for(var t=this.pdata,e=t.length-1;0<=e;e--)if(!t[e].pq_hidden)return e;return null},r.getFirstVisibleCI=function(t){var e=this.colModel,i=e.length;for(t=t?this.initH:0;t<i;t++)if(!e[t].hidden)return t;return null},r.getLastVisibleCI=function(){for(var t=this.colModel,e=t.length-1;0<=e;e--)if(!t[e].hidden)return e;return null},r.getTotalVisibleColumns=function(){for(var t=this.colModel,e=t.length,i=0,r=0;r<e;r++)t[r].hidden||i++;return i},r._calcCurPosFromRowIndxPage=function(t){var e=this.pdata,i=this.options.freezeRows;if(t<i)return 0;for(var r=0,o=i,n=e.length;i<n;i++){var l=e[i];if(o==t)break;o++,l.pq_hidden||r++}return r>=n?null:r},r._calcCurPosFromColIndx=function(t){var e=this.colModel,i=this.options.freezeCols;if(t<i)return 0;for(var r=0,o=i,n=e.length;i<n;i++){var l=e[i];if(o==t)break;o++,l.hidden||r++}return r>=n?null:r},r.calcWidthCols=function(t,e,i){var r=0,o=this.options.numberCell,n=this.colModel;if(-1==t&&(o.show&&(r=i?r+1*o.width:r+o.outerWidth),t=0),i){for(;t<e;t++)if((i=n[t])&&!i.hidden){if(!i._width)throw"assert failed";r+=i._width+0}}else for(;t<e;t++)(i=n[t])&&!i.hidden&&(r+=i.outerWidth);return r},r.calcHeightFrozenRows=function(){var e=this.$tbl,i=0;return e&&e.length&&(e=t(e[0]).find("tr.pq-last-frozen-row"))&&e.length&&(i=(i=e[0]).offsetTop+i.offsetHeight),i},r._calcRightEdgeCol=function(t){var e=0,i=0,r=this.colModel,o=this.initH,n=this.options,l=n.freezeCols,n=n.numberCell;for(n.show&&(e+=n.outerWidth,i++),n=0;n<=t;n++){n<o&&n>=l&&(n=o);var a=r[n];a.hidden||(e+=a.outerWidth,i++)}return{width:e,cols:i}},r._createHeader=function(){this.iHeader.createHeader(),this.options.showHeader&&this._trigger("createHeader")},r.createTable=function(t){t.other=!0;var e=this.iGenerateView;e.generateView(t),e.scrollView()}}(jQuery),function(t){function e(t){this.that=t}function i(t,e,i){for(var r=0;e<i;e++)!0!==t[e].hidden&&r++;return r}function r(e){if(e.length)var i=e.css({tableLayout:"auto",width:""}).addClass("pq-no-wrap").removeClass("pq-wrap").children("tbody").children(".pq-row-hidden").children("td").css("width","");return i||t()}function o(t,e,i){for(var r,o;i&&(r=t[i][e])==(o=t[i-1][e]);)i--;return i}var n=t.paramquery,l=n._pqGrid.prototype;l.getHeadCell=function(t){var e,i,r,o,n=t.attr("pq-col-indx");return t=t.attr("pq-row-indx"),null!=n&&null!=t&&(n*=1,t*=1,i=this.headerCells[t][n])&&(o=i.colModel,r=i.leftPos),o&&o.length&&(e=!0),{col:i,ci:n,o_ci:r,ri:t,isParent:e}},l.flex=function(t){this.iResizeColumns.flex(t)},n.cHeader=e,(l=e.prototype).createHeader=function(){var e=this.that,i=this,r=e.options,o=r.bootstrap,n=(o.on?o.thead:"")+" pq-grid-header-table ",l=r.ui,a=o.on?"":l.header,s=r.hwrap,o=e.pqpanes,d=parseInt(r.freezeCols),h=r.numberCell,l=e.colModel,c=r.sortModel,u=e.depth,p=r.virtualX,f=e.iGenerateView.colDef,g=e.initH,v=e.finalH,w=e.headerCells,m=e.$header_o;if(m.empty(),null!=v){if(!1===r.showHeader)m.css("display","none");else{if(m.css("display",""),r=["<table class='"+(s?n+"pq-wrap ":n+"pq-no-wrap ")+"' >"],1<=u){r.push("<tr class='pq-row-hidden'>"),h.show&&r.push("<td style='width:"+h.width+"px;' ></td>");for(var s=0,x=f.length;s<x;s++){var $=f[s],n=$.colIndx;r.push("<td style='width:"+$.column.outerWidth+"px;' pq-col-indx="+n+"></td>")}r.push("</tr>")}for(f=0;f<u;f++){for(r.push("<tr class='pq-grid-title-row'>"),0==f&&h.show&&r.push(["<th pq-col-indx='-1' class='pq-grid-number-col' rowspan='",u,"'><div class='pq-td-div'>",h.title?h.title:"&nbsp;","</div></th>"].join("")),n=0;n<=v;n++){if(n<g&&n>=d&&p&&(n=g)>v)throw"initH>finalH";i.createHeaderCell(f,n,w,r,"pq-grid-col ",d,g,u,c)}r.push("</tr>")}e.ovCreateHeader(r,"pq-grid-col "),r.push("</table>"),d=r.join(""),m[0].innerHTML=o.vH?["<span class='pq-grid-header pq-grid-header-left ",a,"'><div class='pq-grid-header-inner'>",d,"</div></span><span class='pq-grid-header ",a,"'><div class='pq-grid-header-inner'>",d,"</div></span>"].join(""):["<span class='pq-grid-header ",a,"'><div class='pq-grid-header-inner'>",d,"</div></span>"].join(""),m=(a=e.$header=m.children(".pq-grid-header")).children(".pq-grid-header-inner"),e.$tbl_header=m.children("table"),e.$header_left=t(a[0]),e.$header_left_inner=t(m[0]),o.vH&&(e.$header_right=t(a[1]),e.$header_right_inner=t(m[1])),a.click(function(t){return i._onHeaderClick(t)}),i._refreshResizeColumn(g,v,l),e._trigger("refreshHeader",null,null)}}},l._onHeaderClick=function(e){var i,r=this.that;if(!(i=r.iDragColumns)||"stop"==i.status){if((i=t(e.target)).is("input,label"))return!0;if((i=i.closest(".pq-grid-col")).length&&(r=(i=r.getHeadCell(i)).col)&&!i.isParent)return this._onHeaderCellClick(r,i.ci,e)}},l.createHeaderCell=function(t,e,r,o,l,a,s,d,h){var c=this.that,u=c.options.sheet,p=r[t][e],f=c.colModel,g=p.colSpan;if(!(p.hidden||0===g||0<t&&p==r[t-1][e])){if(0<e&&p==r[t][e-1]){if(e>s)return;a:{r=r[t];for(var v=0;v<r.length;v++)if(r[v]==p){r=v;break a}r=void 0}if(r<a)return;g-=i(f,r,e)}else a&&e<a&&e+g>a&&(g-=i(f,a,s),g=Math.max(g,f=i(f,e,a)));f=p.halign||p.align,r=p.cls,l=[l];var v=p.title,w=p.type,v="function"==typeof v?v.call(c,{column:p,colIndx:e,dataIndx:p.dataIndx}):v,v=u?n.toLetter(e):v,v=null!=v?v:"checkbox"==w&&p.cb.header?"<input type='checkbox'/>":p.dataIndx;p.pqtitle=v,f&&l.push("pq-align-"+f),e==a-1&&1==d&&l.push("pq-last-frozen-col"),e<=a-1?l.push("pq-left-col"):e>=s&&l.push("pq-right-col"),r&&l.push(r),null!=p.colModel&&0!=p.colModel.length||l.push("pq-grid-col-leaf"),a=h.space?"pq-space":"",o.push(["<th  ","pq-col-indx="+e," ","pq-row-indx="+t,"  class='",l.join(" "),"' rowspan=",p.rowSpan," colspan=",g,"><div class='pq-td-div'>",v,"<span class='pq-col-sort-icon ",a,"'></span>",h.number?"<span class='pq-col-sort-count "+a+"'></span>":"","</div></th>"].join(""))}},l._onHeaderCellClick=function(t,e,i){var r=this.that,o=r.options,n=o.sortModel,l=t.dataIndx;!1!==r._trigger("headerCellClick",i,{column:t,colIndx:e,dataIndx:l})&&(o.selectionModel.column&&-1==i.target.className.indexOf("pq-td-div")?(o={c1:e,firstC:e},t=r.iSelection.address(),i.shiftKey&&((i=t.length)&&"column"==t[i-1].type&&((i=t[i-1]).c1=i.firstC,i.c2=e,i.r1=i.r2=i.type=void 0),o=t),r.range(o,!1).select(),r.focus({rowIndxPage:r.getFirstVisibleRIP(!0),colIndx:e})):n.on&&!1!=t.sortable&&(n.multiKey&&(n.single=!i[n.multiKey]),r.sort({sorter:[{dataIndx:l}],addon:!0,evt:i})))},l._refreshResizeColumn=function(t,e,i){e=!!(i=(t=this.that).options).filterModel.ficon;var r=i.numberCell;i=parseInt(i.freezeCols);var o=[],n=[],l=t.pqpanes.vH,a=0,s=0;r.show&&(a=r.outerWidth,r.resizable&&o.push("<div pq-col-indx='-1' style='left:",a-5,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>"));for(var r=t.iGenerateView.colDef,d=0,h=r.length;d<h;d++){var s=r[d],c=s.colIndx,s=s.column,u=s.ficon,p=u||null==u&&e,u=o,a=a+s.outerWidth;(!1!==s.resizable||p)&&(l&&c>=i&&(u=n),s=a-5,u.push("<div pq-col-indx='",c,"' style='left:",s,"px;'"," class='pq-grid-col-resize-handle'>&nbsp;</div>"))}n.length&&t.$header_right_inner.append(n.join("")),t.$header_left_inner.append(o.join(""))},l.refreshHeaderSortIcons=function(){var t=this.that,e=t.options,i=e.bootstrap,e=e.ui,r=t.$header;if(r){var o=t.iSort.getSorter(),n=o.length,l=!1;t.options.sortModel.number&&1<n&&(l=!0);for(var a=0;a<n;a++){var s=o[a],d=t.getColIndx({dataIndx:s.dataIndx}),h=s.dir,s=i.on?i.header_active:e.header_active+" pq-col-sort-"+("up"==h?"asc":"desc"),h=i.on?" glyphicon glyphicon-arrow-"+h:"ui-icon ui-icon-triangle-1-"+("up"==h?"n":"s"),d=r.find(".pq-grid-col-leaf[pq-col-indx="+d+"]");d.addClass(s),d.find(".pq-col-sort-icon").addClass(h),l&&d.find(".pq-col-sort-count").html(a+1)}}},l=function(e){this.that=e;var i=this;e.$header_o.on({mousedown:function(e){if(!e.pq_composed){var r=t(e.target);i.setDraggables(e),e.pq_composed=!0,e=t.Event("mousedown",e),r.trigger(e)}},dblclick:function(t){i.doubleClick(t)}},".pq-grid-col-resize-handle");var r=e.options.flex;r.on&&r.one&&e.one("ready",function(){i.flex()})},n.cResizeColumns=l,(l=l.prototype=new n.cClass).doubleClick=function(e){var i=this.that.options,r=i.flex;isNaN(e=parseInt((e=t(e.target)).attr("pq-col-indx")))||r.on&&this.flex(r.all&&!i.scrollModel.autoFit?{}:{colIndx:[e]})},l.flex=function(e){e=e||{};var i,o=this.that,n=o.element,l=o.options.numberCell,a=e.colIndx,s=e.dataIndx;e=null==e.refresh||e.refresh;var d=!1,h=o.$tbl,c=o.$tbl_header,u=h&&h.length?t(h[0]).clone():t(),p=o.tables&&o.tables.length?o.tables[0].$tbl:null,p=p?t(p[0]).clone():t(),f=c&&c.length?t(c[0]).clone():t();if(u.find(".pq-merge-cell").each(function(e,i){i.innerHTML=t(i).find(".pq-merge-inner")[0].innerHTML,i.style.whiteSpace="noWrap"}),null!=s)for(a=[],c=0,h=s.length;c<h;c++){var g=o.colIndxs[s[c]];null!=g&&a.push(g)}null!=a&&(a.sort(function(t,e){return t-e}),i=a.length),f.find("tr.pq-grid-header-search-row").remove();var s=r(u),g=r(p),v=r(f),u=t("<div class='pq-grid' style='width:1px;height:1px;position:absolute;left:0px;top:0px;'>").append(f).append(p).append(u);for(u.addClass(n.attr("class")),n.parent().append(u),n=l.show?0:-1,l=o.iGenerateView.colDef,c=0,h=l.length;c<h;c++){if(f=(p=l[c]).colIndx,p=p.column,n++,a){if(a.length){if(a[0]!==f)continue;a.splice(0,1)}else break}var f=s[n],w=v[n],m=g[n],f=Math.max(f?f.offsetWidth:0,m?m.offsetWidth:0,w?w.offsetWidth:0)-0+1;p._width!==f&&(d=!0,p.width=f,1===i&&(p._resized=!0))}u.remove(),d&&e&&o.refresh({source:"flex"})},l.setDraggables=function(e){var i,r,o,n=this;t(e.target).draggable({axis:"x",helper:function(e,i){var r=t(e.target),o=parseInt(r.attr("pq-col-indx"));return n._setDragLimits(o),n._getDragHelper(e,i),r},start:function(t,e){i=e.position.left,o=parseInt(n.$cl[0].style.left)},drag:function(t,e){r=e.position.left,n.$cl[0].style.left=o+(r-i)+"px"},stop:function(t,e){return n.resizeStop(t,e,i)}})},l._getDragHelper=function(e){var i=this.that,r=parseInt(i.options.freezeCols);e=t(e.target);var o=i.$grid_center;e=parseInt(e.attr("pq-col-indx"));var n=o.outerHeight();this.$cl=t("<div class='pq-grid-drag-bar'></div>").appendTo(o),this.$clleft=t("<div class='pq-grid-drag-bar'></div>").appendTo(o),this.$cl.height(n),this.$clleft.height(n),n=(o=t("[pq-col-indx="+e+"]",i.$header)[0]).offsetLeft,i.pqpanes.vH?e>=r&&(n-=i.$header[1].scrollLeft):(n+=i.$header[0].offsetLeft,n-=i.$header[0].scrollLeft),this.$clleft.css({left:n}),n+=o.offsetWidth,this.$cl.css({left:n})},l._setDragLimits=function(t){if(!(0>t)){var e=this.that,i=e.colModel[t],r=e.$header_left;t>=e.options.freezeCols&&e.pqpanes.vH&&(r=e.$header_right),i=(e=r.find("th[pq-col-indx='"+t+"']").offset().left+i._minWidth)+i._maxWidth-i._minWidth,r.find("div.pq-grid-col-resize-handle[pq-col-indx="+t+"]").draggable("option","containment",[e,0,i,0])}},l.resizeStop=function(e,i,r){var o=this.that,n=o.colModel,l=o.options.numberCell;if(this.$clleft.remove(),this.$cl.remove(),r=i.position.left-r,-1==(i=parseInt((i=t(i.helper)).attr("pq-col-indx")))){var n=null,a=parseInt(l.width);l.width=a+r}else a=parseInt((n=n[i]).width),n.width=a+r,n._resized=!0;o.refresh(),o._trigger("columnResize",e,{colIndx:i,column:n,dataIndx:n?n.dataIndx:null,oldWidth:a,newWidth:n?n.width:l.width})},l=function(e){this.that=e,this.$drag_helper=null;var i=e.options.dragColumns,r=i.topIcon,o=i.bottomIcon;this.status="stop",this.$arrowTop=t("<div class='pq-arrow-down ui-icon "+r+"'></div>").appendTo(e.element),this.$arrowBottom=t("<div class='pq-arrow-up ui-icon "+o+"' ></div>").appendTo(e.element),this.hideArrows(),i&&i.enabled&&e.$header_o.on("mousedown",".pq-grid-col",this.onColMouseDown(this,e))},n.cDragColumns=l,(l=l.prototype).onColMouseDown=function(e,i){return function(r){var o,n,l;o=t(this),r.pq_composed||t(r.target).is("input,select,textarea")||(l=(n=(o=i.getHeadCell(o)).col)?n.parent:null,!n||n.nodrag||n._nodrag||l&&1==l.colSpan||!e.setDraggable(r,n,o)||(r.pq_composed=!0,o=t.Event("mousedown",r),t(r.target).trigger(o)))}},l.showFeedback=function(t,e){var i=this.that,r=t[0],o=i.$grid_center[0].offsetTop,n=r.offsetLeft-r.offsetParent.offsetParent.offsetParent.scrollLeft+(e?0:r.offsetWidth)-8,i=o+i.$header[0].offsetHeight;this.$arrowTop.css({left:n,top:o+r.offsetTop-16,display:""}),this.$arrowBottom.css({left:n,top:i,display:""})},l.showArrows=function(){this.$arrowTop.show(),this.$arrowBottom.show()},l.hideArrows=function(){this.$arrowTop.hide(),this.$arrowBottom.hide()},l.updateDragHelper=function(t){var e=this.that.options.dragColumns,i=e.acceptIcon,e=e.rejectIcon,r=this.$drag_helper;r&&(t?(r.children("span.pq-drag-icon").addClass(i).removeClass(e),r.removeClass("ui-state-error")):(r.children("span.pq-drag-icon").removeClass(i).addClass(e),r.addClass("ui-state-error")))},l.setDraggable=function(e,i,r){e=t(e.currentTarget);var o=this,n=o.that;if(!e.hasClass("ui-draggable"))return e.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:n.element,revert:"invalid",helper:o.dragHelper(o,n,i),start:o.onStart(o,n,i,r),drag:o.onDrag(o,n),stop:function(){o.status="stop",n.$header.find(".pq-grid-col-resize-handle").show(),o.hideArrows()}}),!0},l.onStart=function(t,e,i,r){return function(o){if(!1===e._trigger("columnDrag",o.originalEvent,{column:i}))return!1;t.setDroppables(r)}},l.onDrag=function(e,i){return function(r,o){e.status="drag";var n=t(".pq-drop-hover",i.$header);if(0<n.length){e.showArrows(),e.updateDragHelper(!0);var l=n.width();r.clientX-n.offset().left+t(document).scrollLeft()<l/2?(e.leftDrop=!0,e.showFeedback(n,!0)):(e.leftDrop=!1,e.showFeedback(n,!1))}else e.hideArrows(),t(".pq-drop-hover",i.$top).length?e.updateDragHelper(!0):e.updateDragHelper()}},l.dragHelper=function(e,i,r){var o=i.options.dragColumns.rejectIcon;return function(){e.status="helper",i.$header.find(".pq-grid-col-resize-handle").hide();var n=t("<div class='pq-col-drag-helper ui-widget-content ui-corner-all panel panel-default' ><span class='pq-drag-icon ui-icon "+o+" glyphicon glyphicon-remove'></span>"+r.pqtitle+"</div>");return e.$drag_helper=n,n[0]}},l._columnIndexOf=function(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]==e)return i;return -1},l.setDroppables=function(e){var i,r,o,n,l,a=this.that,s=e.col,d=e.ri,h=(e=e.o_ci)+s.o_colspan;r=a.$header_left;var c,u={hoverClass:"pq-drop-hover ui-state-highlight",accept:".pq-grid-col",tolerance:"pointer",drop:this.onDrop()},p=r.find(".pq-left-col");for(r=a.pqpanes.v||a.pqpanes.vH?a.$header_right.find(".pq-right-col"):r.find(".pq-right-col"),c=(p=p.add(r)).length;c--;)l=(n=t(p[c])).hasClass("ui-droppable"),o=(i=a.getHeadCell(n)).col,r=i.ri,i=i.ci,o==s||o.nodrop||o._nodrop||d<r&&i>=e&&i<h?l&&n.droppable("destroy"):l||n.droppable(u)},l.onDrop=function(){var e=this,i=this.that;return function(r,o){if(!e.dropPending){var n=1*o.draggable.attr("pq-col-indx"),l=1*o.draggable.attr("pq-row-indx"),a=t(this),s=1*a.attr("pq-col-indx"),a=1*a.attr("pq-row-indx"),d=e.moveColumn(n,s,e.leftDrop,l,a);e.dropPending=!0,window.setTimeout(function(){i.iColModel.init(),!1!==i._trigger("columnOrder",null,{dataIndx:d.dataIndx,column:d,oldcolIndx:n,colIndx:i.getColIndx({column:d})})&&i.refresh(),e.dropPending=!1},0)}}},l.moveColumn=function(t,e,i,r,n){var l=this.that,a=l.options.colModel,s=l.headerCells,l=l.depth-1;r=null==r?o(s,t,l):r;var l=s[n=null==n?o(s,e,l):n][e],d=r?s[r-1][t].colModel:a;return e=n?s[n-1][e].colModel:a,t=this._columnIndexOf(d,s[r][t]),i=i?1:0,t=d.splice(t,1)[0],i=this._columnIndexOf(e,l)+1-i,e.splice(i,0,t),t}}(jQuery),function(t){function e(e,i){this.that=e;var r=this,o=e.options;this.type="detail",this.refreshComplete=!0,this.detachView=!1,e.on("cellClick",function(t,e){return r.toggle(t,e)}).on("cellKeyDown",function(e,i){if(e.keyCode==t.ui.keyCode.ENTER)return r.toggle(e,i)}).on("refresh",function(t,e){return r.aftertable()}).on("beforeTableView",function(t,e){return r.beforeTableView(t,e)}).on("tableWidthChange",function(t,e){return r.tableWidthChange(t,e)}),i._render=function(t){var e=o.detailModel,i=t.cellData;if(!(t=t.rowData).pq_gsummary&&!t.pq_gtitle)return"<div class='ui-icon "+(e=i&&i.show?e.expandIcon:e.collapseIcon)+"'></div>"}}t.paramquery.cHierarchy=e;var i=e.prototype=new t.paramquery.cClass;i.tableWidthChange=function(){if(this.refreshComplete){this.refreshComplete=!1;for(var e=this.that.$tbl.children("tbody").children("tr.pq-detail-child").children("td.pq-detail-child"),i=0,r=e.length;i<r;i++)for(var o=t(e[i]).find(".pq-grid"),n=0,l=o.length;n<l;n++){var a=t(o[n]);a.is(":visible")&&a.pqGrid("onWindowResize")}this.refreshComplete=!0}},i.aftertable=function(e){var i=this.that,r=i.options.detailModel.init,o=i.pdata;if(this.refreshComplete){this.refreshComplete=!1,e=e||i.$tbl.children("tbody").children("tr.pq-detail-child");for(var n=0,l=e.length;n<l;n++){var a=t(e[n]),s=a.attr("pq-row-indx"),d=o[s],s=!1,h=d.pq_detail.child;for(h||"function"!=typeof r||(s=!0,h=r.call(i.element[0],{rowData:d}),d.pq_detail.child=h,d.pq_detail.height=25),(a=a.children("td.pq-detail-child")).append(h),a=a.find(".pq-grid"),h=0,d=a.length;h<d;h++){var c=t(a[h]);s?c.hasClass("pq-pending-refresh")&&c.is(":visible")&&(c.removeClass("pq-pending-refresh"),c.pqGrid("refresh")):c.is(":visible")&&c.pqGrid("onWindowResize")}}this.refreshComplete=!0,this.detachView=!1}},i.beforeTableView=function(t,e){this.detachView||(this.detachInitView(),this.detachView=!0)},i.detachInitView=function(e){var i=this.that.$tbl;if(i&&i.length)for(e=e||i.children("tbody").children("tr.pq-detail-child"),i=0;i<e.length;i++)t(e[i]).children("td.pq-detail-child").children().detach()},i.toggle=function(t,e){var i=this.that,r=e.column,o=e.rowData,n=e.rowIndx,l=this.type;o.pq_gtitle||o.pq_gsummary||!r||r.type!==l||(r={rowIndx:n,focus:!0},null==o.pq_detail?i.rowExpand(r):!1===o.pq_detail.show?i.rowExpand(r):this.rowCollapse(r))},i.rowExpand=function(t){this.normalize(t);var e=this.that,i=t.rowData,r=t.rowIndx,o=t.rowIndxPage,n=e.options.detailModel;if(null!=i){if(!1===e._trigger("beforeRowExpand",null,t))return!1;null==i.pq_detail?i.pq_detail={show:!0}:!1===i.pq_detail.show&&(i.pq_detail.show=!0),n.cache||this.rowInvalidate(t),e.refreshRow({rowIndx:r}),n=[],e.iGenerateView._generateDetailRow(i,o,n),(i=e.getRow({rowIndxPage:o})).after(n.join("")),this.aftertable(i.next()),t.focus&&e.getCell({rowIndx:r,dataIndx:"pq_detail"}).attr("tabindex","0").focus(),t.scrollRow&&this.scrollRow({rowIndx:r})}},i.rowInvalidate=function(t){var e=(t=this.that.getRowData(t)).pq_detail;(e=e?e.child:null)&&(e.remove(),t.pq_detail.child=null,t.pq_detail.height=0)},i.normalize=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset;t.rowIndx=null==i?r+o:i,t.rowIndxPage=null==r?i-o:r,t.rowData=e.getRowData(t)},i.rowCollapse=function(t){this.normalize(t);var e=this.that,i=e.options,r=t.rowData,o=t.rowIndx,n=t.rowIndxPage,l=i.detailModel;null!=r&&null!=r.pq_detail&&!0===r.pq_detail.show&&(l.cache||this.rowInvalidate(t),r.pq_detail.show=!1,i.virtualY?e.refresh():((i=e.getRow({rowIndxPage:n}).next("tr.pq-detail-child")).length&&(this.detachInitView(i),i.remove(),e.refreshRow({rowIndx:o})),t.focus&&e.getCell({rowIndx:o,dataIndx:"pq_detail"}).attr("tabindex","0").focus()),t.scrollRow&&(o=t.rowIndx,this.scrollRow({rowIndx:o})))}}(jQuery),function(t){var e=function(t){var e=this;e.that=t,t.on("dataReadyDone",function(){e.calcVisibleV()}).on("CMInit",function(){e.calcVisibleH()}).on("refresh",function(){e.summaryTable()})};t.paramquery.cRefresh=e,(e=e.prototype)._computeOuterWidths=function(){for(var t=this.that,e=t.options.numberCell,t=t.colModel,i=t.length,r=0;r<i;r++){var o=t[r];o.outerWidth=o._width+0}e.show&&(e.outerWidth=e.width)},e.autoFit=function(){var t=this.that,e=t.colModel,i=e.length,t=t.calcWidthCols(-1,i,!0),r=this.contWd-this.getSBWidth();if(t!==r){for(var o,t=t-r,r=[],n=0;n<i;n++){var l=e[n],a=l._percent,s=l._resized;l.hidden||a||s||(0>t?(a=l._maxWidth-l._width)&&r.push({availWd:-1*a,colIndx:n}):(a=l._width-l._minWidth)&&r.push({availWd:a,colIndx:n})),s&&(o=l,delete l._resized)}for(r.sort(function(t,e){return t.availWd>e.availWd?1:t.availWd<e.availWd?-1:0}),n=0,i=r.length;n<i;n++){var d,l=r[n],a=l.availWd,l=l.colIndx,s=Math.round(t/(i-n)),l=e[l];d=l._width,Math.abs(a)>Math.abs(s)?(d-=s,t-=s):(d-=a,t-=a),l.width=l._width=d}0!=t&&o&&((d=o._width-t)>o._maxWidth?d=o._maxWidth:d<o._minWidth&&(d=o._minWidth),o.width=o._width=d)}},e.autoLastColumn=function(){var t=this.that,e=t.colModel,i=e.length,r=t.options.freezeCols,o=this.contWd-this.getSBWidth(),n=t.calcWidthCols(-1,r,!0),o=o-n,n=!1,t=t.getLastVisibleCI();if(null!=t&&!(t=e[t])._percent){for(var l,a=t._width,s=t._minWidth,d=t._maxWidth,i=i-1;i>=r;i--){var h=e[i];if(!h.hidden&&0>(o-=h=h._width+0)){n=!0,l=a+o>=s?a+o:a+h+o;break}}n||(l=a+o),l>d?l=d:l<s&&(l=s),t.width=t._width=l}},e.numericVal=function(t,e){var i;return Math.round(i=-1<(t+"").indexOf("%")?parseInt(t)*e/100:parseInt(t))},e.refreshColumnWidths=function(t){t=t||{};var e=this.that,i=e.options,r=i.numberCell,o="flex"===i.width,n=e.colModel,l=i.scrollModel,a=l.lastColumn,l=l.autoFit,s=this.contWd,d=n.length,h=this.getSBWidth(),c=i._minColWidth,u=i._maxColWidth,p=0;if(r.show&&(r.width<r.minWidth&&(r.width=r.minWidth),p=r.outerWidth=r.width),r=o?null:s-h-p,c=Math.floor(this.numericVal(c,r)),u=Math.ceil(this.numericVal(u,r)),s=0,!o&&5>r||isNaN(r)){if(i.debug)throw"availWidth N/A"}else{for(delete e.percentColumn,h=0;h<d;h++)if(!(p=n[h]).hidden){var f=p.width,g=-1<(f+"").indexOf("%")||null,v=p.minWidth,w=p.maxWidth,v=v?this.numericVal(v,r):c,w=w?this.numericVal(w,r):u;if(w<v&&(w=v),void 0!=f){var m=0;!o&&g?(e.percentColumn=!0,p.resizable=!1,p._percent=!0,m=Math.floor(f=this.numericVal(f,r)-0),1<=(s+=f-m)&&(m+=1,s-=1)):f&&(m=parseInt(f)),m<v?m=v:!o&&m>w&&(m=w),p._width=m}else p._width=v;g||(p.width=p._width),p._minWidth=v,p._maxWidth=o?1e3:w}!1===o&&!1!==t.refreshWidth&&(l&&this.autoFit(),"auto"===a&&i.virtualX&&this.autoLastColumn()),this._computeOuterWidths()}},e.estRowsInViewPort=function(){var t=Math.ceil(this.contHt/this.rowHt);return this.that.pageSize=t},e._refreshFrozenLine=function(){var e=this.that,i=e.options,r=i.numberCell,o=e.$cont_o,n=i.freezeBorders,l=i.freezeCols,i=i.freezeRows;this.$freezeLine&&this.$freezeLine.remove(),this.$freezeLineH&&this.$freezeLineH.remove(),n&&(l&&(isNaN(n=e.calcWidthCols(-1,l))||0===n||0<n&&r.show&&n===r.width||(this.$freezeLine=t(["<div class='pqg-vert-frozen-line'  style = 'left:",n-1,"px;' ></div>"].join("")).appendTo(o))),i&&(e=e.$tbl))&&(e=e.children("tbody").children(".pq-last-frozen-row")[0])&&(this.$freezeLineH=t("<div class='pqg-horiz-frozen-line' style='top:"+(e.offsetTop+e.offsetHeight-1-1)+"px;' ></div>").appendTo(o))},e.setScrollVNumEles=function(e){var i=this.that;e=i.vscroll;var r=i.options;if(!r.maxHeight&&"flex"===r.height)return e.option("num_eles",0),0;var o,r=!!i.iHierarchy,n=parseInt(e.option("num_eles")),l=parseInt(e.option("cur_pos")),n=this.getEContHt(),a=i.pdata?i.totalVisibleRows:0,s=0;if(i.$tbl&&0<i.$tbl.length&&(s=(o=i.$tbl[i.$tbl.length-1]).scrollHeight,o=t(o)),0<s){for(s=1,o=o.children().children("tr"),l=i=0;s<o.length;s++){var d=o[s],i=i+d.offsetHeight;if(i>=n){r&&t(d).hasClass("pq-detail-child")&&(l=1<l?l-1:1);break}r?!1===t(d).hasClass("pq-detail-child")&&l++:l++}n=a-l+1}else n=l+1;return n>a&&(n=a),e.option("num_eles",n),n},e._setScrollVLength=function(t){var e=(t=this.that).options;if("flex"!==e.height||e.maxHeight){var e=this.getSBHeight(),i=this.contHt-e+this.headerHt-2;t.vscroll.widget().css("bottom",e),t.vscroll.option("length",i)}},e.setHeaderHeight=function(){var e,i,r,o=this.that,n=o.$header;if(n&&n.length){if(1<n.length){if(r=Math.max(e=n[0].scrollHeight,i=n[1].scrollHeight),e!==i){var l=t(n[0]).find(".pq-grid-header-search-row"),a=t(n[1]).find(".pq-grid-header-search-row");l.length&&(l.css("height",""),a.css("height",""),r=Math.max(e=n[0].scrollHeight,i=n[1].scrollHeight),e<r?l.height(a[0].scrollHeight):a.height(l[0].scrollHeight))}}else r=e=n[0].scrollHeight;o.$header_o.height(r-3),this.headerHt=r-1}else o.$header_o.height(0),this.headerHt=0},e.initContHeight=function(){var t=this.that,e=t.options;("flex"!=e.height||e.maxHeight)&&(this.contHt=this.height-(e.showHeader?this.rowHt:0)-(e.showTop?t.$top[0].offsetHeight:0)-(e.showBottom?t.$bottom[0].offsetHeight:0))},e.initContWidth=function(){this.contWd=this.width},e.setContHeight=function(t){var e,i=(t=this.that).$top,r=this.height-t.$header_o[0].offsetHeight;if(t.options.showTop){e=i[0].offsetHeight;var o=parseInt;i=i[0],e+=o(i=window.getComputedStyle?getComputedStyle(i).marginTop:"auto"==(i=i.currentStyle.marginTop)?0:i)}else e=0;r=0<=(r=r-e-t.$bottom[0].offsetHeight+1)?r:"",t.$cont.height(r),this.contHt=r},e.setContAndGridHeightForFlex=function(){var t=this.that,e=t.hscroll.widget();if(this.vscroll)e.css("position","");else{e.css("position","relative");var e=t.$cont,i=t.options.cls,r=e.children("."+i.cont_inner_b);e.height(""),r.length||(r=e.children("."+i.cont_inner)),r.height(""),t.element.height(""),t.$grid_center.height("")}},e.setContAndGridWidthForFlex=function(){var t=this.that,e=t.options.maxWidth,i=this.maxWidthPixel,r=t.calcWidthCols(-1,t.colModel.length),t=t.element,r=r+this.getSBWidth();e&&r>=i&&(r=i),this.contWd=r,t.width(r+"px")},e.getTotalVisibleRows=function(t,e,i){var r=this.that,o=this.vrows,n=this.estRowsInViewPort(),l=0,a=i?i.length:0,s=e,d=0,h=0,c=null,u=!!r.iHierarchy,r=r.options.detailModel.offset,p=0,f=this.rowHt,g=u?this.contHt:void 0;if(null==i||0==a)return{initV:null,finalV:null,tvRows:l,lastFrozenRow:null};for(var v=0,w=a>e?e:a;v<w;v++){var m=i[v],x=m.pq_hidden;x||(c=v,l++,u&&((m=m.pq_detail)&&m.show?((m=m.height||0)>r&&(m=r),p+=m+f):p+=f))}if(a<e)return{initV:c,finalV:c,tvRows:l,lastFrozenRow:c};for(n-=l,s=d=o[t],h=0,v=s,w=a;v<w;v++){if(x=(m=i[v]).pq_hidden)d++;else if(h===n)break;else d++,h++;if(u&&!x&&((m=m.pq_detail)&&m.show?((m=m.height||0)>r&&(m=r),p+=m+f):p+=f,p>g))break}return l+=o.length,{initV:s=s>=a?a-1:s,finalV:(d=d>=a?a-1:d)<s?s:d,tvRows:l,lastFrozenRow:c}},e.setInitH=function(t,e){var i=this.that;i.initH=t,i.finalH=e},e.setInitV=function(t,e){var i,r=this.that;(null==t||null==e)&&(i=this.vrows)&&i.length&&(t=e=i[i.length-1]),r.initV=t,r.finalV=e},e.calcVisibleV=function(){for(var t=this.that,e=t.pdata||[],i=e.length,r=[],o=0,t=t.options.freezeRows;t<i;t++)e[t].pq_hidden||(r[o++]=t);this.vrows=r},e.calcVisibleH=function(){for(var t=this.that,e=[],i=0,r=t.colModel,t=t.options.freezeCols,o=r.length;t<o;t++)r[t].hidden||(e[i++]=t);this.vcols=e},e.calcInitFinal=function(){var t=this.that,e=t.options,i=e.virtualY,r=e.freezeRows,o="flex"===e.height,n=t.pdata;if(null==n||0===n.length)r=this.getTotalVisibleRows(l,r,n),t.totalVisibleRows=r.tvRows,i=r.initV,e=r.finalV,t.lastFrozenRow=r.lastFrozenRow;else if(i){var l=parseInt(t.vscroll.option("cur_pos"));if(isNaN(l)||0>l)throw"cur_pos NA";t.scrollCurPos=l,r=this.getTotalVisibleRows(l,r,n),t.totalVisibleRows=r.tvRows,i=r.initV,t.lastFrozenRow=r.lastFrozenRow,e=o&&!e.maxHeight?n.length-1:r.finalV}else r=this.getTotalVisibleRows(0,r,n),t.lastFrozenRow=r.lastFrozenRow,t.totalVisibleRows=r.tvRows,i=0,e=n.length-1;this.setInitV(i,e)},e.calcInitFinalH=function(){var t,e=this.that,i=e.options,r=e.colModel,o=r.length;if(i.virtualX){t=parseInt(e.hscroll.option("cur_pos"));var n=parseInt(i.freezeCols),l="flex"===i.width,a=this.vcols;if(a||(this.calcVisibleH(),a=this.vcols),(t=a[t])>o-1&&(t=o-1),0>t&&(t=0),l&&!i.maxWidth)i=o-1;else{for(e=e.calcWidthCols(-1,n),n=this.getEContWd(),l=t;l<o;l++)if(!(a=r[l]).hidden){if(!(a=a.outerWidth)&&i.debug)throw"outerwidth N/A";if((e+=a)>n)break}(i=l)>o-1&&(i=o-1)}}else t=0,i=o-1;this.setInitH(t,i)},e._calcOffset=function(t){return(t=/(-|\+)([0-9]+)/.exec(t))&&3===t.length?parseInt(t[1]+t[2]):0},e.setMax=function(t){var e=this.that,i=e.element;(e=e.options[t])?(e==parseInt(e)&&(e+="px"),i.css(t,e)):i.css(t,"")},e.refreshGridWidthAndHeight=function(){var e,i,r=this.that,o=r.options,n=-1<(o.width+"").indexOf("%"),l=-1<(o.height+"").indexOf("%"),a=-1<(o.maxHeight+"").indexOf("%"),s="flex"==o.height,d=a&&s,h=-1<(o.maxWidth+"").indexOf("%"),c="flex"==o.width,u=h&&c,r=r.element;if(n||l||d||u){var p,f=r.parent();if(!f.length)return;f[0]==document.body||"fixed"==r.css("position")?(p=t(window).width(),f=window.innerHeight?window.innerHeight:t(window).height()):(p=f.width(),f=f.height());var g=this._calcOffset,v=n?g(o.width):0,g=l?g(o.height):0;u?e=parseInt(o.maxWidth)*p/100:n&&(e=parseInt(o.width)*p/100+v),d?i=parseInt(o.maxHeight)*f/100:l&&(i=parseInt(o.height)*f/100+g)}e||(c&&o.maxWidth?h||(e=o.maxWidth):n||(e=o.width)),o.maxWidth&&(this.maxWidthPixel=e),i||(s&&o.maxHeight?a||(i=o.maxHeight):l||(i=o.height)),parseFloat(e)==e?(e=e<o.minWidth?o.minWidth:e,r.css("width",e)):"auto"===e&&r.width(e),parseFloat(i)==i&&(i=i<o.minHeight?o.minHeight:i,r.css("height",i)),this.width=Math.round(r.width()),this.height=Math.round(r.height())},e.decidePanes=function(){var t=this.that,e=t.pqpanes={v:!1,h:!1,vH:!1},i=t.options,t=i.virtualX,r=i.virtualY,o="flex"==i.height&&!i.maxHeight,n="flex"==i.width&&!i.maxWidth,l=i.numberCell,a=i.freezeRows,i=i.freezeCols;a&&!o&&(i||l.show)&&!n?(r||(e.h=!0),t||(e.v=!0,e.vH=!0)):a&&!o?r||(e.h=!0):!i&&!l.show||n||t||(e.v=!0,e.vH=!0)},e._storeColumnWidths=function(t){for(var e=this.that,i=e.options,r=e.colModel,o=i.virtualX,i=i.freezeCols,n=e.initH,e=t?r.length-1:e.finalH,l=[],a=0;a<=e;a++)!t&&o&&a<n&&a>=i&&(a=n),l[a]={outerWidth:r[a].outerWidth};return l},e._isColumnWidthChanged=function(t){for(var e=this.that,i=e.colModel,e=e.iGenerateView.colDef,r=0,o=e.length;r<o;r++){var n=e[r].colIndx;if(i[n].outerWidth!==t[n].outerWidth)return!0}return!1},e.softRefresh=function(){var t=this.that,e=t.options;this.refreshScrollbars(),t.iGenerateView.setPanes(),t._saveDims(),t.iMouseSelection.syncScrollBarVert(),"flex"==e.height&&this.setContAndGridHeightForFlex(),"flex"==e.width&&this.setContAndGridWidthForFlex(),this._refreshFrozenLine()},e.refreshScrollbars=function(t){t=t||{};var e,i=this.that,r=i.options,o=i.iGenerateView,n="flex"===r.height;e="flex"===r.width,(n||this.contHt)&&(e||this.contWd)&&null!==i.totalVisibleRows&&(i=1<(i=this.setScrollVNumEles(t)),(!n||r.maxHeight)&&i!==this.vscroll&&((this.vscroll=i,r.scrollModel.autoFit||r.virtualX||e)?(r=this._storeColumnWidths(),this.refreshColumnWidths(),(this._isColumnWidthChanged(r)||e)&&(this.ignoreTResize=!0,this._refreshTableWidths(r,{table:!0,header:!0}),delete this.ignoreTResize,this.setHeaderHeight(),this.setContHeight(),o.setPanes(),i=this.setScrollVNumEles(!0),this.vscroll=1<i)):o.setPanes()),e=1<(i=this.setScrollHNumEles()),this.hscroll!=e&&(this.hscroll=e,o.setPanes()),this._setScrollHLength(),this._setScrollVLength(t),this._setScrollHVLength())},e._setScrollHVLength=function(){var t=this.that;this.vscroll&&this.hscroll||t.$hvscroll.css("visibility","hidden")},e._setScrollHLength=function(){var t=this.that,e=t.hscroll.widget(),i=t.$hvscroll;if(t.options.scrollModel.horizontal){e.css("visibility",""),i.css("visibility","");var i=this.contWd,r=this.getSBWidth();e.css("right",0===r?0:""),t.hscroll.option("length",i-r)}else e.css("visibility","hidden"),i.css("visibility","hidden")},e.estVscroll=function(){var t=this.that,e=!0;null==t.totalVisibleRows||null==this.contHt?e=!1:t.totalVisibleRows*this.rowHt<this.contHt&&(e=!1),this.vscroll=e},e.getSBWidth=function(){return null==this.vscroll&&this.estVscroll(),this.vscroll?17:0},e.estHscroll=function(){var t=this.that;if(null==this.contWd)throw"failed";var e=!1;1<this.calcColsOutsideCont(t.colModel)+1&&(e=!0),this.hscroll=e},e.getSBHeight=function(){return null==this.hscroll&&this.estHscroll(),this.hscroll?17:0},e.getEContHt=function(){if(null==this.contHt)throw"contHt N/A";return this.contHt-this.getSBHeight()},e.getEContWd=function(){if(null==this.contWd)throw"contWd N/A";return this.contWd-this.getSBWidth()},e.calcColsOutsideCont=function(t){var e=this.that.options,i=e.numberCell,e=e.freezeCols,r=this.contWd-this.getSBWidth(),o=0;for(i.show&&(o+=i.outerWidth),i=0;i<t.length;i++){var n=t[i];n.hidden||(o+=n.outerWidth)}var l=0,a=0,n=Math.round(o);for(n>r&&a++,i=e;i<t.length;i++)if(!(n=t[i]).hidden){if(l+=n.outerWidth,(n=o-l)>r)a++;else break}return a},e.setScrollHNumEles=function(){var t=this.that,e=t.options,i=t.colModel,r=e.scrollModel,o=0;return("flex"!==e.width||e.maxWidth)&&(o="fullScroll"===r.lastColumn?i.length-e.freezeCols-t._calcNumHiddenUnFrozens():this.calcColsOutsideCont(i)+1),t.hscroll.option("num_eles",o),o},e.init=function(){var t=this.that,e=t.options;this.hscroll=this.vscroll=this.contHt=this.contWd=null,t.initH=t.initV=t.finalH=t.finalV=null,t.totalVisibleRows=t.lastFrozenRow=null,this.rowHt=e.rowHeight,this.headerHt=0,this.height=null},e.refresh=function(t){t=t||{};var e,i=this.that,r=t.header,o=t.table,n=t.pager,l=i.iGenerateView;if((e=i.element)[0].offsetWidth){if(t.toolbar&&i.refreshToolbar(),i.iMouseSelection.resetMargins(),this.init(),e=i.options,this.decidePanes(),e.collapsible._collapsed=!1,this.setMax("maxHeight"),this.setMax("maxWidth"),this.refreshGridWidthAndHeight(),this.initContHeight(),this.initContWidth(),this.calcInitFinal(),!1===r||!1===o)var a=this._storeColumnWidths(!0);this.refreshColumnWidths(),this.calcInitFinalH(),l.createColDefs(),!1!==r?i._createHeader():this._isColumnWidthChanged(a)&&this._refreshTableWidths(a,{header:!0}),i._refreshHeaderSortIcons(),!1!==n&&i._refreshPager(),this.setHeaderHeight(),this.setContHeight(),!1!==o?l.generateView({source:t.source}):(this._refreshTableWidths(a,{table:!0}),l.setPanes()),i._saveDims(),l.scrollView(),this.refreshScrollbars(),"flex"==e.height&&this.setContAndGridHeightForFlex(),"flex"==e.width&&this.setContAndGridWidthForFlex(),this._refreshFrozenLine(),i._createCollapse(),e.dataModel.postDataOnce=void 0}else e.addClass("pq-pending-refresh")},e.summaryTable=function(){var e=this.$summary,i=this.that,r=i.options.summaryData;r?(e||(e=this.$summary=t("<div class='pq-grid-summary'></div>").prependTo(i.$bottom)),e={data:r,$cont:e},i.createTable(e)):e&&e[0].innerHTML&&e.empty()},e.refreshVscroll=function(t){var e=(t=this.that).iGenerateView,i=t.options;if(i.virtualY&&!i.scrollModel.smooth){var r=t.initV,o=t.finalV;this.calcInitFinal();var n=r-t.initV,l=o-t.finalV;i.fullrefreshOnScroll||i.detailModel.init||t._mergeCells||1!=Math.abs(n)||1!=Math.abs(l)?r==t.initV&&o==t.finalV||e.generateView():-1==n?(e.removeTopRow(1),e.appendRow(t.finalV-o)):1==n&&(e.prependRow(),e.removeBottomRow(o-t.finalV)),t._saveDims(),e.scrollView(),1>=this.setScrollVNumEles()&&this.refreshScrollbars()}},e._refreshTableWidths=function(t,e){var i,r=this.that,o=r.$tbl_header,n=e.header&&o,l=r.$tbl,a=e.table&&l,o=n?o.children().children(".pq-row-hidden"):null,s=n?r.$header.find(".pq-grid-col-resize-handle"):null,l=a&&l?l.children().children(".pq-row-hidden"):null,d=!1,h=0;a&&r.tables.length&&(a=r.tables[0].$tbl.children().children(".pq-row-hidden"),l=l?l.add(a):a);for(var a=r.iGenerateView.colDef,c=0,u=a.length;c<u;c++){var p=a[c],f=p.colIndx,g=t[f].outerWidth,p=p.column.outerWidth;p!==g&&(n&&(i=o.find("td[pq-col-indx="+f+"]")).width(p),l&&(i=l.find("td[pq-col-indx="+f+"]")).length&&(d=!0,i.width(p))),h+=p-g,n&&0!==h&&(g=parseInt((f=s.filter("[pq-col-indx="+f+"]")).css("left")),f.css("left",g+h))}d&&r._trigger("tableWidthChange"),r._saveDims()}}(jQuery),function(t){function e(t,e,i){for(var r=0,o=t.length;r<o;r++){for(var n=t[r],l={},a=0,s=e.length;a<s;a++){var d=e[a];l[d]=n[d]}i.push(l)}}function i(t){var e=this;e.that=t,e.findformulas(),t.on("columnChange",function(){e.findformulas()}).on("dataAvailable",function(){e._onDA()}).on(!0,"change",function(t,i){e._onchange(i)}).on("dataReady changeDone",function(){e.summaryData()})}var r=t.paramquery,o=r.cClass,n={options:{flex:{on:!0,one:!1,all:!0},detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se glyphicon glyphicon-minus",collapseIcon:"ui-icon-triangle-1-e glyphicon glyphicon-plus"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check glyphicon-ok",rejectIcon:"ui-icon-closethick glyphicon-remove",topIcon:"ui-icon-circle-arrow-s glyphicon glyphicon-circle-arrow-down",bottomIcon:"ui-icon-circle-arrow-n glyphicon glyphicon-circle-arrow-up"},track:null,mergeModel:{flex:!1},realFocus:!0,sortModel:{on:!0,type:"local",multiKey:"shiftKey",number:!0,single:!0,cancel:!0,sorter:[],useCache:!0,ignoreCase:!1},filterModel:{on:!0,type:"local",mode:"AND",header:!1}},_create:function(){var t=this,e=t.options;t.listeners={},t._queueATriggers={},t.iHistory=new r.cHistory(t),t.iGroupView=new r.cGroupView(t),r.cMerge&&(t.iMerge=new r.cMerge(t)),t.iFilterData=new r.cFilterData(t),t.iSelection=new l.Selection(t),t.iHeaderSearch=new a(t),t.iUCData=new r.cUCData(t),t.iMouseSelection=new r.cMouseSelection(t),t._super(),new i(t),t.iDragColumns=new r.cDragColumns(t),t.refreshToolbar(),"remote"===e.dataModel.location&&t.refresh({table:!0}),t.on("dataAvailable",function(){t.one("refreshDone",function(){t._trigger("ready"),setTimeout(function(){t.element&&t._trigger("complete")},0)})}),t.__init(),t.refreshDataAndView({header:!0})}};n.__init=function(){},t.widget("paramquery.pqGrid",r._pqGrid,n),t.widget.extend=function(){var e,i=Array.prototype.shift,r=t.isPlainObject,o=t.isArray,n=t.widget.extend,l=i.apply(arguments);"boolean"==typeof l&&(e=l,l=i.apply(arguments));var a,s,d,h=arguments,c=0,u=h.length;for(null==e&&(e=1<u);c<u;c++)for(s in a=h[c])void 0!==(d=a[s])&&(i=!(0<c),r(d)?(l[s]=l[s]||{},n(i,l[s],d)):o(d)?l[s]=e&&i?d.slice():d:l[s]=d);return l};var l=window.pq=window.pq||{};l.grid=function(e,i){var r=t(e).pqGrid(i);return r.data("paramqueryPqGrid")||r.data("paramquery-pqGrid")},r.pqGrid.regional={},n=r.pqGrid.prototype,r.pqGrid.defaults=n.options,n.focus=function(t){var e,i=(t=t||{}).$td,r=t.rowIndxPage;if(t=t.colIndx,i)(null==r||null==t)&&(r=(t=this.getCellIndices({$td:i})).rowIndxPage,t=t.colIndx);else{if(null==r||null==t){if((r=document.activeElement)&&r!=document.body&&"pq-grid-excel"!=r.id&&"pq-grid-cont"!=r.className||!(i=this._focusElement))return;r=i.rowIndxPage,t=i.colIndx}var i=this.iMerge,o=r+this.rowIndxOffset;i.ismergedCell(o,t)&&(r=(i=i.getRootCell(o,t,"o")).rowIndxPage,t=i.colIndx),i=this.getCell({rowIndxPage:r,colIndx:t})}this.options.realFocus?(this._focusElement={$ele:i,rowIndxPage:r,colIndx:t},i[0]&&(e=i[0])&&"TD"==e.nodeName.toUpperCase()?(e.setAttribute("tabindex",0),e.focus()):(r=this.options.dataModel.data)&&r.length||this.$cont.focus()):((e=this._focusElement)&&(this.removeClass({rowIndxPage:e.rowIndxPage,colIndx:e.colIndx,cls:"pq-focus",refresh:!1}),this.element.find(".pq-focus").removeClass("pq-focus")),i&&(this.addClass({rowIndxPage:r,colIndx:t,cls:"pq-focus"}),this._focusElement={$ele:i,rowIndxPage:r,colIndx:t}),r=this.$cont,document.activeElement!=r[0]&&r[0].focus())},n.onfocus=function(){if(!this.options.realFocus){var t=this._focusElement;t&&this.addClass({rowIndxPage:t.rowIndxPage,colIndx:t.colIndx,cls:"pq-focus"})}},n.onblur=function(){if(!this.options.realFocus){var t=this._focusElement;t&&this.removeClass({rowIndxPage:t.rowIndxPage,colIndx:t.colIndx,cls:"pq-focus"})}},n.range=function(t,e){return new l.Range(this,t,"range",e)},n.rowExpand=function(t){this.iHierarchy.rowExpand(t)},n.rowInvalidate=function(t){this.iHierarchy.rowInvalidate(t)},n.rowCollapse=function(t){this.iHierarchy.rowCollapse(t)},n.saveState=function(e){e=e||{};var i,r,o=this.element,n=t.extend,l=this.options,a=n(!0,{},{sorter:l.sortModel.sorter}),s=l.pageModel,s={rPP:s.rPP,curPage:s.curPage},d=this.colModel,h=[],c=0,u=d.length;for(n=n(!0,{},{dataIndx:(r=l.groupModel).dataIndx,dir:r.dir,collapsed:r.collapsed,merge:r.merge,grandSummary:r.grandSummary}),o=o[0].id;c<u;c++)r={width:(i=d[c]).width,dataIndx:i.dataIndx},(i=i.filter)&&(r.filter={value:i.value,value2:i.value2,on:i.on}),h[c]=r;return l={colModel:h,height:l.height,datestamp:Date.now(),width:l.width,groupModel:n,pageModel:s,sortModel:a,freezeRows:l.freezeRows,freezeCols:l.freezeCols},!1!==e.stringify&&(l=JSON.stringify(l),!1!==e.save&&"undefined"!=typeof Storage&&localStorage.setItem("pq-grid"+(o||""),l)),l},n.loadState=function(e){e=e||{},o=t.widget.extend;var i=t.extend,r=this.element[0].id;if(!(r=e.state||("undefined"==typeof Storage?void 0:localStorage.getItem("pq-grid"+(r||"")))))return!1;"string"==typeof r&&(r=JSON.parse(r));for(var o,n,l,a=r.colModel,s=[],d=[],h=[],c=this.options,u=1<this.depth,p=u?this.colModel:c.colModel,f=0,g=a.length;f<g;f++)d[l=(n=a[f]).dataIndx]=f,s[l]=n.width,h[l]=n.filter;for(u||p.sort(function(t,e){return d[t.dataIndx]-d[e.dataIndx]}),f=0,g=p.length;f<g;f++)l=(a=p[f]).dataIndx,a.width=s[l]||a.width,a.filter=i(a.filter,h[l]);return this.iColModel.init(),o(c.sortModel,r.sortModel),o(c.pageModel,r.pageModel),(o=r.groupModel).refresh=!1,this.groupOption(o),o={freezeRows:r.freezeRows,freezeCols:r.freezeCols},isNaN(1*c.height)||isNaN(1*r.height)||(o.height=r.height),isNaN(1*c.width)||isNaN(1*r.width)||(o.width=r.width),this.option(o),!1!==e.refresh&&this.refreshDataAndView(),!0};var a=function(e){function i(t,i,r){e.filter({data:[{dataIndx:t,value:i,value2:r}]})}this.that=e;var r=this;this.dataHS={},e.on("headerKeyDown",function(e,i){var o=t(e.originalEvent.target);return!o.hasClass("pq-grid-hd-search-field")||r.onKeyDown(e,i,o)}),e.on("createHeader",function(t,e){return r._onCreateHeader()}),this.changeListener={change:function(t,e){i(e.dataIndx,e.value,e.value2)}},this.keyupListener={keyup:function(t,e){i(e.dataIndx,e.value,e.value2)}},this.clickListener={click:function(t,e){i(e.dataIndx,e.value)}}},o=a.prototype=new o;o.get$Ele=function(e,i){var r=this.that,o=r.options.freezeCols,n=t(r.$tbl_header[0]),l=".pq-grid-hd-search-field[name='"+i+"']",r=t(r.$tbl_header[2==r.$tbl_header.length?1:0]);return e>=o?r.find(l):n.find(l)},o.onKeyDown=function(e,i,r){if(i=this.that,e.keyCode!==t.ui.keyCode.TAB)return!0;var o,n=r.attr("name"),l=i.getColIndx({dataIndx:n}),a=i.colModel,s=e.shiftKey,d=a[l];if("between"==d.filter.condition&&(i.scrollColumn({colIndx:l}),(n=this.get$Ele(l,n))[0]==r[0]?s||(o=n[1]):s&&(o=n[0]),o))return o.focus(),e.preventDefault(),!1;for(;s?l--:l++,!(0>l)&&!(l>=a.length);)if(r=(d=a[l]).filter,!d.hidden&&r){if(i.scrollColumn({colIndx:l}),n=d.dataIndx,o=this.get$Ele(l,n),"between"==r.condition&&(o=s?t(o[1]):t(o[0])),o)return o.focus(),e.preventDefault(),!1;break}},o._bindFocus=function(){function e(e){if(e=t(e.target).closest(".pq-grid-hd-search-field").attr("name"),i.scrollColumn({dataIndx:e})){var o=i.getColIndx({dataIndx:e});r.get$Ele(o,e).focus()}}for(var i=this.that,r=this,o=i.$header.find(".pq-grid-header-search-row"),n=0;n<o.length;n++)t(o[n]).on("focusin",e)},o._onCreateHeader=function(){var e=this.that,i=e.options;if(i.filterModel.header){this._bindFocus();var r=e.colModel,i=i.freezeCols,o=e.$tbl_header,n=t(o[0]),l=t(o[1]),a="input,select";if(1<o.length){n.find(a).css("visibility","hidden");for(var s=0;s<i;s++){var d=r[s],a="*[name='"+d.dataIndx+"']";n.find(a).css("visibility","visible"),l.find(a).css("visibility","hidden")}}for(r=e.iGenerateView.colDef,s=0,a=r.length;s<a;s++){var h=r[s],c=h.colIndx,d=h.column,u=d.filter;if(u){var h=d.dataIndx,p=n;if(c>=i&&1<o.length&&(p=l),0!=(c=p.find("*[name='"+h+"']")).length){var p=u.type,f=u.value,g=u.value2;if("checkbox"==p&&"triple"==u.subtype?c.pqval({val:f}):"select"==p&&null!=f&&c.val(f),(p=u.init)&&p.call(c,{dataIndx:h,column:d}),d=u.listeners)for(u=0;u<d.length;u++)for(var v in"string"==typeof(p=d[u])&&(p=this[p+"Listener"]),p)!function(i,r,o){i.bind(v,function(n){var l=e.getColumn({dataIndx:o}),a=l.filter;return"checkbox"==a.type?f="triple"==a.subtype?i.pqval({incr:!0}):!!i.is(":checked"):"between"==a.condition?(f=t(i[0]).val(),g=t(i[1]).val()):f=i.val(),r.call(this,n,{column:l,dataIndx:o,value:f,value2:g})})}(c,p[v],h)}}}}};var s=function(t,e){return["<div class='pq-from-div'>",t,"</div><span class='pq-from-to-center'>-</span><div class='pq-to-div'>",e,"</div>"].join("")};o.createDOM=function(t,e){var i=this.that,o=i.options,n=o.bootstrap.on?" ":" ui-corner-all",o=o.numberCell;t.push("<tr class='pq-grid-header-search-row'>"),o.show&&t.push("<td pq-col-indx='-1' class='pq-grid-number-col' rowspan='1'><div class='pq-td-div'>&nbsp;</div></td>");for(var o=i.iGenerateView.colDef,l=0,a=o.length;l<a;l++){var d=o[l].column,h=e,c=d.halign;if(c||(c=d.align),"right"==c?h+=" pq-align-right":"center"==c&&(h+=" pq-align-center"),(c=d.cls)&&(h=h+" "+c),c=d.filter){var u=d.dataIndx,p=c.type,f=c.value,g=c.condition,v=c.cls,v="pq-grid-hd-search-field "+(v||""),w=c.style,w=w||"",m=c.attr,m=m||"",x="";if("between"==g)var $=c.value2,$=null!=$?$:"";"textbox"===p?(f=f||"",v=v+" pq-search-txt"+n,x="between"==g?s(this._input(u,f,v+" pq-from",w,m),this._input(u,$,v+" pq-to",w,m)):this._input(u,f,v,w,m)):"textarea"===p?(f=f||"",v=v+" pq-search-txt"+n,x="between"==g?s(this._textarea(u,f,v+" pq-from",w,m),this._textarea(u,$,v+" pq-to",w,m)):this._textarea(u,f,v,w,m)):"select"===p?c.cache?x=c.cache:("function"==typeof(p=c.options)&&(p=p.call(i,{column:d,value:f,dataIndx:u,cls:v,style:w,attr:m})),v+=n,d=["name='",u,"' class='",v,"' style='",w,"' ",m].join(""),x=r.select({options:p,attr:d,prepend:c.prepend,valueIndx:c.valueIndx,labelIndx:c.labelIndx,groupIndx:c.groupIndx}),c.cache=x):"checkbox"==p?x=["<input ",null==f||!1==f?"":"checked=checked"," name='",u,"' type=checkbox class='"+v+"' style='"+w+"' "+m+"/>"].join(""):"string"==typeof p?x=p:"function"==typeof p&&(x=p.call(i,{width:d.outerWidth,value:f,value2:$,column:d,dataIndx:u,cls:v,attr:m,style:w})),t.push(["<td class='",h,"'><div class='pq-td-div' >",x,"</div></td>"].join(""))}else t.push(["<td class='",h,"'><div class='pq-td-div' >&nbsp;</div></td>"].join(""))}t.push("</tr>")},o._input=function(t,e,i,r,o){return['<input value="',e,"\" name='",t,"' type=text style='"+r+"' class='"+i+"' "+o+" />"].join("")},o._textarea=function(t,e,i,r,o){return["<textarea name='",t,"' style='"+r+"' class='"+i+"' "+o+" >",e,"</textarea>"].join("")},n.refreshToolbar=function(){var e,i=this.options,r=i.toolbar;if(this._toolbar&&(e=this._toolbar).destroy(),r){var o=r.cls,n=r.style,a=r.attr,r=r.items,o=t("<div class='"+(o||"")+"' style='"+(n||"")+"' "+(a||"")+" ></div>");e?e.widget().replaceWith(o):this.$top.append(o),e=l.toolbar(o,{items:r,gridInstance:this,bootstrap:i.bootstrap}),i.showToolbar||o.css("display","none"),this._toolbar=e}},n.isLeftOrRight=function(t){return t>this.freezeCols?"right":"left"},n.ovCreateHeader=function(t,e){this.options.filterModel.header&&this.iHeaderSearch.createDOM(t,e)},n.filter=function(e){var i=this,r=this.options,o=void 0===e.apply||e.apply,n=void 0===e.sort||e.sort,l=r.dataModel,r=r.filterModel;if(void 0!=e){var a="replace"==e.oper;e=e.data;for(var s=this.colModel,s=o?s:t.extend(!0,[],s),d=0,h=s.length,c=e.length,u=0;u<h;u++){for(var p=s[u],f=!1,g=0;g<c&&d!=c;g++){var v=e[g];if(v.dataIndx==p.dataIndx){f=!0,d++;var g=p.filter,w=v.condition,m=v.value;if(g?g.on=!0:g=p.filter={on:!0},w&&(g.condition=w),w=g.condition,g.value=m,"between"==w)g.value2=v.value2;else if("range"==w){if(v=[],m){if("string"==typeof m){var w=g.options,x=m.indexOf('"'),$=m.lastIndexOf('"'),m=m.substr(x,$+1),m=JSON.parse("["+m+"]");if(w)for(x=0,$=w.length;x<$;x++){var _=w[x];-1!=t.inArray(_,m)&&v.push(_)}else v=m.split(",s*")}else"function"==typeof m.push&&(v=m)}g.value=v}break}}a&&!f&&p.filter&&(p.filter.on=!1)}}var I={header:!1,apply:o,sort:n,CM:s};if("remote"!=l.location||"local"==r.type)return I.source="filter",I.trigger=!1,i._onDataAvailable(I);this.remoteRequest({apply:o,CM:s,callback:function(){return i._onDataAvailable(I)}})},n._initTypeColumns=function(){for(var t=this.colModel,e=0,i=t.length;e<i;e++){var o=t[e],n=o.type;"checkBoxSelection"===n||"checkbox"==n?(o.type="checkbox",new r.cCheckBoxColumn(this,o)):"detail"===n&&(o.dataIndx="pq_detail",this.iHierarchy=new r.cHierarchy(this,o))}},n.refreshHeader=function(){this._createHeader(),this.iGenerateView.setPanes(),this._refreshHeaderSortIcons()},n._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()},n.getLargestRowCol=function(t){for(var e=0;e<t.length;e++);},n.bringCellToView=function(t){this._bringCellToView(t)},n._setUrl=function(t){this.options.dataModel.getUrl=function(){return{url:this.url+(null!=t?t:"")}}},n.pageData=function(){return this.pdata},n.getData=function(t){var i=(t=t||{}).dataIndx,r=i?i.length:0,o=t.data,n=(t=this.options.dataModel).data,l=t.dataUF;if(t=[],!r)return n.concat(l||[]);for(o?e(o,i,t):(n&&e(n,i,t),l&&e(l,i,t)),n=0,o=[];n<r;n++){var l=i[n],a=this.getColumn({dataIndx:l});o.push({dataIndx:l,dir:"up",dataType:a.dataType,sortType:a.sortType})}for(t=this.iSort._sortLocalData(o,t),i=[],r=void 0,o=0,n=t.length;o<n;o++)(a=JSON.stringify(l=t[o]))!==r&&(i.push(l),r=a);return i},n.get_p_data=function(){var t=this.options,e="remote"==t.pageModel.type,i=t.dataModel.data,r=this.pdata,o=this.rowIndxOffset,t=t.groupModel,n=o&&e?Array(o):[];return t.on&&t.dataIndx.length?o?(e||(n=i.slice(0,o)),n.concat(r)):r:o&&e?n.concat(r):i},n._onDataAvailable=function(t){t=t||{};var e=this.options,i=null==t.apply||t.apply,r=t.source,o=t.sort,n=[],n=e.filterModel,l=e.dataModel,e=e.sortModel,a=l.location;if(!1!==i&&!1!==t.trigger&&this._trigger("dataAvailable",t.evt,{source:r}),n=n&&n.on&&("local"==a&&"remote"!=n.type||"remote"==a&&"local"==n.type)?this.iFilterData.filterLocalData(t).data:l.data,"local"==e.type&&!1!==o&&(i?this.sort({refresh:!1}):n=this.iSort.sortLocalData(n)),!1===i)return n;l.data=n,this.refreshView(t)},n.sort=function(t){t=t||{};var e=this,i=this.options,r=i.dataModel.data,o=i.sortModel.type;if(r&&r.length||"local"!=o){var n,l=i.editModel,i=this.iSort,a=i.getSorter(),s=t.evt,d=null==t.single?i.readSingle():t.single;n=i.readCancel(),t.sorter?t.addon?(t.single=d,t.cancel=n,n=i.refreshSorter(t)):n=t.sorter:n=i.readSorter(),(n.length||a.length)&&(l.indices&&e.blurEditor({force:!0}),l={dataIndx:n.length?n[0].dataIndx:null,oldSorter:a,sorter:n,source:t.source,single:d},!1===e._trigger("beforeSort",s,l)?i.cancelSort():(i.resumeSort(),"local"==o&&i.saveOrder(),i.setSorter(n),i.setSingle(d),i.writeSorter(n),i.writeSingle(d),"local"==o?(i.sortLocalData(r),this._queueATriggers.sort={evt:s,ui:l},!1!==t.refresh&&this.refreshView()):"remote"==o&&(this._queueATriggers.sort={evt:s,ui:l},t.initByRemote||this.remoteRequest({initBySort:!0,callback:function(){e._onDataAvailable()}}))))}},n.reset=function(e){var i,r,o=(e=e||{}).sort,n=0;i=this.options,r=t.extend;var l,a=e.filter,s=e.group;if(o||a||s){if(o&&(l=!0===o?{sorter:[]}:o,r(i.sortModel,l)),a)for(r=(i=this.getColModel()).length;n<r;n++)(l=i[n].filter)&&(l.value=null,l.value2=null,l.cache=null);s&&((n=!0===s?{dataIndx:[]}:s).refresh=!1,this.groupOption(n)),!1!==e.refresh&&(a?(this.filter({oper:"replace",data:[]}),this.refreshHeader()):o?this.sort():this.refreshView())}},n._trigger=r._trigger,n.on=r.on,n.one=r.one,n.off=r.off,n.pager=function(){return this.pagerW},n.vscrollbar=function(){return this.vscroll},n.hscrollbar=function(){return this.hscroll},n.toolbar=function(){return this._toolbar.element},(o=i.prototype).callRow=function(t,e,i){if(t)for(;i--;){var r=e[i],o=r.column;t[o.dataIndx]=r.formula.call(this.that,{rowData:t,column:o})}},o._onDA=function(){var t=this.formulas.length;if(t)for(var e=this.that.options.dataModel.data,i=e.length,r=this.formulas;i--;)this.callRow(e[i],r,t)},o.summaryData=function(){var t,e,i=this.formulas,r=i.length;if(r)for(e=(t=this.that.options.summaryData||[]).length;e--;)this.callRow(t[e],i,r)},o._onchange=function(t){var e=this.formulas.length;if(e){t=t.rowList;for(var i=this.formulas,r=t.length;r--;)this.callRow(t[r].rowData,i,e)}},o.findformulas=function(){for(var t,e,i=this.that.colModel,r=[],o=i.length;o--;)(e=(t=i[o]).formula)&&r.push({formula:e,column:t});this.formulas=r},(o=(o=r.cColModel=o=function(t){this.that=t,this.init()}).prototype).extend=function(e,i){for(var r,o,n=t.extend,l=e.length;l--;){var a=e[l];for(r in i)void 0===a[r]&&(o=i[r],a[r]=o&&"object"==typeof o?n(!0,{},o):o)}},o.init=function(){var t,e=this.that,i=e.options,r=i.columnTemplate;(t=i.colModel)||(this._autoGenColumns(),t=i.colModel),i=this.nestedCols(t),e.depth=i.depth,t=(i=e.colModel=i.colModel).length,r&&this.extend(i,r),this.getHeadersCells(),this.alignColumns(i,t),this.assignRowSpan(),this._refreshDataIndices(),e._trigger("CMInit")},o.alignColumns=function(t,e){for(var i=0;i<e;i++){var r=t[i];if(!r.align){var o=r.dataType;o&&("integer"==o||"float"==o)&&(r.align="right")}}},o.nestedCols=function(t,e,i,r){var o=t.length,n=[];null==e&&(e=1);for(var l=e,a=0,s=0,d=0,h=0;h<o;h++){var c=t[h];c.parent=r||void 0,!0===i&&(c.hidden=i);var u=c.colModel;u&&u.length?(u=this.nestedCols(u,e+1,c.hidden,c),n=n.concat(u.colModel),0<u.colSpan?(u.depth>l&&(l=u.depth),c.colSpan=u.colSpan,a+=u.colSpan):c.colSpan=0,d+=u.o_colspan,c.o_colspan=u.o_colspan,c.childCount=u.childCount,s+=u.childCount):(c.hidden?c.colSpan=0:(c.colSpan=1,a++),d++,c.o_colspan=1,c.childCount=0,s++,n.push(c))}return{depth:l,colModel:n,colSpan:a,width:0,childCount:s,o_colspan:d}},o.getHeadersCells=function(){for(var t=this.that,e=t.options.colModel,i=t.colModel.length,r=t.depth,o=[],n=0;n<r;n++){o[n]=[];for(var l,a=0,s=0,d=0;d<i;d++){if(0==n)l=e[a];else{var h=o[n-1][d];if((l=h.colModel)&&0!=l.length){for(var h=d-h.leftPos,c=0,u=0,p=0;p<l.length;p++)if(h<(c+=0<l[p].childCount?l[p].childCount:1)){u=p;break}l=l[u]}else l=h}h=l.childCount?l.childCount:1,d==s?(l.leftPos=d,o[n][d]=l,s+=h,e[a+1]&&a++):o[n][d]=o[n][d-1]}}return t.headerCells=o},o.getDataType=function(){var t=this.colModel;if(t&&t[0])return"string"==typeof t[0].dataIndx?"JSON":"ARRAY"},o.assignRowSpan=function(){for(var t=this.that,e=t.colModel.length,i=t.headerCells,t=t.depth,r=0;r<e;r++)for(var o=0;o<t;o++){var n=i[o][r];if(!(0<r&&n==i[o][r-1]||0<o&&n==i[o-1][r])){for(var l=1,a=o+1;a<t;a++)n==i[a][r]&&l++;n.rowSpan=l}}return i},o._autoGenColumns=function(){var e=this.that.options,i=e.columnTemplate||{},r=i.dataType,o=i.title,n=i.width,i=e.dataModel.data,a=l.validation,s=[];i&&i.length&&t.each(i[0],function(t,e){var i="string";a.isInteger(e)?i=-1<e+-1?"float":"integer":a.isDate(e)?i="date":a.isFloat(e)&&(i="float"),s.push({dataType:r||i,dataIndx:t,title:o||t,width:n||100})}),e.colModel=s},o._refreshDataIndices=function(){for(var t=this.that,e="JSON"==this.getDataType(),i={},r={},o={},n=t.colModel,l=n.length,a=0;a<l;a++){var s=n[a],d=s.dataIndx;null==d&&("pq_detail"==(d="detail"==s.type?"pq_detail":e?"dataIndx_"+a:a)&&(s.dataType="object"),s.dataIndx=d),i[d]=s,r[d]=a,s.validations&&(o[d]=o)}t.columns=i,t.colIndxs=r,t.validations=o}}(jQuery),function(t){var e=t.paramquery,i=e._pqGrid.prototype;i.exportExcel=function(t){return(t=t||{}).format="xlsx",this.exportData(t)},i.exportCsv=function(t){return(t=t||{}).format="csv",this.exportData(t)},i.exportData=function(t){return new r(this,t).Export(t)};var r=e.cExport=function(t,e){this.that=t,this.templates={content_types:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Override PartName="/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/worksheet.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/></Types>',workbook:";>wlk udqrhnm<!0-/! dmbnchmf<!TSE,7! rs`mc`knmd<!xdr!>=;vnqjannj wlkmr<!gsso9..rbgdl`r-nodmwlkenql`sr-nqf.roqd`crgddslk.1//5.l`hm! wlkmr9q<!gsso9..rbgdl`r-nodmwlkenql`sr-nqf.neehbdCnbtldms.1//5.qdk`shnmrghor!=;rgddsr=;rgdds m`ld<!O`q`lPtdqx Oqn Du`k! rgddsHc<!0! q9hc<!qHc0!.=;.rgddsr=;.vnqjannj=".replace(/[^\s]/g,function(t){return String.fromCharCode(t.charCodeAt(0)+1)}),worksheet:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><%=content%></worksheet>',rels:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="workbook.xml"/></Relationships>',workbook_rels:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheet.xml"/></Relationships>'}},i=r.prototype;i.getTitle=function(t,e){var i=t.title;return i?"function"==typeof i&&(i=i.call(this.that,{colIndx:e,column:t,dataIndx:t.dataIndx,Export:!0})):i="",i},i.getRenderVal=function(t,e,i){var r=t.column,o=r.exportRender;return(e&&!1!==o||o)&&(r.render||r._render||r.format)?i.renderCell(t):t.rowData[t.dataIndx]},i.getXlsMergeCells=function(t,i,r,o){t=t.concat(r.getMergeCells(i,this.curPage,o)),i=[],r=e.toLetter,o=t.length,i.push('<mergeCells count="'+o+'">');for(var n=0;n<o;n++){var l=t[n],l=r(l.c1)+(l.r1+1)+":"+r(l.c2)+(l.r2+1);i.push('<mergeCell ref="',l,'"/>')}return i.push("</mergeCells>"),o?i.join(""):""},i.getXlsCols=function(t,e){var i=[];i.push("<cols>");for(var r=0;r<e;r++){var o=t[r],n=r+1,l=o.hidden?"1":"0",a=o._width;a||(a=parseInt(o.width))||(a=100),i.push('<col min="',n,'" max="',n,'" hidden="',l,'" customWidth="1" width="',a/7,'"/>')}return i.push("</cols>"),i.join("")},i.getXlsHeader=function(t,e,i){for(var r=[],o=0;o<e;o++){var n=t[o];r.push("<row>");for(var l=0,a=n.length;l<a;l++){var s=n[l];if(!1!==s.copy){var d=s.o_colspan,h=s.rowSpan,c=this.getTitle(s,l);0<o&&s==t[o-1][l]?c="":0<l&&s==t[o][l-1]?c="":(1<d||1<h)&&i.push({r1:o,c1:l,r2:o+h-1,c2:l+d-1}),r.push('<c t="inlineStr"><is><t><![CDATA['+c+"]]></t></is></c>")}}r.push("</row>")}return r.join("")},i.getXlsBody=function(t,e,i,r,o,n,l,a,s){var d,h,c,u,p,f,g=[],v={integer:"Number",float:"Number",bool:"bool"};for(d=0;d<r;d++){for(h=(p=i[d]).pq_hidden?'hidden="1"':"",c=(f=o?d+n:d)-n,p={rowIndx:f,rowIndxPage:c,rowData:p,Export:!0},g.push("<row "+h+">"),h=0;h<e;h++)!1!==(u=t[h]).copy&&(c=void 0,l.ismergedCell(f,h)&&(l.isRootCell(f,h,"o")||(c=null)),void 0===c&&(p.colIndx=h,p.column=u,p.dataIndx=u.dataIndx,c=this.getRenderVal(p,a,s)),"Number"==(u=(u=null==c?null:v[u.dataType])?u:"String")&&(isNaN(1*c)?u="String":c*=1),c=null==c?"":c,"String"==u?g.push('<c t="inlineStr"><is><t><![CDATA['+c+"]]></t></is></c>"):"Number"==u?g.push("<c><v>"+c+"</v></c>"):"bool"==u?(c=c?"1":"0",g.push('<c t="b"><v>'+c+"</v></c>")):g.push("<c><v>"+c+"</v></c>"));g.push("</row>")}return g.join("\n")},i.getXlsContent=function(t,e,i,r,o,n,l,a,s,d,h,c){var u='<sheetViews><sheetView tabSelected="1" workbookViewId="0"><pane ySplit="<%=a%>" topLeftCell="A<%=b%>" activePane="bottomLeft" state="frozen"/></sheetView></sheetViews>',p=this.getXlsCols(t,e),f=[],g=c?r:0,u=u.replace("<%=a%>",g),u=u.replace("<%=b%>",g+1);return i=c?this.getXlsHeader(i,r,f):"",t=this.getXlsBody(t,e,o,n,l,a,s,d,h),[u,p,"<sheetData>",i,t,"</sheetData>",this.getXlsMergeCells(f,c?r:0,s,n)].join("")},i.getHtmlHeader=function(t,e){for(var i,r,o,n,l=[],a=0;a<e;a++){var s=t[a],d=null;l.push("<tr>");for(var h=0,c=s.length;h<c;h++)r=(i=s[h]).colSpan,!i.hidden&&r&&!1!==i.copy&&(o=i.rowSpan,0<a&&i==t[a-1][h]||d&&0<h&&i==d||(n=this.getTitle(i,h),d=i,i=(i=i.halign||i.align)?"align="+i:"",l.push("<th colspan=",r," rowspan=",o," ",i,">",n,"</th>")));l.push("</tr>")}return l.join("")},i.getHtmlBody=function(t,e,i,r,o,n,l,a,s){var d,h,c,u,p,f,g,v=[];for(d=0;d<r;d++)if(!(h=i[d]).pq_hidden){for(f=(g=o?d+n:d)-n,f={rowIndx:g,rowIndxPage:f,rowData:h,Export:!0},v.push("<tr>"),h=0;h<e;h++)if(!(c=t[h]).hidden&&!1!==c.copy){if(p="",l.ismergedCell(g,h)){if(!(p=l.isRootCell(g,h)))continue;(u=l.getRootCell(g,h,"o")).Export=!0,u=this.getRenderVal(u,a,s),p="rowspan="+p.rowspan+" colspan="+p.colspan+" "}else f.colIndx=h,f.column=c,f.dataIndx=c.dataIndx,u=this.getRenderVal(f,a,s);p+=(c=c.align)?"align="+c:"",u=null==u?"":u,v.push("<td ",p,">",u,"</td>")}v.push("</tr>")}return v.join("")},i.getHtmlContent=function(t,e,i,r,o,n,l,a,s,d,h,c,u){var p=t.cssRules||"",f=this.that.element.find(".pq-grid-table"),g=f.css("font-family"),f=f.css("font-size"),v=[];return v.push("<!DOCTYPE html><html><head>",'<meta charset="utf-8" />',"<title>",t.title?t.title:"ParamQuery Pro","</title>","</head><body>","<style>","table{empty-cells:show;font-family:"+g+";font-size:"+f+";border-collapse:collapse;}","td,th{padding: 5px;border:1px solid #ccc;}",p,"</style>","<table>"),v.push(u?this.getHtmlHeader(r,o,e):""),v.push(this.getHtmlBody(e,i,n,l,a,s,d,h,c)),v.push("</table></body></html>"),v.join("")},i.getCsvHeader=function(t,e,i,r){for(var o,n,l=[],a=[],s=0;s<e;s++){for(var d=t[s],h=null,c=0,u=d.length;c<u;c++)(o=i[c]).hidden||!1===o.copy||(o=d[c],0<s&&o==t[s-1][c]?l.push(""):h&&0<c&&o==h?l.push(""):(n=(n=this.getTitle(o,c))?n.replace(/\"/g,'""'):"",h=o,l.push('"'+n+'"')));a.push(l.join(r)),l=[]}return a},i.getCSVContent=function(t,e,i,r,o,n,l,a,s,d,h,c,u){t=t.separator||",";var p,f,g,v=[];for(u=u?this.getCsvHeader(r,o,e,t):[],r=0;r<l;r++)if(!(f=n[r]).pq_hidden){for(g=(o=a?r+s:r)-s,g={rowIndx:o,rowIndxPage:g,rowData:f,Export:!0},f=0;f<i;f++)(p=e[f]).hidden||!1===p.copy||(d.ismergedCell(o,f)?d.isRootCell(o,f)?((p=d.getRootCell(o,f,"o")).Export=!0,p=this.getRenderVal(p,h,c)):p="":(g.colIndx=f,g.column=p,g.dataIndx=p.dataIndx,p=this.getRenderVal(g,h,c)),p=(p=(null==p?"":p)+"").replace(/\"/g,'""'),v.push('"'+p+'"'));u.push(v.join(t)),v=[]}return u.join("\n")},i.getJsonContent=function(t,e){return t.nostringify?e:JSON.stringify(e,t.nopqdata?function t(e,i){return 0===(e+"").indexOf("pq_")?void 0:i}:null,t.nopretty?null:2)},i.postRequest=function(e){var i,r=e.format,o=e.url,n=e.filename||"pqGrid";return e.zip&&"xlsx"!=r?((r=new JSZip).file(n+"."+e.format,e.data),e=r.generate({type:"base64",compression:"DEFLATE"}),i=!0,r="zip"):(i=!!e.decodeBase,e=e.data),o&&t.ajax({url:o,type:"POST",cache:!1,data:{pq_ext:r,pq_data:e,pq_decode:i,pq_filename:n},success:function(e){o+=(0<o.indexOf("?")?"&":"?")+"pq_filename="+e,t(document.body).append("<iframe height='0' width='0' frameborder='0' src=\""+o+'"></iframe>')}}),e},i.Export=function(t){var e,i,r,o=this.that,n=o.options,l=this.templates,a=n.groupModel;i="remote"==n.pageModel.type,e=o.rowIndxOffset;var s=o.iGenerateView,d=o.iMerge,h=o.colModel,c=h.length,u=o.headerCells,p=u.length,a=(this.curPage=a.on&&a.dataIndx.length||i)?o.pdata:n.dataModel.data,a=n.summaryData?a.concat(n.summaryData):a,f=a.length,n=t.url,g=t.render,v=!t.noheader,w=t.format;return o._trigger("beforeExport",null,t),"xlsx"==w?(e=this.getXlsContent(h,c,u,p,a,f,i,e,d,g,s,v),(i=new JSZip).file("[Content_Types].xml",l.content_types),i.file("workbook.xml",l.workbook),i.file("worksheet.xml",l.worksheet.replace("<%=content%>",e)),(e=i.folder("_rels")).file(".rels",l.rels),e.file("workbook.xml.rels",l.workbook_rels),n?(t.data=i.generate({type:"base64",compression:"DEFLATE"}),t.decodeBase=!0):r=i.generate({type:"blob",compression:"DEFLATE"})):t.data="json"==w?this.getJsonContent(t,a):"csv"==w?this.getCSVContent(t,h,c,u,p,a,f,i,e,d,g,s,v):this.getHtmlContent(t,h,c,u,p,a,f,i,e,d,g,s,v),r=r||this.postRequest(t),o._trigger("exportData",null,t),r}}(jQuery),function(t){var e=t.paramquery,i={options:{items:[],gridInstance:null}};t.widget("paramquery.pqToolbar",i),(i=e.pqToolbar.prototype).refresh=function(){this.element.empty(),this._create()},i._create=function(){var i,r,o=this.options,n=o.gridInstance,l={button:"click",select:"change",checkbox:"change",textbox:"change"},a=o.bootstrap,s=a.on,d=n.colModel,o=o.items,h=this.element;h.addClass("pq-toolbar");for(var c=0,u=o.length;c<u;c++){var p=o[c],f=p.type,g=p.value,v=p.icon,w=p.options||{},m=p.label,x=(r=p.listener)?[r]:p.listeners,x=x||[function(){}];r=(r=p.cls)?r:"",r=(r=s&&"button"==f?a.btn+" "+r:r)?"class='"+r+"'":"";var $,_=p.style,_=_?"style='"+_+"'":"",I=p.attr,y=I||"",I=m&&"button"!=f?[r,y]:[r,y,_],I=I.join(" ");for(p.options=w,"textbox"==f?$=t([m?"<label "+_+">"+m:"","<input type='text' "+I+">",m?"</label>":""].join("")):"textarea"==f?$=t([m?"<label "+_+">"+m:"","<textarea "+I+"></textarea>",m?"</label>":""].join("")):"checkbox"==f?$=t([m?"<label "+_+">":"","<input type='checkbox' ",g?"checked='checked' ":"",I,">",m?m+"</label>":""].join("")):"separator"==f?$=t("<span class='pq-separator' "+[y,_].join(" ")+"></span>"):"button"==f?($="",s&&($=v?"<span class='glyphicon "+v+"'></span>":""),$=t("<button type='button' "+I+">"+$+m+"</button>"),t.extend(w,{label:!!m&&m,icons:{primary:s?"":v}}),$.button(w)):"select"==f?("function"==typeof w&&(w=w.call(n,{colModel:d})),w=w||[],$=e.select({options:w,attr:I,prepend:p.prepend,groupIndx:p.groupIndx,valueIndx:p.valueIndx,labelIndx:p.labelIndx}),$=t([m?"<label "+_+">"+m:"",$,m?"</label>":""].join(""))):"string"==typeof f?$=t(f):"function"==typeof f&&($=t($=f.call(n,{colModel:d,cls:r}))),$.appendTo(h),"checkbox"!==f&&void 0!==g&&(m?t($[0].children[0]).val(g):$.val(g)),g=0,m=x.length;g<m;g++)for(i in r=x[g],v={},"function"==typeof r?v[l[f]]=r:v=r,v)$.on(i,this._onEvent(n,v[i],p))}},i._onEvent=function(e,i,r){return function(o){r.value="checkbox"==r.type?t(o.target).prop("checked"):t(o.target).val(),i.call(e,o)}},i._destroy=function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},i._disable=function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},i._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},i._setOption=function(t,e){"disabled"==t&&(!0==e?this._disable():this._enable())},pq.toolbar=function(e,i){var r=t(e).pqToolbar(i);return r.data("paramqueryPqToolbar")||r.data("paramquery-pqToolbar")}}(jQuery),function(t){var e=t.paramquery,i=e.pqGrid.prototype.options;i.trackModel=i.trackModel||{on:!1,dirtyClass:"pq-cell-dirty"},(i=(e.cUCData=function(t){this.that=t,this.udata=[],this.ddata=[],this.adata=[],this.options=t.options;var e=this;t.on("dataAvailable",function(t,i){"filter"!=i.source&&(e.udata=[],e.ddata=[],e.adata=[])})}).prototype=new e.cClass).add=function(t){var e=this.that,i=this.adata,r=this.ddata;t=t.rowData;for(var o=this.options.trackModel.dirtyClass,n=e.getRecId({rowData:t}),l=0,a=i.length;l<a;l++){var s=i[l];if(null!=n&&s.recId==n)throw"primary key violation";if(s.rowData==t)throw"same data can't be added twice."}for(l=0,a=r.length;l<a;l++)if(t==r[l].rowData){r.splice(l,1);return}var d,r=[];for(d in t)r.push(d);e.removeClass({rowData:t,dataIndx:r,cls:o}),t={recId:n,rowData:t},i.push(t)},i.update=function(e){var i=this.that,r=this.options.trackModel.dirtyClass,o=e.rowData||i.getRowData(e),n=i.getRecId({rowData:o}),l=e.dataIndx,a=e.refresh,s=i.columns,d=i.getValueFromDataType;e=e.row;var h=this.udata,c=h.slice(0),u=!1;if(null!=n){for(var p=0,f=h.length;p<f;p++){var g=h[p],v=g.oldRow;if(g.rowData==o){for(l in u=!0,e)h=s[l].dataType,f=d(f=e[l],h),g=d(g=v[l],h),v.hasOwnProperty(l)&&g===f?(h={rowData:o,dataIndx:l,refresh:a,cls:r},i.removeClass(h),delete v[l]):(h={rowData:o,dataIndx:l,refresh:a,cls:r},i.addClass(h),v.hasOwnProperty(l)||(v[l]=o[l]));t.isEmptyObject(v)&&c.splice(p,1);break}}if(!u){for(l in v={},e)v[l]=o[l],h={rowData:o,dataIndx:l,refresh:a,cls:r},i.addClass(h);h={rowData:o,recId:n,oldRow:v},c.push(h)}this.udata=c}},i.delete=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,i=null==i?r+o:i,r="remote"==e.options.pageModel.type?null==r?i-o:r:i,o=this.adata,n=this.ddata;t=e.getRowData(t);for(var e=0,l=o.length;e<l;e++)if(o[e].rowData==t){o.splice(e,1);return}n.push({indx:r,rowData:t,rowIndx:i})},i.isDirty=function(t){var e=this.udata,i=this.adata,r=this.ddata,o=!1;if(t=this.that.getRowData(t)){for(i=0;i<e.length;i++)if(t==e[i].rowData){o=!0;break}}else(e.length||i.length||r.length)&&(o=!0);return o},i.getChangesValue=function(e){e=e||{};var i=this.that;e=e.all;for(var r=this.udata,o=this.adata,n=this.ddata,l=[],a=[],s=[],d=[],h=[],c=[],u=0,p=n.length;u<p;u++){var f=n[u],g=f.rowData,v={};for(var w in h.push(g),g)0!=w.indexOf("pq_")&&(v[w]=g[w]);c.push(v)}for(u=0,p=r.length;u<p;u++)if(n=(f=r[u]).oldRow,g=f.rowData,-1==t.inArray(g,h)&&-1==t.inArray(g,l)){if(v={},!1!==e)for(w in g)0!=w.indexOf("pq_")&&(v[w]=g[w]);else{for(w in n)v[w]=g[w];v[i.options.dataModel.recIndx]=f.recId}l.push(g),a.push(v),s.push(n)}for(u=0,p=o.length;u<p;u++){for(w in g=(f=o[u]).rowData,v={},g)0!=w.indexOf("pq_")&&(v[w]=g[w]);d.push(v)}return{updateList:a,addList:d,deleteList:c,oldList:s}},i.getChanges=function(){for(var e=this.udata,i=this.adata,r=this.ddata,o=t.inArray,n=[],l=[],a=[],s=[],d=0,h=r.length;d<h;d++){var c=r[d],c=c.rowData;s.push(c)}for(d=0,h=e.length;d<h;d++)r=(c=e[d]).oldRow,-1==o(c=c.rowData,s)&&-1==o(c,n)&&(n.push(c),l.push(r));for(d=0,h=i.length;d<h;d++)a.push(c=(c=i[d]).rowData);return{updateList:n,addList:a,deleteList:s,oldList:l}},i.getChangesRaw=function(){var t=this.adata,e=this.ddata,i={updateList:[],addList:[],deleteList:[]};return i.updateList=this.udata,i.addList=t,i.deleteList=e,i},i.commitAdd=function(e,i){for(var r=this.that,o=r.colModel,n=o.length,l=this.adata,a=t.inArray,s=l.length,d=r.getValueFromDataType,r=[],h=e.length,c=[],u=0;u<h;u++)for(var p=e[u],f=0;f<s;f++){var g=l[f].rowData,v=!0;if(-1==a(g,c)){for(var w=0;w<n;w++){var m=o[w],x=m.dataType,$=m.dataIndx;if(!m.hidden&&$!=i&&(m=d(m=g[$],x))!==($=d($=p[$],x))){v=!1;break}}if(v){v={},(f={})[i]=p[i],v[i]=g[i],r.push({type:"update",rowData:g,oldRow:v,newRow:f}),c.push(g);break}}}for(f=0,o=[];f<s;f++)-1==a(g=l[f].rowData,c)&&o.push(l[f]);return this.adata=o,r},i.commitUpdate=function(e,i){for(var r=this.that,o=this.options.trackModel.dirtyClass,n=this.udata,l=n.length,a=e.length,s=[],d=0;d<l;d++){var h=n[d],c=h.rowData,h=h.oldRow;if(-1==t.inArray(c,s)){for(var u=0;u<a;u++)if(c[i]==e[u][i])for(var p in s.push(c),h)r.removeClass({rowData:c,dataIndx:p,cls:o})}}for(d=0,r=[];d<l;d++)c=n[d].rowData,-1==t.inArray(c,s)&&r.push(n[d]);return this.udata=r,[]},i.commitDelete=function(t,e){for(var i,r,o,n=this.ddata,l=n.length,a=this.udata;l--&&(r=(i=n[l].rowData)[e],o=t.length);)for(;o--;)if(r==t[o][e]){for(t.splice(o,1),n.splice(l,1),r=a.length;r--;)a[r].rowData==i&&a.splice(r,1);break}},i.commitUpdateAll=function(){for(var t=this.that,e=this.options.trackModel.dirtyClass,i=this.udata,r=0,o=i.length;r<o;r++){var n,l=i[r],a=l.oldRow,l=l.rowData;for(n in a)t.removeClass({rowData:l,dataIndx:n,cls:e})}this.udata=[]},i.commitAddAll=function(){this.adata=[]},i.commitDeleteAll=function(){for(var t,e=this.ddata,i=this.udata,r=i.length,o=e.length,n=0;0<r&&n<o;n++){for(t=e[n].rowData;r--;)i[r].rowData==t&&i.splice(r,1);r=i.length}e.length=0},i.commit=function(t){var e=this.that,i=t?t.history:null,i=null!=i&&i,r=[],r=[],o=[],n=e.options.dataModel.recIndx;if(null==t)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();else{var l=t.type;t=t.rows,"add"==l?t?r=this.commitAdd(t,n):this.commitAddAll():"update"==l?t?o=this.commitUpdate(t,n):this.commitUpdateAll():"delete"==l&&(t?this.commitDelete(t,n):this.commitDeleteAll())}(r=r.concat(o)).length&&(e._digestData({source:"commit",checkEditable:!1,track:!1,history:i,rowList:r}),e.refreshView())},i.rollbackAdd=function(t,e){for(var i=this.adata,r=[],o=0,n=i.length;o<n;o++)r.push({type:"delete",rowData:i[o].rowData});return this.adata=[],r},i.rollbackDelete=function(t,e){for(var i=this.ddata,r=[],o=i.length-1;0<=o;o--){var n=i[o];r.push({type:"add",rowIndx:n.rowIndx,newRow:n.rowData})}return this.ddata=[],r},i.rollbackUpdate=function(t,e){for(var i=this.that,r=this.options.trackModel.dirtyClass,o=this.udata,n=[],l=0,a=o.length;l<a;l++){var s=o[l],d=s.rowData,h={},c=s.oldRow;if(null!=s.recId){var u,s=[];for(u in c)h[u]=d[u],s.push(u);i.removeClass({rowData:d,dataIndx:s,cls:r,refresh:!1}),n.push({type:"update",rowData:d,newRow:c,oldRow:h})}}return this.udata=[],n},i.rollback=function(t){var e=this.that,i=e.options.pageModel,r=!t||null==t.refresh||t.refresh;t=t&&null!=t.type?t.type:null;var o=[],o=[],n=[],l=[],a=e.options.dataModel.data;(null==t||"update"==t)&&(n=this.rollbackUpdate(i,a)),(null==t||"delete"==t)&&(o=this.rollbackDelete(i,a)),(null==t||"add"==t)&&(l=this.rollbackAdd(i,a)),o=o.concat(l,n),e._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:o}),r&&e.refreshView()},(e=e.pqGrid.prototype).getChanges=function(t){if(this.blurEditor({force:!0}),t){var e=t.format;if(e){if("byVal"==e)return this.iUCData.getChangesValue(t);if("raw"==e)return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()},e.rollback=function(t){this.blurEditor({force:!0}),this.iUCData.rollback(t)},e.isDirty=function(t){return this.iUCData.isDirty(t)},e.commit=function(t){this.iUCData.commit(t)},e.updateRow=function(t){for(var e=t.rowList||[{rowIndx:t.rowIndx,newRow:t.newRow||t.row,rowData:t.rowData,rowIndxPage:t.rowIndxPage}],i=[],r=0,o=e.length;r<o;r++){var n=this.normalize(e[r]),l=n.newRow,a=n.rowData,s={};if(a){for(var d in l)s[d]=a[d];n.oldRow=s,n.type="update",i.push(n)}}if(!i.length||!1===this._digestData({source:t.source||"update",history:t.history,checkEditable:t.checkEditable,track:t.track,allowInvalid:t.allowInvalid,rowList:i}))return!1;!1!==t.refresh&&(1<i.length?this.refresh():this.refreshRow({rowIndx:i[0].rowIndx}))},e.getRecId=function(t){return t.dataIndx=this.options.dataModel.recIndx,null==(t=this.getCellData(t))?null:t},e.getCellData=function(t){var e=t.rowData||this.getRowData(t);return t=t.dataIndx,e?e[t]:null},e.getRowData=function(t){if(!t)return null;var e=t.rowData;if(null!=e)return e;if(null==(e=t.recId)){var e=t.rowIndx,e=null!=e?e:t.rowIndxPage+this.rowIndxOffset,i=this.get_p_data()[e];return i}t=(i=this.options.dataModel).recIndx;for(var r=i.data,o=0,n=r.length;o<n;o++)if((i=r[o])[t]==e)return i;return null},e.deleteRow=function(t){for(var e=t.rowList||[{rowIndx:t.rowIndx,rowIndxPage:t.rowIndxPage}],i=[],r=0,o=e.length;r<o;r++){var n=this.normalize(e[r]);n.oldRow=n.rowData,n.type="delete",i.push(n)}if(!i.length)return!1;this._digestData({source:t.source||"delete",history:t.history,track:t.track,rowList:i}),!1!==t.refresh&&this.refreshView()},e.addRow=function(t){var e=t.rowList||[{rowIndx:t.rowIndx,rowIndxPage:t.rowIndxPage,newRow:t.newRow||t.rowData}],i=[],r=this.options.dataModel,o=r.data;null==o&&(r.data=[],o=r.data);for(var r=0,n=e.length;r<n;r++){var l=this.normalize(e[r]);l.type="add",i.push(l)}return!!i.length&&!1!==this._digestData({source:t.source||"add",history:t.history,track:t.track,checkEditable:t.checkEditable,rowList:i})&&(!1!==t.refresh&&this.refreshView(),null==(t=i[0].rowIndx)?o.length-1:t)}}(jQuery),function(t){var e=function(t){this.focusSelection=null};e.prototype.inViewRow=function(t){var e=this.that,i=e.finalV;return t<e.options.freezeRows||t>=e.initV&&t<=i};var i=function(t){this.that=t,this.options=t=t.options,this.selection=[],this.hclass=" pq-state-select "+(t.bootstrap.on?"":"ui-state-highlight")};t.paramquery.cRows=i;var r=function(t){var e=t.options;this.that=t,this.selection=[],this.hclass="pq-state-select "+(e.bootstrap.on?"":"ui-state-highlight")};t.paramquery.cCells=r,r=r.prototype=new e,(e=i.prototype=new e).isSelected=function(t){return(t=t.rowData||this.that.getRowData(t))?!0===t.pq_rowselect:null},e.selectRange=function(t){var e=t.range,i=e.r1,e=e.r2;t=t.evt;var r=[];if(i>e)var o=i,i=e,e=o;for(;i<=e;i++)r.push({rowIndx:i});this.add({rows:r,evt:t})},r.removeAll=function(t){var e=this.that;t=e.get_p_data();var i=this.hclass;if(t&&t.length)for(e.$tbl&&e.$tbl.children().children().children().removeClass(i),e=0,i=t.length;e<i;e++){var r=t[e];r&&delete r.pq_cellselect}},e.removeAll=function(t){t=t||{};var e=this.that,i=t.all,r=this.hclass,o=e.get_p_data();if(o&&o.length)for(t.refresh&&e.$tbl&&e.$tbl.children().children().removeClass(r),o=i?o:e.pdata,t=0,e=o.length;t<e;t++)(i=o[t])&&delete i.pq_rowselect},r.isSelected=function(t){var e=this.that,i=t.rowData||e.getRowData(t),r=t.dataIndx;return null==(t=t.colIndx)&&null==r||null==i?null:(r=null==r?e.colModel[t].dataIndx:r,!0==(i.pq_cellselect&&i.pq_cellselect[r]))},e.getSelection=function(){for(var t=this.that,e=t.selection().address(),i=[],r=0,o=e.length;r<o;r++){var n=e[r];if("row"==n.type)for(var l=n.r2,n=n.r1;n<=l;n++){var a=t.getRowData({rowIndx:n});i.push({rowIndx:n,rowData:a})}}return i},r.getSelection=function(){for(var t=this.that,e=t.selection(),i=t.colModel,e=e.address(),r=[],o=0,n=e.length;o<n;o++){var l=e[o],a=l.type;if("block"==a||"cell"==a||"column"==a)for(var a=l.r2,s=l.c1,d=l.c2,l=l.r1;l<=a;l++)for(var h=t.getRowData({rowIndx:l}),c=s;c<=d;c++)r.push({rowIndx:l,rowData:h,colIndx:c,dataIndx:i[c].dataIndx})}return r},r.inViewCell=function(t,e){var i=this.that,r=i.options.freezeCols;return!!this.inViewRow(t)&&(e<r||e>=i.initH&&e<=i.finalH)},r._add=function(t){var e,i=this.that,r=(t=i.normalize(t)).rowIndxPage,o=t.rowData,n=t.colIndx,l=t.dataIndx,a=this.isSelected({rowData:o,dataIndx:l});if(null==a)return!1;var s=i.iMerge.ismergedCell(t.rowIndx,n)||this.inViewCell(r,n);if(!1===a&&(s&&(i=i.getCell({rowIndxPage:r,colIndx:n}))&&i.addClass(this.hclass),e=(o.pq_cellselect=o.pq_cellselect||{})[l]=!0),e)return t},e._add=function(t){var e=this.that,i=e.normalize(t),r=i.rowIndxPage;t=i.rowData;var o=this.isSelected({rowData:t});if(i.rowIndxPage=r,null==o)return!1;i=this.inViewRow(r),!1===o&&(!t.pq_hidden&&i&&(e=e.getRow({rowIndxPage:r})).length&&e.addClass(this.hclass),t.pq_rowselect=!0)},r.add=function(t){this._add(t)},e.add=function(t){var e=t.rows;if(e&&"function"==typeof e.push){t=0;for(var i=e.length;t<i;t++){var r=e[t];r.trigger=!1,this._add(r)}}else this._add(t)},e._remove=function(t){var e=this.that,i=e.normalize(t);t=i.rowIndx;var r=i.rowIndxPage,o=i.rowData,i=i.$tr;if(this.isSelected({rowData:o}))return this.inViewRow(r)&&(i=e.getRow({rowIndxPage:r}))&&(i.removeClass(this.hclass),i.removeAttr("tabindex")),o.pq_rowselect=!1,{rowIndx:t,rowData:o}},e.remove=function(t){var e=t.rows;if(e&&"function"==typeof e.push){t=0;for(var i=e.length;t<i;t++){var r=e[t];r.trigger=!1,this._remove(r)}}else this._remove(t)},r.selectBlock=function(e){var i=this.that,r=this.hclass,o=e.range,n=o.r1,l=o.c1,a=o.r2,o=o.c2,s=i.initH,d=i.finalH,h=i.options.freezeCols,c=[],u=i.colModel,p=[];e=!!e.remove;for(var f=l;f<=o;f++)c[f]=u[f].dataIndx;for(;n<=a;n++)if(f=(u=i.normalize({rowIndx:n})).rowData,u=u.rowIndxPage,f){var g=f.pq_cellselect=f.pq_cellselect||{};if(this.inViewRow(u))for(f=l;f<=o;f++){var v=c[f];if(e&&g[v]||!e&&!g[v]){if(f<h||f>=s&&f<=d){var w=i.getCell({rowIndxPage:u,colIndx:f});w.length&&p.push(w[0])}g[v]=!e||void 0}}else for(f=l;f<=o;f++)g[v=c[f]]=!e||void 0}p.length&&t(p)[e?"removeClass":"addClass"](r)}}(jQuery),function(t){var e=!0;t(function(){var i=t("<input type='checkbox' style='position:fixed;left:-50px;top:-50px;'/>").appendTo(document.body);i[0].indeterminate=!0,i.on("change",function(){e=!1}),i.click(),i.remove()});var i=(t.paramquery.cCheckBoxColumn=function(e,i){var r=this;this.that=e,this.options=e.options,this.column=i,i.cb=t.extend({},{all:!1,header:!1,select:!1,check:!0,uncheck:!1},i.cb),i._render=function(t){var e=t.rowData;if(!e.pq_gtitle&&!e.pq_gsummary)return"<input type='checkbox' "+(i.cb.check===t.cellData?"checked":"")+" />"},this.dataIndx=i.dataIndx;var o=e.element,n=e.eventNamespace;e.on("dataAvailable",function(){e.one("dataReady",function(){return r._onDataReady()})}).on("dataReady",function(){r.setValCBox()}),o.on("change"+n,function(e){var i=e.target;if("checkbox"==i.type&&t(i).closest(".pq-grid")[0]==this)return r.onCheckBoxChange(e)}),e.on("cellKeyDown",function(t,e){return r.onCellKeyDown(t,e)}),e.on("refreshHeader",function(t,e){return r.refreshHeader(t,e)})}).prototype=new t.paramquery.cClass;i.hasHeaderChkBox=function(){return this.column.cb.header},i.setValCBox=function(){if(this.hasHeaderChkBox()){var t=this.that,e=this.options,i=this.dataIndx,r=this.column.cb,o=r.all,n=t.rowIndxOffset,n="remote"!=e.pageModel.type&&o?0:n,e=o?e.dataModel.data:t.pdata,o=null,l=0,a=0;if(e){for(var s=0,d=0,h=e.length;d<h;d++){var c=e[d],u=d+n;t.isEditableRow({rowIndx:u})&&t.isEditableCell({rowIndx:u,dataIndx:i})&&(s++,c[i]===r.check?l++:a++)}l==s&&s?o=!0:a==s&&(o=!1),this.$inp&&this.$inp.pqval({val:o})}}},i.onHeaderChange=function(e){for(var i=t(e.target),r=this.that,o=this.column,n=o.dataIndx,l=r.options,a=o.cb,s=a.all,d=s?l.dataModel.data:r.pdata,h=r.rowIndxOffset,h="remote"!=l.pageModel.type&&s?0:h,l=[],o={column:o,dataIndx:n,source:"header"},i=i[0].checked,s=0,c=d.length;s<c;s++){var u=s+h,p=d[s],f={},g={};f[n]=i?a.check:a.uncheck,g[n]=p[n],l.push({rowIndx:u,rowData:p,newRow:f,oldRow:g,type:"update"})}if((n={rowList:l,source:"checkbox"}).history=n.track=!a.select&&null,o.check=i,o.rows=l,!1===r._trigger("beforeCheck",e,o)||!1===r._digestData(n))return r.refreshHeader(),!1;r.refresh({header:!1}),l=o.rows=n.rowList,r._trigger("check",e,o),a.select&&r.selection({type:"row",method:i?"add":"remove",rows:l})},i.refreshHeader=function(t,i){var r=this;if(this.hasHeaderChkBox()){var o=this.that;if(o.pdata&&(o=o.getCellHeader({dataIndx:this.dataIndx}))){var n=this.$inp=o.find("input");this.setValCBox(),e&&n.on("click",function(t){null==n.data("pq_value")&&(n[0].checked=!0,n.data("pq_value",!0),r.onHeaderChange(t))}),n.on("change",function(t){r.onHeaderChange(t)})}}},i._onDataReady=function(){var t=this.that,e=this.options,i=e.dataModel.data,e="remote"==e.pageModel.type?t.rowIndxOffset:0,r=this.column,o=r.cb,n=r.dataIndx;if(null!=n&&i){for(var l=[],a=0,s=i.length;a<s;a++){var d=i[a];d[n]===o.check&&l.push({rowIndx:a+e,rowData:d})}if(!1!==t._trigger("check",null,{rows:l,column:r,dataIndx:n,source:"dataAvailable"})&&o.select){for(a=0;a<s;a++)(d=i[a])[n]===o.check&&(d.pq_rowselect=!0);t.selection().refresh()}}this.setValCBox()},i.rowSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this.dataIndx;if(r)for(var l=0,a=r.length;l<a;l++){var o=r[l],s=o.rowIndx,o=o.rowData;o[n]=!0,i.refreshCell({rowIndx:s,dataIndx:n})}else o&&(o[n]=!0,s=e.rowIndx,i.refreshCell({rowIndx:s,dataIndx:n}));this.setValCBox()},i.rowUnSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this.dataIndx;if(r)for(var l=0,a=r.length;l<a;l++){var o=r[l],s=o.rowIndx,o=o.rowData;o[n]=!1,i.refreshCell({rowIndx:s,dataIndx:n})}else o&&(o[n]=!1,s=e.rowIndx,i.refreshCell({rowIndx:s,dataIndx:n}));this.setValCBox()},i.onCheckBoxChange=function(e){var i=this.that,r=this.column.cb,o=t(e.target),n=o.closest(".pq-grid-cell");if(n.length){var n=i.getCellIndices({$td:n}),n=i.normalize(n),l=n.rowData,a=n.rowIndx,s=n.dataIndx;if(s==this.dataIndx){var o=o[0].checked,d={},h={};if(d[s]=o?r.check:r.uncheck,h[s]=l[s],l=[{rowData:l,rowIndx:a,oldRow:h,newRow:d,type:"update"}],n.check=o,n.rows=l,!1===i._trigger("beforeCheck",e,n)||((l={source:"checkbox",rowList:l}).history=l.track=!r.select&&null,!1===i._digestData(l)))return i.refreshCell({rowIndx:a,dataIndx:s}),!1;i.refreshRow({rowIndx:a}),l=n.rows=l.rowList,i._trigger("check",e,n),r.select&&i.selection({type:"row",method:o?"add":"remove",rows:l}),this.setValCBox()}}},i.onCellKeyDown=function(e,i){if(i.dataIndx==this.dataIndx&&(13==e.keyCode||32==e.keyCode))return t(e.originalEvent.target).find("input").click(),!1}}(jQuery),function(){for(var t=0,e=["moz","webkit"],i=0;!window.requestAnimationFrame&&i<e.length;i++)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),i=Math.max(0,16-(i-t));return window.setTimeout(function(){t=(new Date).getTime(),e()},i)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(t){function e(t){this.that=t;var e=this;this.borderBottomExtra=this.borderBottom=this.borderLeftExtra=this.borderLeft=this.borderTopExtra=this.borderTop=this.borderRightExtra=this.borderRight=this.scrollLeft=this.scrollTop=0,this.maxBorder=5e3,this.rowht=t.options.rowHeight,this.colwd=60,t.on("contMouseDown",function(t,i){return e._onContMouseDown(t,i)}).on("mouseDrag",function(t,i){return e._onMouseDrag(t,i)}).on("mouseStop",function(t,i){return e._onMouseStop(t,i)}).on("mousePQUp",function(t,i){return e._onMousePQUp(t,i)}).on("rowMouseDown",function(t,i){return e._onRowMouseDown(t,i)}).on("cellMouseDown",function(t,i){return e._onCellMouseDown(t,i)}).on("refresh",function(e,i){setTimeout(function(){t.element&&t.focus()},0)}).on("cellMouseEnter",function(t,i){return e._onCellMouseEnter(t,i)}).on("rowMouseEnter",function(t,i){return e._onRowMouseEnter(t,i)})}t.paramquery.cMouseSelection=e;var i=e.prototype=new t.paramquery.cClass;i.inViewPort=function(t){var e=this.that.iRefresh,i=e.getEContHt(),e=e.getEContWd()+1;t=t[0];var r=this.scrollLeft;if(i>=t.offsetTop+t.offsetHeight+this.marginTop){if("TD"!=t.nodeName.toUpperCase())return!0;if(e>=t.offsetLeft+t.offsetWidth+r)return!0}},i._onCellMouseDown=function(t,e){var i=this.that,r=e.rowIndx,o=i.iSelection,n=e.colIndx,l=i.options.selectionModel,a=l.mode;if("cell"!=l.type)i.focus(e);else if(null!=n)return o=o.address()[0],t.shiftKey&&"single"!=a&&o?(a=o.firstR,o=o.firstC,i.range({r1:a,c1:o,r2:r,c2:n,firstR:a,firstC:o}).select()):(this.mousedown={r1:r,c1:n},i.range({r1:r,c1:n,firstR:r,firstC:n}).select()),i.focus(e),!0},i._onCellMouseEnter=function(t,e){var i=this.that,r=i.options.selectionModel,o=r.type,r=r.mode;if(this.mousedown&&"single"!=r){if("cell"==o){var o=this.mousedown,r=o.r1,n=o.c1,l=e.rowIndx,a=e.colIndx;if(r==l&&n==a||o.r2==l&&o.c2==a)return;this.mousedown.r2=l,this.mousedown.c2=a,i.scrollCell({rowIndx:l,colIndx:a}),i.range({r1:r,c1:n,r2:l,c2:a,firstR:r,firstC:n}).select()}i.focus(e)}},i._onRowMouseEnter=function(t,e){var i=this.that,r=i.options.selectionModel,o=r.mode;"row"==r.type&&this.mousedown&&"single"!=o&&((r=this.mousedown.r1)==(o=e.rowIndx)?i.range({r1:r,firstR:r},!1).select():this.mousedown.r2!=o&&(this.mousedown.r2=o,i.scrollRow({rowIndx:o}),i.range({r1:r,r2:o,firstR:r},!1).select()))},i._onRowMouseDown=function(e,i){var r,o=this.that,n=i.rowIndx,l=o.iSelection;r=o.options.selectionModel;var a=t(e.originalEvent.target).hasClass("pq-grid-number-cell"),s=r.mode;if(("row"==r.type||r.row&&a)&&null!=n)return r=o.iSelection.address(),e.shiftKey?((l=r.length)&&"row"==r[l-1].type&&((l=r[l-1]).r1=l.firstR,l.r2=n,l.c1=l.c2=l.type=void 0),o.range(r).select()):(e.ctrlKey||e.metaKey)&&"single"!=s?l[(r=o.iRows.isSelected({rowIndx:n}))?"removeRow":"add"]({r1:n,firstR:n}):(this.mousedown={r1:n,y1:e.pageY,x1:e.pageX},o.range({r1:n,firstR:n},!1).select()),a&&setTimeout(function(){o.focus({rowIndxPage:i.rowIndxPage,colIndx:o.getFirstVisibleCI(!0)})},0),!0},i._onContMouseDown=function(t,e){return this.that.options.swipeModel.on&&(this._stopSwipe(!0),this.swipedown={x:t.pageX,y:t.pageY}),!0},i._onMousePQUp=function(t,e){this.mousedown=null},i._stopSwipe=function(t){t&&(this.swipedownPrev=this.swipedown=null),window.clearInterval(this.intID),window.cancelAnimationFrame(this.intID),this.intID=null},i._onMouseStop=function(t,e){var i=this,r=this.that;if(this.swipedownPrev){var o=r.options.swipeModel,r=this.swipedownPrev,n=r.ts,l=(new Date).getTime()-n,a=t.pageX,s=t.pageY,d=a-r.x,h=s-r.y;if(Math.sqrt(d*d+h*h)/l>o.ratio){var c=0,u=o.repeat;i._stopSwipe();var p=function(){c+=o.speed,u--,i._onMouseDrag({pageX:a+c*d/l,pageY:s+c*h/l}),0<u?i.intID=window.requestAnimationFrame(p):i._stopSwipe(!0)};p()}else i.swipedown=null,i.swipedownPrev=null}},i._onMouseDrag=function(t,e){var i=this.that.options;if(this.swipedown){var r=this.swipedown,o=r.x,n=r.y,l=t.pageX,a=t.pageY;this.swipedownPrev={x:o,y:n,ts:(new Date).getTime()};var s=i.scrollModel.smooth;(!i.virtualY||s)&&(this.scrollVertSmooth(n,a),this.syncScrollBarVert()),(!i.virtualX||s)&&(this.scrollHorSmooth(o,l),this.syncScrollBarHor()),r.x=l,r.y=a}return!0},i.updateTableY=function(t){if(0==t)return!1;var e=this.that,i=this.getTableForVertScroll(),e=e.iRefresh.getEContHt();if(!i||!i.length)return!1;var r=i.data("offsetHeight")-1,o=this.scrollTop-t;return this.setScrollTop(0>o?0:0>t&&0<e-r+o?r-e:o,i,e),!0},i.setScrollTop=function(t,e,i){0<=t&&(this.scrollTop=t=Math.round(t),e.parent("div").scrollTop(t))},i.getScrollLeft=function(t){return this.scrollLeft},i.getScrollTop=function(t){return this.scrollTop},i.setScrollLeft=function(e,i,r,o){0<=e&&(this.scrollLeft=e=Math.round(e),(r=(r=r?r.parent():t()).add(i?i.parent("div"):t())).scrollLeft(e))},i.scrollVertSmooth=function(t,e){t!=e&&this.updateTableY(e-t)},i.scrollHorSmooth=function(t,e){if(t!=e){var i=this.that,r=i.options,o=e-t,n=this.getTableForHorScroll(),l=this.getTableHeaderForHorScroll(),i=i.iRefresh.getEContWd();if(n||l){var a=n||l,r=r.virtualX?this.getScrollWidth(a):a.data("scrollWidth"),o=this.scrollLeft-o;this.setScrollLeft(0>o?0:0>r-i-o?r-i:o,n,l,i)}}},i.syncViewWithScrollBarVert=function(t){if(null!=t){var e=this.that,i=this.getTableForVertScroll();if(i&&i.length){e.options.editModel.indices&&e.blurEditor({force:!0});var r=i.data("offsetHeight"),e=e.iRefresh.getEContHt();((t*=r-e)||0===t)&&(0>t&&(t=0),this.setScrollTop(t,i,e))}}},i.syncViewWithScrollBarHor=function(t){if(null!=t){var e=this.that,i=this.getTableForHorScroll(),r=this.getTableHeaderForHorScroll();if(i||r){var o=e.options;o.editModel.indices&&e.blurEditor({force:!0});var n=i||r,o=o.virtualX?this.getScrollWidth(n):n.data("scrollWidth"),e=e.iRefresh.getEContWd();t*=o-e,o&&e&&(0>t&&(t=0),this.setScrollLeft(t,i,r,e))}}},i.resetMargins=function(){this.scrollTop=this.scrollLeft=0},i.syncHeaderViewWithScrollBarHor=function(t){if(null!=t){var e=this.that,i=this.getTableHeaderForHorScroll();if(i){var r=e.options,o=r.freezeCols;r.editModel.indices&&e.blurEditor({force:!0});var r=i.data("scrollWidth"),n=e.iRefresh.getEContWd();t=e.calcWidthCols(o,t+o),r&&n&&(0>t&&(t=0),i.css("marginLeft",-t))}}},i.syncScrollBarVert=function(){var t=this.that,e=this.getTableForVertScroll();if(e&&e.length){var e=e.data("offsetHeight"),i=t.iRefresh.getEContHt(),e=this.scrollTop/(e-i);0<=e&&1>=e&&t.vscroll.widget().hasClass("pq-sb-vert")&&t.vscroll.option("ratio",e)}},i.syncScrollBarHor=function(){var t=this.that,e=t.options,i=this.getTableForHorScroll(),r=this.getTableHeaderForHorScroll();(i||r)&&(i=i||r,e=e.virtualX?this.getScrollWidth(i):i.data("scrollWidth"),i=t.iRefresh.getEContWd(),0<=(e=this.scrollLeft/(e-i))&&1>=e&&t.hscroll.widget().hasClass("pq-sb-horiz")&&t.hscroll.option("ratio",e))},i.getTableForVertScroll=function(){var e=this.that,i=e.pqpanes;if((e=e.$tbl)&&e.length)return i.h&&i.v?e=t([e[2],e[3]]):i.v?e=t([e[0],e[1]]):i.h&&(e=t(e[1])),e},i.getTableForHorScroll=function(){var e=this.that,i=e.pqpanes,r=[],o=e.$tbl;if(o&&o.length)return i.h&&i.v?r.push(o[1],o[3]):i.v?r.push(o[1]):i.h?r.push(o[0],o[1]):r.push(o[0]),e.tables.length&&(e=e.tables[0].$tbl,i.v?r.push(e[1]):r.push(e[0])),t(r)},i.getTableHeaderForHorScroll=function(){var e=this.that,i=e.pqpanes;if((e=e.$tbl_header)&&e.length)return(e=i.vH?t(e[1]):t(e[0])).parent()},i.scrollRowNonVirtual=function(t){var e=this.that,i=e.options,r=t.rowIndxPage,o=t.rowIndx;if(t=e.iRefresh.getEContHt(),!((r=null==r?o-e.rowIndxOffset:r)<(i=parseInt(i.freezeRows)))){var i=e.get$Tbl(r),n=e.getRow({rowIndxPage:r})[0];n&&(e=i[0].offsetTop+1,r=n.offsetHeight,o=this.getScrollTop(),0>e+(n=n.offsetTop-1)-o?(e=e+n+-1,this.setScrollTop(0>e?0:e,i,t),this.syncScrollBarVert()):n+r-o>t&&(this.setScrollTop(r+n-t,i,t),this.syncScrollBarVert()))}},i.scrollColumnNonVirtual=function(t){var e=this.that,i=t.colIndx,i=null==i?e.getColIndx({dataIndx:t.dataIndx}):i,r=e.options.freezeCols;if(!(i<r)){t=e._calcRightEdgeCol(i).width;var i=e._calcRightEdgeCol(i-1).width,r=e._calcRightEdgeCol(r-1).width,o=this.getTableForHorScroll(),n=this.getTableHeaderForHorScroll(),e=e.iRefresh.getEContWd(),l=this.scrollLeft;t-l>e?(this.setScrollLeft(t-e,o,n,e),this.syncScrollBarHor()):i-r<l&&(this.setScrollLeft(i-r,o,n,e),this.syncScrollBarHor())}}}(jQuery),function(t){var e=null,i=!1,r="",o=t.paramquery.pqGrid.prototype,n=o.options;n.pasteModel=n.pasteModel||{on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"},n.copyModel=n.copyModel||{on:!0,header:!0,zIndex:1e4},n.cutModel=n.cutModel||{on:!0},o._setGlobalStr=function(t){r=t},o.canPaste=function(){return!!r},o.copy=function(){(e=new l(this)).copy(),e=null},o.paste=function(t){(e=new l(this)).paste(t),e=null},o.cut=function(){(e=new l(this)).copy({cut:!0,source:"cut"}),e=null},o.clear=function(){this.iSelection.clear()};var l=function(t,e){this.that=t},o=l.prototype;o.createClipBoard=function(){var e=t("#pq-grid-excel-div"),e=this.that.options.copyModel,i=t("#pq-grid-excel");0==i.length&&(e=t("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+e.zIndex+";'/>").appendTo(document.body),(i=t("<textarea id='pq-grid-excel' autocomplete='off' spellcheck='false' style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(e)).css({opacity:0})),i.select()},o.destroyClipBoard=function(){this.clearClipBoard();var e=this.that,i=t(window).scrollTop(),r=t(window).scrollLeft();e.focus();var e=t(window).scrollTop(),o=t(window).scrollLeft();i==e&&r==o||window.scrollTo(r,i)},o.clearClipBoard=function(){t("#pq-grid-excel").val("")},o.copy=function(t){return this.that.iSelection.copy(t)},o.paste=function(e){e=e||{};var i,o=this.that,n=e.dest,l=e.clip,a=l?l.length?l.val():"":r,a=a.replace(/\n$/,""),l=a.split("\n"),s=l.length,d=o.colModel,h=o.readCell,c=o.options.pasteModel,u="row",p=!1,f=d.length;if(c.on&&0!=a.length&&0!=s){if(a={rows:l},!1===o._trigger("beforePaste",null,a))return!1;var g,v,w,m=c.type,u=(n?o.range(n):o.selection())._areas;(w=u.length?u[0]:null)&&o.getRowData({rowIndx:w.r1})?(u="row"==w.type?"row":"cell",g=w.r1,v=w.r2,n=w.c1,w=w.c2):(u="cell",w=n=v=g=0),"replace"==m?(x=g,$=v-g+1<s?"extend":"repeat"):"append"==m?(x=v+1,$="extend"):"prepend"==m&&(x=g,$="extend");var x,$,_,I,s="extend"==$?s:v-g+1;g=0,e=e.rowList||[];for(var y=v=0;y<s;y++){var b=l[g],C=y+x,q="replace"==m?o.getRowData({rowIndx:C}):null,R=q?{}:null,D={};void 0===b&&"repeat"===$&&(b=l[g=0]),g++;var M=b.split("	");if(!i){if("cell"==u){if(i=M.length,isNaN(i="extend"==(_=w-n+1<M.length?"extend":"repeat")?i:w-n+1))throw"lenH NaN. assert failed.";i+n>f&&(i=f-n)}else i=f,n=0}var P=0,T=0,b=0;I=i;for(var k=M.length,T=0;T<I;T++){P>=k&&(P=0);var H=d[T+n],S=M[P],E=H.dataIndx;!1===H.copy?(b++,"extend"==_&&I+n<f&&I++):(P++,D[E]=S,R&&(R[E]=h(q,H)))}!1==t.isEmptyObject(D)&&(M="update",null==q&&(p=!0,M="add"),e.push({newRow:D,rowIndx:C,rowData:q,oldRow:R,type:M}),v++)}o._digestData({rowList:e,source:"paste",allowInvalid:c.allowInvalid,validate:c.validate}),o[p?"refreshView":"refresh"](),c.select&&("cell"==u?o.range({r1:x,c1:n,r2:x+v-1,c2:"extend"==_?n+i-1+b:w}).select():o.range({r1:x,r2:x+v-1}).select()),o._trigger("paste",null,a)}},t(document).unbind(".pqExcel").bind("keydown.pqExcel",function(r){if(r.ctrlKey||r.metaKey){var o=t(r.target);if(o.hasClass("pq-grid-row")||o.hasClass("pq-grid-cell")||o.is("#pq-grid-excel")||o.hasClass("pq-grid-cont")){var n=o.closest(".pq-grid");if(e||o.length&&n.length){if(!e){try{var s=n.pqGrid("getInstance").grid;if(s.option("selectionModel.native"))return!0}catch(d){return!0}(e=new l(s,o)).createClipBoard()}"67"==r.keyCode||"99"==r.keyCode?e.copy({clip:t("#pq-grid-excel")}):"88"==r.keyCode?e.copy({cut:!0,clip:t("#pq-grid-excel")}):"86"==r.keyCode||"118"==r.keyCode?(i=!0,e.clearClipBoard(),window.setTimeout(function(){e&&(e.paste({clip:t("#pq-grid-excel")}),e.destroyClipBoard(),e=null),i=!1},0)):(o=t("#pq-grid-excel")).length&&document.activeElement==o[0]&&e.that._onKeyPressDown(r)}}}else if((o=r.keyCode)==(n=t.ui.keyCode).UP||o==n.DOWN||o==n.LEFT||o==n.RIGHT||o==n.PAGE_UP||o==n.PAGE_DOWN){if(a)return!1;((o=t(r.target)).hasClass("pq-grid-row")||o.hasClass("pq-grid-cell"))&&(a=!0)}}).bind("keyup.pqExcel",function(r){var o=r.keyCode;i||!e||r.ctrlKey||r.metaKey||-1==t.inArray(o,[17,91,93,224])||(e.destroyClipBoard(),e=null),a&&((r=t(r.target)).hasClass("pq-grid-row")||r.hasClass("pq-grid-cell")||(a=!1))});var a=!1}(jQuery),function(t){var e=t.paramquery.pqGrid.prototype.options;e.historyModel=e.historyModel||{on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0},(e=(t.paramquery.cHistory=function(t){var e=this;this.that=t,this.options=t.options,this.records=[],this.id=this.counter=0,t.on("keyDown",function(t,i){return e._onKeyDown(t,i)}).on("dataAvailable",function(t,i){"filter"!=i.source&&e.reset()})}).prototype=new t.paramquery.cClass)._onKeyDown=function(t,e){var i=t.ctrlKey||t.metaKey;return i&&"90"==t.keyCode?(this.undo(),!1):i&&"89"==t.keyCode?(this.redo(),!1):void 0},e.resetUndo=function(){if(0==this.counter)return!1;this.counter=0,this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})},e.reset=function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[],this.id=this.counter=0,this.that._trigger("history",null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})},e.increment=function(){var t=this.records,e=t.length;this.id=e?t[e-1].id+1:0},e.push=function(e){var i,r,o=this.canRedo(),n=this.records,l=this.counter;n.length>l&&n.splice(l,n.length-l),n[l]=t.extend({id:this.id},e),this.counter++,e=this.that,1==this.counter&&(i=!0),o&&this.counter==n.length&&(r=!1),e._trigger("history",null,{type:"add",canUndo:i,canRedo:r,num_undo:this.counter,num_redo:0})},e.canUndo=function(){return 0<this.counter},e.canRedo=function(){return this.counter<this.records.length},e.processCol=function(t,e){var i=this.that;if(t.length){var r="add"==t.type;i[(e?r:!r)?"addColumn":"deleteColumn"]({colList:t,history:!1})}},e.undo=function(){var t,e,i=this.canRedo(),r=this.that,o=!1,n=this.options.historyModel,l=this.records;if(!(0<this.counter))return!1;this.counter--;for(var a=l[this.counter],l=(l=a.rowList)?l:[],a=(a=a.colList)?a:[],s=[],d=0,h=l.length;d<h;d++){var c=l[d],u=c.newRow,p=c.rowData,f=c.type,g=c.oldRow,c=c.rowIndx;"update"==f?(c=r.getRowIndx({rowData:p}).rowIndx,s.push({type:f,rowIndx:c,rowData:p,oldRow:u,newRow:g})):"add"==f?(o=!0,s.push({type:"delete",rowData:u})):"delete"==f&&(o=!0,s.push({type:"add",rowIndx:c,newRow:p}))}return a.length?this.processCol(a):(r._digestData({history:!1,source:"undo",checkEditable:n.checkEditable,checkEditableAdd:n.checkEditableAdd,allowInvalid:n.allowInvalid,rowList:s}),r[o?"refreshView":"refresh"]({source:"undo"})),!1===i&&(t=!0),0==this.counter&&(e=!1),r._trigger("history",null,{canUndo:e,canRedo:t,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},e.redo=function(){var t,e,i=this.canUndo(),r=this.that,o=this.options.historyModel,n=this.counter,l=this.records;if(n==l.length)return!1;for(var a=!1,s=l[n],n=(n=s.rowList)?n:[],s=(s=s.colList)?s:[],d=[],h=0,c=n.length;h<c;h++){var u=n[h],p=u.newRow,f=u.rowData,g=u.type,v=u.oldRow,u=u.rowIndx;"update"==g?(u=r.getRowIndx({rowData:f}).rowIndx,d.push({type:g,rowIndx:u,rowData:f,oldRow:v,newRow:p})):"add"==g?(a=!0,d.push({type:"add",rowIndx:u,newRow:p})):"delete"==g&&(a=!0,d.push({type:"delete",rowData:f}))}return s.length?this.processCol(s,!0):(r._digestData({history:!1,source:"redo",checkEditable:o.checkEditable,checkEditableAdd:o.checkEditableAdd,allowInvalid:o.allowInvalid,rowList:d}),r[a?"refreshView":"refresh"]({source:"redo"})),this.counter<l.length&&this.counter++,!1==i&&(t=!0),this.counter==this.records.length&&(e=!1),r._trigger("history",null,{canUndo:t,canRedo:e,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},t.paramquery.pqGrid.prototype.history=function(t){return this.iHistory[t.method](t)}}(jQuery),function(t){var e,i=t.paramquery;i.filter={conditions:e={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}},getAllConditions:function(){var t,i=[];for(t in e)i.push(t);return i}(),getConditions:function(t){var i,r=[];for(i in e)e[i][t]&&r.push(i);return r},getTRConditions:function(){var t,i=[];for(t in e)e[t].TR&&i.push(t);return i}(),getWTRConditions:function(){var t,i=[];for(t in e)e[t].TR||i.push(t);return i}()},i.filter.rules={},i.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"};var r=function(t){this.that=t,t.on("load",function(){var e=t.options.dataModel.dataUF;e&&(e.length=0)})};i.cFilterData=r;var o=r.prototype;r.conditions={equal:function(t,e){if(t==e)return!0},contain:function(t,e){if(-1!=t.indexOf(e))return!0},notcontain:function(t,e){if(-1==t.indexOf(e))return!0},empty:function(t){if(0==t.length)return!0},notempty:function(t){if(0<t.length)return!0},begin:function(t,e){if(0==(t+"").indexOf(e))return!0},notbegin:function(t,e){if(0!=t.indexOf(e))return!0},end:function(t,e){var i=t.lastIndexOf(e);if(-1!=i&&i+e.length==t.length)return!0},notend:function(t,e){var i=t.lastIndexOf(e);if(-1==i||i+e.length!=t.length)return!0},regexp:function(t,e){if(e.test(t))return e.lastIndex=0,!0},notequal:function(t,e){if(t!=e)return!0},great:function(t,e){if(t>e)return!0},gte:function(t,e){if(t>=e)return!0},between:function(t,e,i){if(t>=e&&t<=i)return!0},range:function(e,i){if(-1!=t.inArray(e,i))return!0},less:function(t,e){if(t<e)return!0},lte:function(t,e){if(t<=e)return!0}},r.convert=function(e,i){return e=null==e?"":e,"string"==i?e=t.trim(e).toUpperCase():"date"==i?e=Date.parse(e):"integer"==i?e=parseInt(e):"float"==i?e=parseFloat(e):"bool"==i&&(e=String(e).toLowerCase()),e},o.isMatchCellSingle=function(t,e){var i=t.dataType,o=t.value,n=t.value2,l=t.cbFn,a=e[t.dataIndx],a="regexp"==t.condition?null==a?"":a:r.convert(a,i);return!!l(a,o,n)},o.isMatchRow=function(t,e,i){if(0==e.length)return!0;for(var r=0;r<e.length;r++){var o=this.isMatchCell(e[r],t);if("OR"==i&&o)return!0;if("AND"==i&&!o)return!1}return"AND"==i||"OR"!=i&&void 0},o.getQueryStringFilter=function(){var t=this.that,e=t.options,i=e.stringify,e=e.filterModel,r=e.mode,t=this.getFilterData({CM:t.colModel,location:"remote"}),o="";return e&&e.on&&t&&(t.length?(e={mode:r,data:t},o=!1===i?e:JSON.stringify(e)):o=""),o},o.filterLocalData=function(t){t=t||{};var e=this.that,i=t.apply,i=null==i||i;t=this.getFilterData({CM:i?e.colModel:t.CM});var r=e.options,o=r.dataModel,n=e.iSort,l=o.data,a=[],s=[],d=o.dataUF,h=r.filterModel,c=h.multiple,r=h?h.mode:null;if(l||(l=o.data=[]),d||(d=o.dataUF=[]),!1===i&&(l=l.slice()),d.length){for(var u=0,p=d.length;u<p;u++)l.push(d[u]);0==n.readSorter().length&&n.sortLocalData(l),d=o.dataUF=[]}else{if(!t.length)return{data:l,dataUF:d};n.saveOrder()}if(this.isMatchCell=c?this.isMatchCellMultiple:this.isMatchCellSingle,h.on&&r&&t&&t.length){if(l.length)for(u=0,p=l.length;u<p;u++)n=l[u],this.isMatchRow(n,t,r)?a.push(n):s.push(n);l=a,d=s,i&&(o.data=l,o.dataUF=d)}return i&&(e._queueATriggers.filter={ui:{type:"local",filter:t}}),{data:l,dataUF:d}},o.getFilterData=function(e){var r=e.CM;if(!r)throw"CM N/A";var o=r.length,n=e.location;e=this.that.options.filterModel.multiple;for(var l=i.filter.getAllConditions,a=i.filter.getTRConditions,s=[],d=i.cFilterData,h=function(e,i,r){return"function"==typeof e||("between"==e?null!=i&&""!==i||null!=r&&""!==r:-1==t.inArray(e,l)||null!=i&&""!==i||-1==t.inArray(e,a))},c=function(t,e){return"remote"==n?(null==t?"":t).toString():d.convert(t,e)},u=0;u<o;u++){var p=r[u],f=p.dataIndx,g=p.dataType,g=g&&"function"!=typeof g?g:"string",v=p.filter;if(e){if((v=p.filterModel)&&v.on){for(var w=[],m=v.mode,x=v.filters,p=0;p<x.length;p++){var v=x[p],$=v.value,_=v.condition;h(_,$)&&($=c($,g),w.push({value:$,condition:_}))}s.push({dataIndx:f,mode:m,dataType:g,filters:w})}}else if(v&&v.on&&($=v.value,w=v.value2,h(_=v.condition,$,w))){if("between"==_)""===$||null==$?(_="lte",$=c(w,g)):""===w||null==w?(_="gte",$=c($,g)):($=c($,g),w=c(w,g));else if("regexp"==_){if("remote"==n)$=$.toString();else if("string"==typeof $)try{var I=v.modifiers,I=I||"gi",$=RegExp($,I)}catch(y){$=/.*/}}else if("range"==_){if(null==$)continue;if("string"==typeof $)$=($=c($,g)).split(/\s*,\s*/);else if($&&"function"==typeof $.push){if(0==$.length)continue;for($=$.slice(),p=0,v=$.length;p<v;p++)$[p]=c($[p],g)}}else $=c($,g);s.push({dataIndx:f,value:$,value2:w,condition:_,dataType:g,cbFn:"remote"==n?"":"function"==typeof _?_:d.conditions[_]})}}return s}}(jQuery),function(t){(t=(t.paramquery.cSort=function(t){this.that=t,this.sorters=[],this.tmpPrefix="pq_tmp_",this.cancel=!1}).prototype).cancelSort=function(){this.cancel=!0},t.resumeSort=function(){this.cancel=!1},t.readSorter=function(){var t,e,i,r=this.that,o=r.options,n=o.groupModel,r=r.columns,l=0,a=[];if(n.on)for(e=(t=n.dataIndx).length,i=n.dir;l<e;l++)n=t[l],a.push({dataIndx:n,dir:i[l]?i[l]:"up"});if(o=(t=o.sortModel).sorter,t=t.single,o&&(e=o.length)){for(;e--;)null==r[o[e].dataIndx]&&o.splice(e,1);t&&o.length&&(o=[o[0]]),a=a.concat(o)}return pq.arrayUnique(a,"dataIndx")},t.setSingle=function(t){this.single=t},t.getSingle=function(){return this.single},t.readSingle=function(){return this.that.options.sortModel.single},t.writeSingle=function(t){this.that.options.sortModel.single=t},t.setCancel=function(t){this.cancel=t},t.getCancel=function(){return this.cancel},t.readCancel=function(){return this.that.options.sortModel.cancel},t.writeCancel=function(t){this.that.options.sortModel.cancel=t},t.writeSorter=function(t){var e=this.that.options,i=e.sortModel,r=e.groupModel,e=r.dataIndx,o=r.dir;if(r.on){for(r=0;r<e.length;r++){var n=t[r];if(e[r]!=n.dataIndx)throw"gDataIndx!=sorter.dataIndx";o[r]=n.dir}t.splice(0,e.length)}i.sorter=t},t.refreshSorter=function(t){var e=(t=t||{}).sorter,i=e[0].dataIndx,r=e[0].dir,o=t.single,e=t.cancel,n=this.that.options.groupModel,l=n.dataIndx,a=n.on?l.length:0,s=-1;if(t=this.readSorter(),null==o)throw"sort single N/A";if(n.on)for(n=0;n<a;n++)l[n]==i&&(s=n);return -1<s?t[s].dir="up"===t[s].dir?"down":"up":null!=i&&(o?t[a]&&t[a].dataIndx==i?""==(i="up"===(i=t[a].dir)?"down":e&&"down"===i?"":"up")?t.length--:t[a].dir=i:t[a]={dataIndx:i,dir:r||"up"}:-1<(a=this.inSorters(t,i))?"up"==(i=t[a].dir)?t[a].dir="down":e&&"down"==i?t.splice(a,1):1==t.length?t[a].dir="up":t.splice(a,1):t.push({dataIndx:i,dir:"up"})),t},t.saveOrder=function(t){var e=this.that.options.dataModel;if(!(!(t=e.data)||!t.length||e.dataUF&&e.dataUF.length||this.getSorter().length&&null!=t[0].pq_order))for(var e=0,i=t.length;e<i;e++)t[e].pq_order=e},t.getQueryStringSort=function(){if(this.cancel)return"";var t=this.sorters,e=this.that.options.stringify;return t.length?!1===e?t:JSON.stringify(t):""},t.getSorter=function(){return this.sorters},t.setSorter=function(t){this.sorters=t.slice(0)},t.inSorters=function(t,e){for(var i=-1,r=0;r<t.length;r++)if(t[r].dataIndx==e){i=r;break}return i},t.sortLocalData=function(t){for(var e=this.that,i=e.colModel,r=this.sorters,o=0;o<r.length;o++){var n=r[o],l=e.getColIndx({dataIndx:n.dataIndx}),l=i[l],a=l.sortType;n.dataType=l.dataType,n.sortType=a}return r.length||(r=[{dataIndx:"pq_order",dir:"up",dataType:"integer"}]),this._sortLocalData(r,t)},t._sortLocalData=function(t,i){if(null==i)return[];if(0==i.length||!t||!t.length)return i;var r=this,o=r.tmpPrefix,n=r.that.options.sortModel,l=n.useCache,a=n.ignoreCase;return function(){for(var n=[],s=[],d=[],h=t.length,c=0;c<h;c++){var u=t[c],p=u.dataIndx,f="up"==u.dir?1:-1,g=u.sortType,u=(u=u.dataType)?u:"string",u="string"==u&&a?"stringi":u,v=l&&"date"==u,w=v?o+p:p;s[c]=w,d[c]=f,n[c]=g?function(t,e){return function(i,r,o,n){return e(i,r,o,n,t)}}(g,e.sort_sortType):"integer"==u?e.sort_number:"float"==u?e.sort_number:"function"==typeof u?function(t,e){return function(i,r,o,n){return e(i,r,o,n,t)}}(u,e.sort_dataType):"date"==u?e["sort_date"+(v?"_fast":"")]:"bool"==u?e.sort_bool:"stringi"==u?e.sort_locale:e.sort_string,v&&r.useCache(i,u,p,w)}i=i.sort(function(t,e){for(var i=0,r=0;r<h&&0==(i=n[r](t,e,s[r],d[r]));r++);return i}),v&&setTimeout(r.removeCache(t,i),0)}(),i},t.useCache=function(t,i,r,o){i=e["get_"+i];for(var n=t.length;n--;){var l=t[n];l[o]=i(l[r])}},t.removeCache=function(t,e){var i=this.tmpPrefix;return function(){for(var r=t.length;r--;){var o=i+t[r].dataIndx,n=e.length;if(n&&e[0].hasOwnProperty(o))for(;n--;)delete e[n][o]}}};var e={get_date:function(t){var e;return t?isNaN(e=Date.parse(t))?0:e:0},sort_number:function(t,e,i,r){return(((t=t[i])?1*t:0)-((e=e[i])?1*e:0))*r},sort_date:function(t,e,i,r){return t=t[i],e=e[i],((t=t?Date.parse(t):0)-(e=e?Date.parse(e):0))*r},sort_date_fast:function(t,e,i,r){return(t[i]-e[i])*r},sort_dataType:function(t,e,i,r,o){return o(t[i],e[i])*r},sort_sortType:function(t,e,i,r,o){return o(t,e,i)*r},sort_string:function(t,e,i,r){return t=t[i],e=e[i],i=0,(t=t||"")>(e=e||"")?i=1:t<e&&(i=-1),i*r},sort_locale:function(t,e,i,r){return t=t[i],e=e[i],(t||"").localeCompare(e||"")*r},sort_bool:function(t,e,i,r){return t=t[i],e=e[i],i=0,t&&!e||!1===t&&null===e?i=1:(e&&!t||!1===e&&null===t)&&(i=-1),i*r}};pq.sortObj=e}(jQuery),function(t){function e(t){this.that=t,this.mc=null;var e=this,i=t.options;this.DM=i.dataModel,t.on("dataReady columnOrder groupShowHide",function(t,r){i.mergeCells&&"pager"!==r.source&&e.init()})}function i(t,e,i){var r=0,o=t.length;for(i=i>o?o:i;e<i;e++)!0!==t[e].hidden&&r++;return r}function r(t,e,i){var r=0,o=t.length;for(i=i>o?o:i;e<i;e++)!0!==t[e].pq_hidden&&r++;return r}t.paramquery.cMerge=e;var o=e.prototype=new t.paramquery.cClass;o.init=function(){for(var t=this.that,e=t.colModel,o=t.options.mergeCells||[],n=t.get_p_data(),l=[],a=[],s=0,d=o.length;s<d;s++){var h=o[s],c=h.r1,u=c,p=n[c],f=h.c1,g=f,v=e[f],w=h.rc,m=h.cc;if(v&&p){if(v.hidden)a:{for(g=f;g<f+m;g++){if(!(v=e[g])){g=-1;break a}if(!v.hidden)break a}g=void 0}if(v=i(e,f,f+m),p.pq_hidden)a:{for(u=c;u<c+w;u++){if(!(p=n[u])){u=-1;break a}if(!p.pq_hidden)break a}u=void 0}if(!(1>(p=r(n,c,c+w))||1>v))for(l.push({r1:c,c1:f,rc:w,cc:m,e_rc:p,e_cc:v}),a[u]=a[u]||[],a[u][g]={show:!0,rowspan:p,colspan:v,o_rowspan:w,o_colspan:m,style:h.style,cls:h.cls,attr:h.attr,r1:c,c1:f,v_r1:u,v_c1:g},h={show:!1,r1:c,c1:f,v_r1:u,v_c1:g},p=c;p<c+w;p++)for(a[p]=a[p]||[],v=f;v<f+m;v++)(p!=u||v!=g)&&(a[p][v]=h)}}t._mergeCells=0<a.length,this.mc=a,this.mc2=l},o.isHidden=function(t,e){var i,r=this.mc;return!!r&&!!r[t]&&!!(i=r[t][e])&&!i.show},o.setData=function(t,e,i){var r,o=this.mc;o[t]&&(r=o[t][e])&&(r.data=i)},o.getData=function(t,e,i){var r,o=this.mc;if(o[t]&&(r=o[t][e]))return(t=r.data)?t[i]:null},o.removeData=function(t,e,i){var r,o=this.mc;o&&o[t]&&(r=o[t][e])&&(t=r.data)&&(t[i]=null)},o.ismergedCell=function(t,e){var i,r=this.mc;return!!r&&!!r[t]&&!!(i=r[t][e])&&(t!=(r=r[i.v_r1][i.v_c1]).r1||e!=r.c1||{rowspan:r.o_rowspan,colspan:r.o_colspan})},o.isRootCell=function(t,e,i){var r,o=this.mc;if(o&&o[t]&&(r=o[t][e])){if("o"==i)return t==r.r1&&e==r.c1;var n=r.v_r1;if(r=r.v_c1,"a"==i)return(i=o[n][r]).a_r1==t&&i.a_c1==e;if(n==t&&r==e)return{rowspan:(i=o[n][r]).rowspan,colspan:i.colspan}}},o.getRootCell=function(t,e,i){var r,o=this.that,n=this.mc;if(n&&n[t]&&(r=n[t][e])){"a"==i?(t=r.v_r1,e=r.v_c1,(i=n[t][e]).a_r1&&(t=i.a_r1,e=i.a_c1)):"o"==i?(t=r.r1,e=r.c1):(t=r.v_r1,e=r.v_c1),i=o.colModel[e];var n=o.rowIndxOffset,l=t-n;return 0>l&&(l=0,t=n),{rowIndxPage:l,colIndx:e,column:i,dataIndx:i.dataIndx,rowData:o.pdata[l],rowIndx:t,rowspan:r.rowspan,colspan:r.colspan}}return o.normalize({rowIndx:t,colIndx:e})},o.inflateRange=function(t,e,i,r){var o=this.that,n=!1,l=o.options,l=l.groupModel.on?o.rowIndxOffset+o.pdata.length-1:l.dataModel.data.length-1,o=o.colModel.length-1,a=this.mc2;if(!a)return[t,e,i,r];var s=0,d=a.length;a:for(;s<d;s++){var h=a[s],c=h.r1,u=h.c1,p=c+h.rc-1,h=u+h.cc-1,p=p>l?l:p,h=h>o?o:h,f=c<=i&&p>i,g=u<e&&h>=e,v=u<=r&&h>r;if((c<t&&p>=t||f)&&h>=e&&u<=r||(g||v)&&p>=t&&c<=i){n=!0,t=c<t?c:t,e=u<e?u:e,i=p>i?p:i,r=h>r?h:r;break a}}return n?this.inflateRange(t,e,i,r):[t,e,i,r]},t.paramquery.pqGrid.prototype.calcVisibleRows=r,o.renderCell=function(t){var e,o,n=this.that,l=t.rowIndx,a=t.rowIndxPage,s=t.colIndx,d=this.mc;if(d[l]&&(o=d[l][s])){var h=o.v_r1,c=o.v_c1;e=o.r1;var u=o.c1,p=n.options,f=n.colModel,g=n.rowIndxOffset,v=p.freezeCols,w=(p=p.freezeRows)?p+g:0,m=n.initH,x=n.initV;if(!o.show&&(s!=c||a!=x||!(h>=w))&&(s!=c||l!=x||!(h>=w))&&(l!=h||s!=m||!(c>=v))&&(l!=x||s!=m||!(c>=v)||!(h>=w)))return null;var $=e-g,a=n.pdata,n=n.get_p_data(),_=i(f,0,v);o=r(a,0,p),e={rowData:n[e],rowIndx:e,colIndx:u,column:f[u],rowIndxPage:$},u=(d=d[h][c]).colspan,$=d.rowspan,v&&s<v&&s+u>_?u=Math.max(c=u-i(f,v,m),f=i(f,s,v)):u-=i(f,c,s),p&&l<w&&l+$>o+g?$=Math.max(h=$-r(a,p,x),g=r(a,l-g,p)):$-=r(n,h,l),d.a_r1=l,d.a_c1=s,e.rowspan=$,e.colspan=u,e.style=d.style,e.attr=d.attr,e.cls=d.cls}return e||t},o.getMergeCells=function(t,e,i){for(var r,o,n=this.that,l=n.options.mergeCells,n=n.rowIndxOffset,a=n+i,s=[],d=l?l.length:0,h=0;h<d;h++)r=(i=l[h]).r1,o=i.c1,(!e||r>=n&&r<a)&&(e&&(r-=n),s.push({r1:r+=t,c1:o,r2:r+i.rc-1,c2:o+i.cc-1}));return s}}(jQuery),function(){var t=window.pq=window.pq||{};t.extend=function(t,e,i){var r=function(){};r.prototype=t.prototype;var o,r=e.prototype=new r,n=t.prototype;for(o in i){var l=n[o],a=i[o];r[o]=l?function(t,e){return function(){this._super=function(){return t.apply(this,arguments)};var i=e.apply(this,arguments);return this._super=void 0,i}}(l,a):a}r.constructor=e,r._base=t,r._bp=function(t){var e=arguments;return Array.prototype.shift.call(e),n[t].apply(this,e)}};var e=t.Range=function(t,i,r,o){if(null==t)throw"invalid param";if(this.that=t,!1==this instanceof e)return new e(t,i,r,o);this._type=r||"range",this.init(i,o)},i=e.prototype;i._areas=[],i.init=function(t,e){if(e=!1!==e,t){if("function"==typeof t.push)for(var i=0,r=t.length;i<r;i++)this.init(t[i],e);else(i=this._normal(t,e))&&((r=this._areas).length?r.push(i):this._areas=[i])}},i.address=function(){return this.dirty&&this.refresh(),this._areas},i.areas=function(e){this.dirty&&this.refresh();var i=this.that,r=this._areas,r=null==e?r:r[e];return t.Range(i,r,"area")},i.merge=function(t){t=t||{};var e,i,r=this.that,o=r.options.mergeCells,n=this._areas[0];n&&(e=n.r2-n.r1+1,i=n.c2-n.c1+1,1<e||1<i)&&(n.rc=e,n.cc=i,o.push(n),!1!==t.refresh&&r.refreshView())},i.unmerge=function(t){t=t||{};var e=this.that,i=e.options.mergeCells,r=this._areas[0];if(r){for(var o=0;o<i.length;o++){var n=i[o];if(n.r1==r.r1&&n.c1==r.c1){i.splice(o,1);break}}!1!==t.refresh&&e.refreshView()}},i.hide=function(t){t=t||{};for(var e=this.that,i=e.colModel,r=e.get_p_data(),o=this._areas,n=0,l=o.length;n<l;n++){var a=o[n],s=a.type,d=a.r1,h=a.r2,c=a.c1,a=a.c2;if("column"==s)for(s=c;s<=a;s++)i[s].hidden=!0;else if("row"==s)for(s=d;s<=h;s++)r[s].pq_hidden=!0}!1!==t.refresh&&e.refreshView()},i.unhide=function(t){t=t||{};for(var e=this.that,i=e.colModel,r=e.get_p_data(),o=this._areas,n=0,l=o.length;n<l;n++){var a=o[n],s=a.type,d=a.r1,h=a.r2,c=a.c1,a=a.c2;if("column"==s)for(s=c;s<=a;s++)i[s].hidden=!1;else if("row"==s)for(s=d;s<=h;s++)r[s].pq_hidden=!1}!1!==t.refresh&&e.refreshView()},i.select=function(){var t=this.that,e=t.iSelection,i=e._areas[0],r=this._areas,o=r[0];if(!o)return this;var n=o.r1,l=o.c1;if(e.dirty||1!=r.length||"block"!=r[0].type||!i||"cell"!=i.type&&"block"!=i.type||n!=i.r1||l!=i.c1)for(e.removeAll({trigger:!1}),n=0,l=r.length;n<l;n++)e.add(r[n],!1);else{var a=i.r1,s=i.c1,d=i.r2,i=i.c2,h=o.r2,o=o.c2,t=t.iCells;if(h==d&&o==i)return this;o>i?t.selectBlock({range:{r1:n,c1:i+1,r2:h,c2:o}}):o<i&&t.selectBlock({range:{r1:Math.max(n,a),c1:o+1,r2:Math.max(h,d),c2:i},remove:!0}),h>d?t.selectBlock({range:{r1:d+1,c1:l,r2:h,c2:o}}):h<d&&t.selectBlock({range:{r1:h+1,c1:Math.max(l,s),r2:d,c2:Math.max(o,i)},remove:!0}),e._areas=r}return e._trigger(),this},i.resize=function(t,i){var r=this._areas[0];return e(this.that,{r1:r.r1,c1:r.c1,rc:t,cc:i})},i.cut=function(t){return(t=t||{}).cut=!0,this.copy(t)},i.copy=function(t){t=t||{},this.dirty&&this.refresh();var e=this.that,i=t.dest,r=!!t.cut,o=null==t.copy||t.copy,n=t.source||(r?"cut":"copy"),l=null==t.history||t.history,a=null==t.allowInvalid||t.allowInvalid,s=[],d=[],h=e.get_p_data(),c=e.colModel,u=e.readCell,p=e.iMerge,f=this._areas;if(f.length){for(var g=this._areas[0],v=g.type,w=g.r1,m=g.c1,x="cell"==v?w:g.r2,g="cell"==v?m:g.c2,$=0;;){for(;w<=x;w++){for(var _=[],I=h[w],y={},b={},C=m;C<=g;C++){var q=c[C],R=q.dataIndx;if(!1!==q.copy){var D=I[R];o&&_.push(u(I,q,p,w,C)),r&&(y[R]=void 0,b[R]=D)}}r&&s.push({rowIndx:w,rowData:I,oldRow:b,newRow:y,type:"update"}),_=_.join("	"),d.push(_)}if(g=f[++$],"row"==v&&g&&"row"==g.type)w=g.r1,m=g.c1,x=g.r2,g=g.c2;else break}o&&(_=d.join("\n"),t.clip?((t=t.clip).val(_),t.select()):e._setGlobalStr(_)),i?e.paste({dest:i,rowList:s,history:l,allowInvalid:a}):r&&!1!==e._digestData({rowList:s,source:n,history:l,allowInvalid:a})&&e.refresh({source:"cut"})}},i.clear=function(){return this.copy({copy:!1,cut:!0,source:"clear"})},i.add=function(t){this.init(t)},i._countArea=function(t){var e=t.r1,i=t.c1,r=t.r2,o=t.c2;return"cell"==t.type?1:(r-e+1)*(o-i+1)},i.count=function(){this.dirty&&this.refresh();for(var t="range"==this._type,e=this._areas,i=0,r=e.length,o=0;o<r;o++)i+=t?this._countArea(e[o]):1;return i},i.rows=function(e){this.dirty&&this.refresh();var i=this.that,r=[],o=this._areas[0];if(o){var n=o.r1,l=o.c1,a=o.r2,s=o.c2,o=o.type,a=null==e?a:n+e;for(e=null==e?n:n+e;e<=a;e++)r.push({r1:e,c1:l,r2:e,c2:s,type:o})}return t.Range(i,r,"row")},i.columns=function(e){this.dirty&&this.refresh();var i=this.that,r=[],o=this._areas[0];if(o){var n=o.r1,l=o.c1,a=o.r2,s=o.c2,o=o.type,s=null==e?s:l+e;for(e=null==e?l:l+e;e<=s;e++)r.push({r1:n,c1:e,r2:a,c2:e,type:o})}return t.Range(i,r,"column")},i.cell=function(e,i){this.dirty&&this.refresh();var r=this.that,o=[],n=this._areas[0];return n&&(o=[o=n.r1+e,n=n.c1+i,o,n]),t.Range(r,o,"cell")},i.item=function(t){this.dirty&&this.refresh();for(var e=0,i=!1,r=this._areas,o=0,n=r.length;o<n;o++){var l=r[o],a=this._countArea(l);if(e+a>t){i=!0,t-=e;break}e+=a}if(i){if(l)var s=l.r1,d=l.c1,e=l.c2-d+1,s=s+Math.floor(t/e),d=d+t%e;return{r1:s,c1:d}}},i._normal=function(t,e){if(t.type)return t;if("function"==t.push){for(var i=[],r=0,o=t.length;r<o;r++){var n=this._normal(t[r],e);n&&i.push(n)}return i}var i=this.that,l=i.get_p_data().length-1,a=i.colModel.length-1,r=t.r1,o=t.c1,r=r>l?l:r,o=o>a?a:o,s=t.rc,d=t.cc,n=t.r2,h=t.c2,n=s?r+s-1:n>l?l:n,h=d?o+d-1:h>a?a:h;return 0>a||0>l?null:(r>n&&(s=r,r=n,n=s),o>h&&(s=o,o=h,h=s),null!=r||null!=o)?(null==r?(r=0,n=l,h=null==h?o:h,l="column"):null==o?(o=0,n=null==n?r:n,h=a,l="row"):null==n?(l="cell",n=r,h=o):l="block",e&&(r=(i=i.iMerge.inflateRange(r,o,n,h))[0],o=i[1],n=i[2],h=i[3]),t.r1=r,t.c1=o,t.r2=n,t.c2=h,t.type=t.type||l,t):void 0},i.value=function(t){t=(t=t||{}).val,this.dirty&&this.refresh();var e=this.that,i=e.colModel,r=[],o=this._areas;if(void 0===t&&o.length){var n=o[0],l=n.r1,a=n.c1;return e.getCellData({rowIndx:l,colIndx:a})}for(var s=0;s<o.length;s++)for(var n=o[s],l=n.r1,a=n.c1,d=n.r2,n=n.c2;l<=d;l++){for(var h=e.normalize({rowIndx:l}),c=h.rowData,h=h.rowIndx,u={},p={},f=a;f<=n;f++){var g=i[f].dataIndx;p[g]=t,u[g]=c[g]}r.push({rowData:c,rowIndx:h,type:"update",newRow:p,oldRow:u})}r.length&&(e._digestData({rowList:r,source:"range"}),e.refresh())};var r=t.Selection=function(t,e){if(null==t)throw"invalid param";if(!1==this instanceof r)return new r(t,e);this.that=t;var i=this;t.on("dataReady columnOrder addColumn deleteColumn",function(t,e){"pager"!=e.source&&i.renew()}),this._base(t,e)},o={renew:function(){var t=this._areas,e=t.length;1==e?(t=t[0],(t=this._adjust(t))&&(this.removeAll({trigger:!1}),this.add(t,!1))):1<e&&(this.dirty=!0)},isDirty:function(){return this.dirty}},n=function(t){t.shiftKey&&"pqGrid:mousePQUp"!=t.type||(this._trigger("selectEnd",null,{selection:this.selection()}),this.off("mousePQUp",n),this.off("keyUp",n))};o._trigger=function(){var t=this.that;this.dirty&&this.refresh(),t._trigger("selectChange",null,{selection:this}),t.off("mousePQUp",n),t.off("keyUp",n),t.on("mousePQUp",n),t.on("keyUp",n)},o.removeAll=function(t){t=t||{};var e=this.that;e.iCells.removeAll({refresh:!0}),e.iRows.removeAll({refresh:!0,all:!0}),this._areas=[],!1!==t.trigger&&this._trigger()},i.indexOf=function(t){this.dirty&&this.refresh();var e=(t=this._normal(t)).type,i=t.r1,r=t.c1,o=t.r2;t=t.c2;for(var n=this._areas,l=0,a=n.length;l<a;l++){var s=n[l],d=s;if(e==s.type&&i>=d.r1&&o<=d.r2&&r==d.c1&&t==d.c2)return l}return -1},o.add=function(t,e){var i=this.that,r=this._normal(t,!0),o=i.iCells,i=i.iRows,n=r.r1,l=r.c1,a=r.r2,s=r.type;0<=this.indexOf(r)||("row"==s?((o=this._areas).length&&"row"==(s=(o=o[o.length-1]).type)&&n<=o.r2&&(this.dirty=!0),a>n?i.selectRange({range:r}):i.add({rowIndx:n})):"column"==s||"block"==s?o.selectBlock({range:r}):"cell"==s&&o.add({rowIndx:n,colIndx:l}),this._super(r),!1!==e&&this._trigger())},o._adjust=function(t){var e=this.that,i=e.get_p_data().length-1,e=e.colModel.length-1,r=t.r1,o=t.c1,n=t.r2,l=t.c2,n=n>i?i:n,l=l>e?e:l;return 0>e||0>i||r>n||o>l?null:(t.r1=r,t.r2=n,t.c1=o,t.c2=l,t)},i.removeRow=function(t,e){var i=t.r1,r=t.r2,o=this._areas,n=this._areas[e],l=n.r1,a=n.r2;i==l&&r==a?o.splice(e,1):i>l?(n.r2=i-1,r<a&&(i=this._normal({r1:r+1,r2:a}),o.splice(e+1,0,i))):r<a&&(i>l&&(i=this._normal({r1:r+1,r2:a}),o.splice(e,0,i)),n.r1=r+1)},o.removeRow=function(t,e){var i=this.that,r=this._normal(t),o=this.indexOf(r);-1<o&&"row"==r.type&&r.r1==r.r2&&(i.iRows.remove({rowIndx:r.r1}),this._super(t,o),!1!==e&&this._trigger())},o.selectAll=function(t){t=t||{};var e=this.that,i=t.all,r=i?0:e.rowIndxOffset,o=e.colModel.length-1,n=r+(i?e.options.dataModel.data.length-1:e.pdata.length-1);return"cell"==t.type?((t={r1:r,c1:0}).r2=n,t.c2=o,e.range(t).select()):((t={r1:r}).r2=n,i||this.removeRows({all:!1,trigger:!1}),e.iRows.selectRange({range:t}),(e=i?[]:this._areas).push({r1:r,c1:0,r2:n,c2:o,type:"row"}),this._areas=e,this._trigger()),this},o.removeRows=function(t){var e=(t=t||{}).all;this.that.iRows.removeAll({refresh:!0,all:t.all}),e?this._areas=[]:this.refresh(),!1!==t.trigger&&this._trigger()},o.refresh=function(){for(var t=this.that,e=[],i=t.colModel.length-1,t=t.get_p_data(),r=0,o=t.length;r<o;r++){var n,l=t[r];l&&(l.pq_cellselect=void 0,l.pq_rowselect?n?n.r2=r:n={r1:r,r2:r,c1:0,c2:i,type:"row"}:n&&(e.push(n),n=null))}n&&e.push(n),this.dirty=!1,this._areas=e},t.extend(e,r,o)}(),function(t){function e(t,e,i,r){t.push("<li data-option='",i,"' class='pq-menu-item'>","<label>","<input type='checkbox' ",e[i]?"checked":"","/>",r["strGroup_"+i],"</label></li>")}var i=t.paramquery;pq.aggregate={sum:function(t){for(var e,i=0,r=t.length;r--;)null!=(e=t[r])&&(i+=e-0);return i},avg:function(t,e){return this.sum(t,e,!0)/t.length},max:function(t,e){var i;return"float"==(i=e.dataType)||"integer"==i?i=Math.max.apply(Math,t):"date"==i?(t.sort(function(t,e){return t=Date.parse(t),e=Date.parse(e),isNaN(t)&&(t=0),isNaN(e)&&(e=0),e-t}),i=t[0]):(t.sort(),i=t[t.length-1]),i},min:function(t,e){var i,r,o;if("integer"==(i=e.dataType)||"float"==i)i=Math.min.apply(Math,t);else if("date"==i){for(o=t.length,i=[];o--;)(r=t[o])&&i.push({dateO:r,dateP:Date.parse(r)});i.sort(function(t,e){return t.dateP-e.dateP}),i=i.length?i[0].dateO:void 0}else t.sort(),i=t[0];return i},count:function(t){return t.length}};var r=(i.cGroupView=function(t){this.that=t,t.options.groupModel.on&&this.init()}).prototype;r.init=function(){var t,e,i,r;this._init||(this.mc=[],this.tree=[],this.summaryData=[],e=(t=(r=this.that).options).groupModel,i=(t=(t=t.bootstrap).on)?"glyphicon ":"ui-icon ",this.groupRemoveIcon="pq-group-remove "+i+(t?"glyphicon-remove":"ui-icon-close"),this.toggleIcon="pq-group-toggle "+i,r.on("cellClick",this.onCellClick(this)).on("cellKeyDown",this.onCellKeyDown(this,e)).on(!0,"cellMouseDown",this.onCellMouseDown()).on("change",this.onChange(this,e)).on("dataReady",this.onDataReady(this,r)).on("beforeSortDone",this.onBeforeSort(this,r)).on("columnDragDone",this.onColumnDrag(this)).on("columnOrder",this.onColumnOrder(this)),this._init=!0)},r.onCellClick=function(e){return function(i,r){r.rowData.pq_gtitle&&t(i.originalEvent.target).hasClass("pq-group-icon")&&e.toggle(r.rowIndxPage)}},r.onChange=function(t,e){return function(){t.saveState(e.refreshOnChange)}},r.onCellMouseDown=function(){return function(e,i){i.rowData.pq_gtitle&&t(e.originalEvent.target).hasClass("pq-group-icon")&&e.stopImmediatePropagation()}},r.onCellKeyDown=function(e,i){return function(r,o){if(o.rowData.pq_gtitle&&0<=t.inArray(o.dataIndx,i.dataIndx)&&r.keyCode==t.ui.keyCode.ENTER)return e.toggle(o.rowIndxPage),!1}},r.showRows=function(){for(var t=this.that.options.dataModel.data,e=0,i=t.length;e<i;e++)t[e].pq_hidden=!1},r.removeGroup=function(t,e){for(var i=this.that.options.groupModel.dataIndx,r=0;r<i.length;r++)if(t==i[r]){i.splice(r,1);break}i.length||(this.showRows(),this.mc.length=0),!1!==e&&this.refreshFull()},r.addGroup=function(e,i){var r=this.that.options.groupModel;r.dataIndx=r.dataIndx||[],null!=e&&-1==t.inArray(e,r.dataIndx)&&(r.dataIndx.push(e),this.refreshFull())},r._initHeadSortable=function(){this.$header.sortable({axis:"x",distance:3,tolerance:"pointer",cancel:".pq-group-menu",stop:this.onSortable(this,this.that.options)})},r.onColumnDrag=function(t){return function(e,i){var r=i.column.colModel;r&&r.length?t.acceptDrop=!1:t._initHeadDroppable()}},r._initHeadDroppable=function(){var t=this,e=t.that,i=t.$header;i&&(i.droppable({accept:function(e){return t.acceptDrop},tolerance:"pointer",hoverClass:"pq-drop-hover",drop:t.onDrop(e,t)}),t.acceptDrop=!0)},r.onDrop=function(t,e){return function(i,r){var o=1*r.draggable.attr("pq-col-indx");e.addGroup(t.colModel[o].dataIndx),e.acceptDrop=!1}},r.onSortable=function(e,i){return function(){for(var r=[],o=i.groupModel,n=o.dataIndx,l=[],a=!1,s=t(this).find(".pq-group-item"),d=0;d<s.length;d++){var h=t(s[d]),c=h.data("indx"),h=h.data("dir");n[d]!=c&&(a=!0),r.push(c),l.push(h)}a&&(o.dataIndx=r,o.dir=l,e.refreshFull())}},r._initHeader=function(t,e){if(this.$header){var i=this.$header,r=i.find(".pq-group-item");i.data("uiSortable")||this._initHeadSortable(),r.length||i.append("<span class='pq-group-placeholder'>"+t.strGroup_header+"</span>"),e.headerMenu&&this._initHeaderMenu()}},r.createHeader=function(){for(var e=this,i=e.that,r=e.$header,o=i.options,n=o.bootstrap,l=i.columns,a=n.on,s=o.groupModel,d=s.dataIndx,h=d.length;h--;)null==l[d[h]]&&d.splice(h,1);if(h=d.length,s.header&&s.on){if(r?r.empty():(r=e.$header=t("<div class='pq-group-header ui-helper-clearfix' ></div>").appendTo(i.$top)).on("click",".pq-group-item",function(i){i=t(i.target);var r=t(this).data("indx");i.hasClass("pq-group-remove")?e.removeGroup(r):e.groupToggle(r)}),h){for(var i=[],c=0;c<h;c++){var u=d[c],p=l[u],f=a?n.groupModel.icon:s.icon;i.push("<div class='pq-group-item' data-indx='",u,"' data-dir='",s.dir[c],"'>","<span class='",e.toggleIcon,s.collapsed[c]?f[1]:f[0],"' ></span>",p.pqtitle||("string"==typeof p.title?p.title:u),"<span class='",e.groupRemoveIcon,"' ></span></div>")}r[0].innerHTML=i.join("")}e._initHeader(o,s)}else r&&(r.remove(),e.$header=null)},r._initHeaderMenu=function(){for(var i=this.that,r=i.options,o=this.$header,n=["<ul class='pq-group-menu'><li>",i.BS_on?"<span class='glyphicon glyphicon-chevron-left'></span>":"","<ul>"],l=r.groupModel,a=l.menuItems,s=0,d=a.length;s<d;s++)e(n,l,a[s],r);n.push("</ul></li></ul>"),(o=t(n.join("")).appendTo(o)).menu({icons:{submenu:"ui-icon-carat-1-w"},position:{my:"right top",at:"left top"}}),o.change(function(e){if("INPUT"==e.target.nodeName){e=t(e.target).closest("li").data("option");var o={};o[e]=!r.groupModel[e],o.refresh=!0,i.groupOption(o)}})},r.setOption=function(){this._init&&(this.refreshColumns(),this.summaryData.length=0,this.tree.length=0,this._initmerge())},r.onDataReady=function(t,e){return function(){t.tree.length=0;var i=e.options.groupModel;i.on&&(i.dataIndx.length?(t.refreshColumns(),t._groupData(),t._initcollapsed(),t._initmerge()):i.grandSummary&&(t.refreshColumns(),t._groupData())),t.createHeader()}},r.onColumnOrder=function(t){return function(){t._initmerge()}},r.pq_gc_=function(){return"pq_gc_"},r.onBeforeSort=function(t,e){return function(i){if(!i.isDefaultPrevented()){var r=e.options,o=r.groupModel;if(o.on){i=e.columns;for(var n,l,a=[],r=r.dataModel.data||[],s=[],d=o.dataIndx,h=d.length;h--;){var c=d[h],u=(n=i[c]).groupChange;if(u)for(a.push(n),o=t.pq_gc_()+c,s.push(o),n.sortType=t.sortType(o),l=r.length;l--;)(n=r[l])[o]=u(n[c])}e.one("sort",function(){if(h=a.length)for(;h--;)a[h].sortType=void 0})}}}},r.sortType=function(t){return function(e,i,r){return e[t]!=i[t]?e[r]-i[r]:0}},r.groupToggle=function(e){var i=this.that.options.groupModel,r=i.collapsed;r[e=t.inArray(e,i.dataIndx)]=!r[e],this.trigger(null,e),this.refreshView()},r.expandIndx=function(t){var e,i,r,o=this.that,n=!0==t.close,l=(t=t.indx.split(",")).length,a=this.tree;e=0;var s,o=o.pdata;if(!(l>a.length)){for(var d=0;d<l;d++){if(s=1*t[d]+e,!(e=a[d][s])){if(0==d)return;break}e=e.rip,(!n||n&&d==l-1)&&(i=o[e]).pq_close!=n&&(r=i,i.pq_close=n);var h=void 0;if(i=a[d+1]){do h=i[s].rip,s++;while(h<e);e=s-1}else e=void 0}r&&(this.trigger(r),this.saveState(!0))}},r._editorSummary=function(e,i){var r=e.summaryOptions;return function(e){var o=e.rowData;if(o.pq_gsummary||o.pq_gtitle){var o=pq.aggregate,n=e.column,l=n.summary,l=l?l.edit:null,a=n.dataType,n=[""];if(-1<t.inArray(e.dataIndx,i.dataIndx)||!i.summaryEdit&&!l||!1===l)return!1;for(var s in"integer"==a||"float"==a?a="number":"date"!==a&&(a="string"),l=r[a].split(","),e=t.inArray,o)-1<e(s,l)&&n.push(s);return 1!=n.length&&{type:"select",prepend:i.prepend,options:i.options||n,valueIndx:i.valueIndx,labelIndx:i.labelIndx,init:i.init||function(t){var e,i=t.column.summary;i||(i=t.column.summary={}),e=i.type,setTimeout(function(){t.$cell.find("select").val(e)},100)},getData:i.getData||function(t){var e=t.column;return t=t.$cell.find("select").val(),e.summary.type=t,this.one("beforeValidate",function(t,e){e.allowInvalid=!0,e.track=!1,e.history=!1}),t}}}}},r._renderTitle=function(t,e){var i=this.that,r=t.bootstrap,o=r.on,r=o?r.groupModel.icon:e.icon,n=o?["glyphicon "+r[0],"glyphicon "+r[1]]:["ui-icon "+r[0],"ui-icon "+r[1]];return function(t){var r,o,l,a=t.rowData;if(a.pq_gtitle&&null!=t.cellData)return r=a.pq_close,o=a.pq_level,l="function"==typeof(l=(l=e.title)[o]?l[o]:e.titleDefault)?l.call(i,t):l.replace("{0}",t.cellData).replace("{1}",a.pq_items),{text:(t.Export?"":"<span class='pq-group-icon "+n[r?1:0]+"'></span>")+l,cls:"pq-group-title-cell"}}},r._renderSummary=function(t){var e=this.that;return function(i){var r,o,n=i.rowData;if(n.pq_gsummary||n.pq_gtitle)return(r=(n=i.column).summary.type,"function"==typeof(o=t.summaryTitle[r]))?o.call(e,i):(null==(r=i.formatVal)&&(r=null==(r=i.cellData)?"":r),"number"!=typeof r||n.format||parseInt(r)===r||(r=r.toFixed(2)),o?o.replace("{0}",r):r)}},r.refreshColumns=function(){for(var t,e,i,r,o=this.that,n=o.options,l=n.groupModel,a=l.on,s=l.fixCols,d=l.dataIndx,h=d.length,c=n.colModel,u=c.length;u--;)(i=c[u])._render&&(i._render==i._renderGT?(delete i._renderGT,delete i._render):i._render==i._renderGS&&(delete i._renderGS,delete i._render)),i._nodrag&&(delete i._nodrag,delete i._nodrop),a&&(r=i.summary)&&r.type&&(e=e||this._renderSummary(n),i._render=i._renderGS=e);if(n.geditor=a?this._editorSummary(n,l):void 0,a)for(u=h-1;0<=u;u--)i=o.getColumn({dataIndx:d[u]}),t=t||this._renderTitle(n,l),i._renderGT=i._render=t;if(s&&a)for(u=0;u<h;u++)(i=c[n=o.getColIndx({dataIndx:d[u]})])._nodrag=i._nodrop=!0,n!=u&&(o.iDragColumns.moveColumn(n,u,!0),o.iColModel.init())},r.refreshFull=function(){this.refreshColumns(),this.that.sort()},r.refreshView=function(){this.that.refreshView()},r.expandAll=function(t){t=!0==(t=t||{}).close;var e,i=this.that.options.groupModel,r=i.collapsed,i=i.dataIndx;for(e=0;e<i.length;e++)r[e]=t;this.trigger(null,null,!0),this.refreshFull()},r.showHideRows=function(t,e,i,r){for(var o=[],n=this.that.pdata,l=n.length;t<l;t++){var a=n[t];if(a.pq_gsummary){if(a.pq_level<e)break;a.pq_hidden=i}else if(a.pq_gtitle){var s=a.pq_close;if(s&&o.push({indx:t,level:a.pq_level}),a.pq_level<=e)break;a.pq_hidden=!!r&&!s||i}else a.pq_hidden=i}return o},r.trigger=function(t,e,i){var r=this.that,o=r.options.groupModel,n={};t?(e=t.pq_level,i=t[o.dataIndx[e]],n={level:e,close:t=t.pq_close,group:i}):i?n={all:!0,close:t=o.collapsed[0]}:null!=e&&(t=o.collapsed[e],n={level:e,close:t}),r._trigger("group",null,n)},r.toggle=function(t){(t=this.that.pdata[t]).pq_close=!t.pq_close,this.trigger(t),this.saveState(!0)},r.saveState=function(t){var e=this.that,i=e.options.groupModel;if(i.on&&i.dataIndx.length){for(var i=e.pdata,r=i.length,o=Array(r),n=0;n<r;n++)o[n]=i[n];this.pdata=o,t&&e.refreshView()}},r._initmerge=function(){for(var t,e,i,r,o,n=this.that,l=n.options,a=l.groupModel.merge,s=this.tree,d=n.rowIndxOffset,h=n.colModel.length,c=[],u=n.pdata,p=0;p<s.length;p++){t=s[p],i=n.getColIndx({dataIndx:l.groupModel.dataIndx[p]});for(var f=0,g=t.length;f<g&&null!=(r=(e=t[f]).rip);f++)a?(o=(e=e.rip2)-r,e=r+d,c.push({r1:e,rc:o,c1:i,cc:1})):(e=r+d,(r=u[r]).pq_close||c.push({r1:e,rc:1,c1:i,cc:h-i}))}c.length?(this.mc=l.mergeCells=c,n.iMerge.init()):this.mc.length&&(this.mc.length=0,n.iMerge.init())},r._initcollapsed=function(){var t,e,i,r,o=this.that,n=o.options.groupModel.merge,l=this.pdata,o=o.pdata;if(o){for(var a=0,s=o.length;a<s;a++)void 0!==(e=(t=o[a]).pq_gtitle)&&(e=t.pq_level,r=null,l&&null!=(i=(i=l[a])?i.pq_close:null)&&(r=t.pq_close=i),null==r&&(r=t.pq_close),r?this.showHideRows(a+1,e,!0):n&&(t.pq_hidden=!0));delete this.pdata}},r._groupChange=function(e){var i=t.trim,r=this.pq_gc_();return function(t,o,n){return n.groupChange?null!=(t=t[r+o])?t:"":(t=i(t[o]),e?t.toUpperCase():t)}},r._groupData=function(){var e,i=this.that,r=pq.aggregate,o=i.pdata,n=i.options,l=n.groupModel,a=l.merge,s=l.grandSummary,d=t.inArray,h=i.colModel,c=h.length,u=this._groupChange(l.ignoreCase),p=o.length,f=l.dataIndx,g=f.length,v=l.collapsed||[],w=[],m={},x=i.columns,$=[],l=l.showSummary||[],_=[];if(o&&0<p){for(var I=g-1;0<=I;I--)l[I]=null!=l[I]&&l[I],v[I]=null!=v[I]&&v[I],_[I]=(_[I+1]?_[I+1]:0)+l[I],$[I]=x[f[I]];for(e=0;e<c;e++){var y=h[e],b=y.dataIndx,C=y.summary;C&&C.type&&-1==d(b,f)&&(w.push({column:y}),m[b]=Array(p-1))}for(I=0,e=w.length,d=[],h=[],c=[],x=[];I<g;I++)x[I]=null,c[I]="",h[I]=[];for(var q=0;q<=p;q++){for(var R=o[q],b=!1,D=null,I=0;I<g;I++)if(c[I]=q<p?u(R,f[I],$[I]):"",(x[I]!=c[I]||q==p)&&(b=!0,null==D&&(D=I)),b){var y=h[I],M=y[y.length-1];M&&(M.rip2=d.length+_[I]),y.push({rowIndx:q,title:c[I]})}if(b){if(0<q)for(I=g-1;I>=D;I--){for(var M={},y=h[I],P=y.length-2?y[y.length-2].rip:I,T=y.length-2?y[y.length-2].rowIndx:0,k=y[y.length-1].rowIndx,H=0;H<e;H++){var y=w[H].column,C=y.summary,C=C.type,b=y.dataIndx,S="",S=m[b].slice(T,k),S=r[C](S,y);M[b]=S}if(l[I]){var E,y={pq_gsummary:!0,pq_level:I,pq_rowcls:"pq-summary-row"};for(E in M)y[E]=M[E];d.push(y)}for(E in y=d[P],M)y[E]=M[E];a&&(y.pq_rowcls="pq-summary-row"),y.pq_items=k-T}if(q==p)break;for(I=0;I<g;I++)x[I]=c[I];for(I=D;I<g;I++)(y={pq_gtitle:!0,pq_level:I,pq_close:v[I]})[f[I]]=c[I],b=d.push(y),(y=h[I])[y.length-1].rip=b-1}if(q==p)break;for(R.pq_hidden=!1,d.push(R),I=0;I<e;I++)m[b=(y=w[I].column).dataIndx][q]=R[b]}this.tree=h,i.pdata=d}else i.dataGM=null;if(s){for(H=0,M={pq_grandsummary:!0,pq_gsummary:!0};H<e;H++)C=(C=(y=w[H].column).summary).type,S=m[b=y.dataIndx],S=r[C](S,y),M[b]=S;this.summaryData=n.summaryData=[M]}else this.summaryData.length=0},(i=i.pqGrid.prototype).group=function(t){this.iGroupView[t.indx?"expandIndx":"expandAll"](t)},i.groupOption=function(e){var i=e.dataIndx,r=i?i.length:0,i=!1,o=this.iGroupView,n=this.options,l=n.groupModel,a=l.dataIndx,s=e.on||null==e.on&&l.on;if(s&&o.init(),s&&(r||a.length)&&(i=!0),l.on&&a.length&&(!1===e.on||0===r))for(r=n.dataModel.data,n=0,a=r.length;n<a;n++)r[n].pq_hidden=!1;t.extend(l,e),o.setOption(),!1!==e.refresh&&this[i?"sort":"refreshView"]()}}(jQuery);