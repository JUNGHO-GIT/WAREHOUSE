<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 휴무관리(DayOff)의 XML Mapper -->
<!-- 생성일 : 2021-05-19 19:32:39 by JDFrame -->

<mapper namespace="com.bedone.wms.dao.DayOffDAO">

  <select id="getUser" resultType="com.bedone.wms.container.DayOff" >
    /* DayOff.getUser */
    SELECT
      userID, userNm
    FROM
      tblUser
    WHERE
      flagYN = 'Y'
  </select>

  <select id="getList" resultType="com.bedone.wms.container.DayOff">
    /* DayOff.getList */
    SELECT
      A.offDate, A.restCnt, A.offSeq, B.userNm,
      SUBSTR(_UTF8'일월화수목금토', DAYOFWEEK(offDate), 1) offDay,
    FROM (
      SELECT *
      FROM tblDayOff
      WHERE flagYN = 'Y'
    ) A
    LEFT JOIN (
      SELECT *
      FROM tblUser
    ) B ON A.userID = B.userID
    <if test='findUserNm!="" and findUserNm!=null'>
      WHERE A.userNm LIKE CONCAT('%', #{findUserNm}, '%')
    </if>
  </select>

  <select id="showDayOff" resultType="com.bedone.wms.container.DayOff">
    /* DayOff.showDayOff */
    SELECT
      offDate, userID, offSeq
    FROM
      tblDayOff
    WHERE
      offSeq = #{offSeq}
  </select>

  <select id="saveDayOff" resultType="Integer">
    /* DayOff.saveDayOff */
    CALL sp_DayOff (
      #{offSeq}, #{userID}, #{offDate}, #{flagYN}, #{issueID}
    );
  </select>
</mapper>